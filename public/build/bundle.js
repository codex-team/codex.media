var codex=function(e){function t(o){if(n[o])return n[o].exports;var a=n[o]={exports:{},id:o,loaded:!1};return e[o].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){n(1),codex=function(e){"use strict";return e.nodes={content:null},e.init=function(){e.checkboxes.init(),e.content.approvalButtons.init(),e.autoresizeTextarea.init(),e.scrollUp.init("js-layout-holder"),e.core.log("Initialized","CodeX","info"),e.branding.init()},e}({}),codex.docReady=function(e){/in/.test(document.readyState)?window.setTimeout(codex.docReady,9,e):e()},codex.core=n(3),codex.ajax=n(4),codex.transport=n(5),codex.content=n(6),codex.appender=n(7),codex.parser=n(8),codex.comments=n(9),codex.alerts=n(10),codex.islandSettings=n(12),codex.autoresizeTextarea=n(13),codex.user=n(14),codex.sharer=n(15),codex.writing=n(16),codex.loader=n(17),codex.scrollUp=n(18),codex.branding=n(19),codex.pages=n(20),codex.checkboxes=n(21),e.exports=codex,codex.docReady(function(){codex.init()})},function(e,t){},,function(e,t){e.exports={log:function(e,t,n,o){var a=32;if(t){for(t=t.length<a?t:t.substr(0,a-2);t.length<a-1;)t+=" ";t+=":",e=t+e}n=n||"log";try{"console"in window&&window.console[n]&&(o?console[n](e,o):console[n](e))}catch(e){}},getOffset:function(e){var t,n,o,a;if(e)return e.getClientRects().length?(o=e.getBoundingClientRect(),o.width||o.height?(a=e.ownerDocument,n=window,t=a.documentElement,{top:o.top+n.pageYOffset-t.clientTop,left:o.left+n.pageXOffset-t.clientLeft}):o):{top:0,left:0}},isElementOnScreen:function(e){var t=codex.core.getOffset(e).top,n=window.scrollY+window.innerHeight;return n>t},css:function(e){return window.getComputedStyle(e)},insertAfter:function(e,t){e.parentNode.insertBefore(t,e.nextSibling)},replace:function(e,t){return e.parentNode.replaceChild(t,e)},insertBefore:function(e,t){e.parentNode.insertBefore(t,e)},random:function(e,t){return Math.floor(Math.random()*(t-e+1))+e},delegateEvent:function(e,t,n,o){e.addEventListener(n,function(e){for(var n,a=e.target;a&&!n;)n=a.matches(t),n||(a=a.parentElement);n&&o.call(e.target,e,a)},!0)},nodeTypes:{TAG:1,TEXT:3,COMMENT:8,DOCUMENT_FRAGMENT:11},keys:{BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,LEFT:37,UP:38,DOWN:40,RIGHT:39,DELETE:46,META:91},isDomNode:function(e){return e&&"object"==typeof e&&e.nodeType&&e.nodeType==this.nodeTypes.TAG},parseHTML:function(e){var t,n,o=[];t=document.createElement("div"),t.innerHTML=e.trim(),n=t.childNodes;for(var a,r=0;a=n[r];r++)(a.nodeType!=codex.core.nodeTypes.TEXT||a.textContent.trim())&&o.push(a);return o},isEmpty:function(e){return 0===Object.keys(e).length},isVisible:function(e){return null!==e.offsetParent},setCookie:function(e,t,n,o,a){var r=e+"="+t;n&&(r+="; expires="+n.toGMTString()),o&&(r+="; path="+o),a&&(r+="; domain="+a),document.cookie=r},getCookie:function(e){var t=document.cookie,n=e+"=",o=t.indexOf("; "+n);if(o==-1){if(o=t.indexOf(n),0!==o)return null}else o+=2;var a=document.cookie.indexOf(";",o);return a==-1&&(a=t.length),unescape(t.substring(o+n.length,a))}}},function(e,t){var n=function(){function e(e){return"function"==typeof e.append}var t=function(t){if(t&&t.url){var n=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP"),o=function(){};t.async=!0,t.type=t.type||"GET",t.data=t.data||"",t["content-type"]=t["content-type"]||"application/json; charset=utf-8",o=t.success||o,"GET"==t.type&&t.data&&(t.url=/\?/.test(t.url)?t.url+"&"+t.data:t.url+"?"+t.data),t.withCredentials&&(n.withCredentials=!0),t.beforeSend&&"function"==typeof t.beforeSend&&t.beforeSend.call(),n.open(t.type,t.url,t.async),e(t.data)||n.setRequestHeader("Content-type",t["content-type"]),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.onreadystatechange=function(){4==n.readyState&&200==n.status&&o(n.responseText)},n.send(t.data)}};return{call:t}}();e.exports=n},function(e,t){e.exports=function(e){var t=null;e.input=null,e.init=function(a){if(!a.url)return void codex.core.log("can't send request because `url` is missed","Transport module","error");t=a;var r=document.createElement("INPUT");r.type="file",t&&t.multiple&&r.setAttribute("multiple","multiple"),t&&t.accept&&r.setAttribute("accept",t.accept),r.addEventListener("change",o,!1),e.input=r,n()};var n=function(){e.input.click()},o=function(){var n=t.url,o=t.beforeSend,a=t.success,r=t.error,s=new FormData,i=e.input.files;if(i.length>1)for(var c=0;c<i.length;c++)s.append("files[]",i[c],i[c].name);else s.append("files",i[0],i[0].name);codex.ajax.call({type:"POST",data:s,url:n,beforeSend:o,success:a,error:r})};return e}({})},function(e,t){e.exports=function(){var e=function(e,t){for(var n=document.querySelectorAll(e),o=n.length-1;o>=0;o--)n[o].classList.toggle(t)},t=function(e){var t=document.getElementById("js-mobile-menu-holder"),n="mobile-menu-holder--opened";t.classList.toggle(n),e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault()},n={CHECKED_CLASS:"checked",init:function(){var e=document.getElementsByClassName("js-custom-checkbox");if(e.length)for(var t=e.length-1;t>=0;t--)e[t].addEventListener("click",codex.content.customCheckboxes.clicked,!1)},clicked:function(){var e=this,t=this.querySelector("input"),n=this.classList.contains(codex.content.customCheckboxes.CHECKED_CLASS);e.classList.toggle(codex.content.customCheckboxes.CHECKED_CLASS),n?t.removeAttribute("checked"):t.setAttribute("checked","checked")}},o={CLICKED_CLASS:"click-again-to-approve",init:function(){var e=document.getElementsByClassName("js-approval-button");if(e.length)for(var t=e.length-1;t>=0;t--)e[t].addEventListener("click",codex.content.approvalButtons.clicked,!1)},clicked:function(e){var t=this,n=this.classList.contains(codex.content.approvalButtons.CLICKED_CLASS);n||(t.classList.add(codex.content.approvalButtons.CLICKED_CLASS),e.preventDefault())}};return{toggleMobileMenu:t,customCheckboxes:n,approvalButtons:o,toggle:e}}()},function(e,t){var n={page:1,settings:null,blockForItems:null,loadMoreButton:null,buttonText:null,init:function(e){return this.settings=e,this.loadMoreButton=document.getElementById(this.settings.buttonId),!!this.loadMoreButton&&(this.blockForItems=document.getElementById(this.settings.targetBlockId),!!this.blockForItems&&(this.page=e.currentPage,this.buttonText=this.loadMoreButton.innerHTML,this.settings.autoLoading&&(this.autoLoading.isAllowed=!0),void this.loadMoreButton.addEventListener("click",function(e){codex.appender.load(),e.preventDefault(),codex.appender.autoLoading.init()},!1)))},load:function(){var e=this.settings.url+(parseInt(this.page)+1);codex.ajax.call({type:"post",url:e,data:{},beforeSend:function(){codex.appender.loadMoreButton.classList.add("loading")},success:function(e){if(e=JSON.parse(e),e.success){if(!e.list)return;codex.appender.blockForItems.innerHTML+=e.list,codex.appender.page++,codex.appender.settings.autoLoading&&(codex.appender.autoLoading.canLoad=!0),e.next_page||codex.appender.disable()}else codex.core.showException("Не удалось подгрузить новости");codex.appender.loadMoreButton.classList.remove("loading")}})},disable:function(){codex.appender.loadMoreButton.style.display="none",codex.appender.autoLoading.isLaunched&&codex.appender.autoLoading.disable()},autoLoading:{isAllowed:!1,isLaunched:!1,canLoad:!0,init:function(){this.isAllowed&&(window.addEventListener("scroll",codex.appender.autoLoading.scrollEvent),codex.appender.autoLoading.isLaunched=!0)},disable:function(){window.removeEventListener("scroll",codex.appender.autoLoading.scrollEvent),codex.appender.autoLoading.isLaunched=!1},scrollEvent:function(){var e=window.pageYOffset+window.innerHeight>=document.body.clientHeight;e&&codex.appender.autoLoading.canLoad&&(codex.appender.autoLoading.canLoad=!1,codex.appender.load())}}};e.exports=n},function(e,t){var n={input:null,init:function(){var e=this;this.input.addEventListener("paste",function(){e.inputPasteCallback()},!1)},inputPasteCallback:function(){var e=this.input,t=this;window.setTimeout(function(){t.sendRequest(e.value)},100)},sendRequest:function(e){codex.core.ajax({type:"get",url:"/ajax/get_page",data:{url:e},success:function(t){var n,o,a;1==t.success?(n=document.getElementById("page_form_title"),o=document.getElementById("page_form_content"),a=document.getElementById("source_link"),n.value=t.title,o.value=t.article,a.value=e,document.getElementsByClassName("redactor_redactor")[0].innerHTML=t.article):codex.core.showException("Не удалось импортировать страницу")}})}};e.exports=n},function(e,t){e.exports=function(){function e(e){g=document.getElementById(e.listId),v&&f()}function t(e){if(!e.classList.contains(x.replyOpened)){var t={parentId:e.dataset.parentId,rootId:e.dataset.rootId,action:e.dataset.action},o=n(t);codex.core.insertAfter(e,o),e.classList.add(x.replyOpened),s(o).focus()}}function n(e){var t=o(),n=a(),r=document.createElement("DIV");return r.classList.add(x.replyForm),t.dataset.parentId=e.parentId,t.dataset.rootId=e.rootId,t.dataset.action=e.action,r.appendChild(t),r.appendChild(n),r}function o(){var e=document.createElement("TEXTAREA");return e.classList.add(x.replyTextarea),e.placeholder="Ваш комментарий",e.addEventListener("keydown",d,!1),e.addEventListener("blur",i,!1),codex.autoresizeTextarea.addListener(e),e}function a(){var e=document.createElement("DIV");return e.classList.add(x.replySubmitButton,"button","master"),e.textContent="Отправить",e.addEventListener("click",r,!1),e}function r(){var e=this,t=e.parentNode,n=s(t);l(n)}function s(e){return e.getElementsByTagName("TEXTAREA")[0]}function i(e){var t=e.target,n=t.parentNode,o=t.dataset.parentId;t.value.trim()||c(n,o)}function c(e,t){var n=document.getElementById("reply"+t);e.remove(),n.classList.remove(x.replyOpened)}function d(e){var t=e.ctrlKey||e.metaKey,n=13==e.keyCode,o=e.target;t&&n&&(l(o),e.preventDefault())}function l(e){var t=new FormData,n=e.parentNode,o=n.querySelector("."+x.replySubmitButton),a=e.dataset.rootId,r=e.dataset.parentId,s=e.dataset.action;t.append("root_id",a),t.append("parent_id",r),t.append("comment_text",e.value),t.append("csrf",window.csrf),codex.ajax.call({type:"POST",url:s,data:t,beforeSend:function(){o.classList.add("loading")},success:function(e){var t;return o.classList.remove("loading"),e=JSON.parse(e),e.success?(c(n,r),u(),t=codex.core.parseHTML(e.comment)[0],g.appendChild(t),window.scrollTo(0,document.body.scrollHeight),m(e.commentId),void p(t)):void codex.alerts.show({type:"error",message:e.error})}})}function u(){var e=document.querySelector(".js-empty-comments");e&&e.remove()}function p(e){var t=e.querySelector(w);t&&codex.islandSettings.prepareToggler(t,w)}function m(e){var t=document.getElementById("comment"+e);t.classList.add(x.highlighted),window.setTimeout(function(){t.classList.remove(x.highlighted)},500)}function f(){var e,t=v.match(/\d+/);t&&(e=t[0],m(e))}function h(){var e=this,t=e.dataset.id;window.confirm("Подтвердите удаление комментария")&&(document.location="/delete-comment/"+t)}var g=null,v=document.location.hash,x={replyForm:"comments-form",replyTextarea:"comment-form__text",replyOpened:"comment-form__placeholder--opened",replySubmitButton:"comment-form__button",highlighted:"comment--highligthed"},w=".js-comment-settings";return{init:e,reply:t,remove:h}}()},function(e,t,n){e.exports=function(){function e(){return!!a||(a=document.createElement("DIV"),a.classList.add(o.wrapper),void document.body.appendChild(a))}function t(t){e();var n=document.createElement("DIV"),r=document.createElement("DIV"),s=t.message,i=t.type||"notify",c=t.time||8e3;s&&(n.classList.add(o.notification),n.classList.add(o.notification+"--"+i),n.innerHTML=s,r.classList.add(o.crossBtn),r.addEventListener("click",function(){n.remove()}),n.appendChild(r),a.appendChild(n),n.classList.add("bounceIn"),window.setTimeout(function(){n.remove()},c))}n(11);var o={wrapper:"cdx-notifies-wrapper",notification:"cdx-notifies",crossBtn:"cdx-notifies-cross"},a=null;return{show:t}}({})},function(e,t){},function(e,t){e.exports=function(){var e=null,t=[],n={menu:"island-settings__menu",item:"island-settings__item",showed:"island-settings__menu--showed"},o=function(e){for(var n=document.querySelectorAll(e.selector),o=t.length,r=n.length+t.length,s=o;s<r;s++)t.push({el:n[s],settings:e}),a(s,n[s-o])},a=function(e,t){t.dataset.index=e,t.addEventListener("mouseover",r,!1),t.addEventListener("mouseleave",s,!1)},r=function(){var t,n=this;"true"!=n.dataset.opened&&(n.dataset.opened=!0,e||(e=u()),t=i(n.dataset.index),console.assert(t.items,"Menu items missed"),c(t.items,n),p(n))},s=function(){this.dataset.opened=!1},i=function(e){return t[e].settings},c=function(t,n){var o,a,r;for(e.innerHTML="",o=0;a=t[o];o++){r=d(a),r.dataset.itemIndex=o;for(var s in n.dataset)r.dataset[s]=n.dataset[s];e.appendChild(r)}},d=function(e){var t=document.createElement("LI");return t.classList.add(n.item),console.assert(e.title,"islandSettings: item title is missed"),console.assert("function"==typeof e.handler,"islandSettings: item handler is not a function"),t.textContent=e.title,t.addEventListener("click",l),t},l=function(){var e,t,n,o=this,a=o.dataset.index,r=o.dataset.itemIndex;e=i(a),t=e.items[r].handler,n=e.items[r].arguments,t.call(o,n||{})},u=function(){var e=document.createElement("UL");return e.classList.add(n.menu),e},p=function(t){t.appendChild(e),e.classList.add(n.showed)},m=function(n,o,a,r,s){console.assert(t[n],"Toggler was not found by index");var i,c=t[n],d=e.childNodes[o];c&&(i=t[n].settings.items[o],a&&(i.title=a),s&&(i.arguments=s),r&&"function"==typeof r&&(i.handler=r),e&&a&&(d.textContent=a),codex.core.log("item updated %o","islandSettings","info",i))};return{init:o,updateItem:m,prepareToggler:a}}()},function(e,t){e.exports=function(){var e=function(){var e=document.getElementsByClassName("js-autoresizable");if(e.length)for(var n=0;n<e.length;n++)t(e[n]),o(e[n])},t=function(e){e.addEventListener("input",n,!1)},n=function(e){var t=e.target;o(t)},o=function(e){e.scrollHeight>e.clientHeight&&(e.style.height=e.scrollHeight+"px")};return{init:e,addListener:t}}()},function(e,t){e.exports=function(){var e=function(){var e="js-img-updatable",t=function(e,t){codex.transport.init({url:"/upload/"+t,success:o,error:n})},n=function(e){console.log(e)},o=function(e){return e=JSON.parse(e),e.success?(console.assert(e.data&&e.data.url,"Wrong response data"),void a(e.data.url)):void codex.alerts.show({type:"error",message:e.message||"File uploading error :("})},a=function(t){for(var n=document.getElementsByName(e),o=n.length-1;o>=0;o--)n[o].src=t};return{change:t}}(),t=function(){var e=function(e){var t=this,o=t.dataset.id,a=e.value;n(t,"status",o,a)},t=function(e){var t=this,o=t.dataset.id,a=e.value;n(t,"role",o,a)},n=function(e,t,n,o){var a="/user/"+n+"/change/"+t,r=new FormData;r.append("value",o),codex.ajax.call({url:a,type:"POST",data:r,beforeSend:function(){e.classList.add("loading")},success:function(t){var n=e.dataset.index,o=e.dataset.itemIndex;t=JSON.parse(t),e.classList.remove("loading"),codex.islandSettings.updateItem(n,o,t.buttonText,null,{value:t.buttonValue}),codex.alerts.show({type:t.success?"success":"error",message:t.message||"Не удалось сохранить изменения"})}})};return{status:e,role:t}}(),n=function(){var e=null,t=null,n=null,o=function(n){n.classList.add("hide"),e=document.getElementById("change-password-form"),t=document.getElementById("change-password-input"),e.classList.remove("hide")},a=function(t){e=t,r(e,!0),c()},r=function(e,o){n=e,n.classList.add("loading");var a=new FormData;a.append("csrf",window.csrf),a.append("currentPassword",t?t.value:""),codex.ajax.call({url:"/user/passchange",type:"POST",data:a,success:o?null:i,error:i})},s=function(e){e.classList.add("loading");var t=new FormData;t.append("csrf",window.csrf),t.append("repeatEmail",!0),codex.ajax.call({url:"/user/passchange",type:"POST",data:t,success:function(){e.classList.remove("loading"),codex.alerts.show({type:"success",message:"Мы отправили на вашу почту письмо"})},error:function(){e.classList.remove("loading"),codex.alerts.show({type:"error",message:"Произошла ошибка"})}})},i=function(e){n.classList.remove("loading");try{e=JSON.parse(e)}catch(t){e={success:0,message:"Произошла ошибка"}}return e.success?void c():(t&&t.classList.add("form__input--invalid"),void codex.alerts.show({type:"error",message:e.message}))},c=function(){codex.alerts.show({type:"success",message:"Мы выслали инструкцию на вашу почту"}),e.classList.add("hide"),e=document.getElementById("change-password-success"),e.classList.remove("hide")};return{showForm:o,requestChange:r,set:a,repeatEmail:s}}(),o=function(){var e=null,t=function(t){var o=t.querySelector("textarea");o||(e=document.createElement("TEXTAREA"),e.innerHTML=t.textContent.trim(),e.addEventListener("keydown",n),t.innerHTML="",t.appendChild(e),e.focus(),codex.autoresizeTextarea.addListener(e))},n=function(e){e.keyCode==codex.core.keys.ENTER&&(o(this.value),e.preventDefault())},o=function(e){if(!e.trim())return void codex.alerts.show({type:"error",message:"Write something about yourself"});var t=new FormData;t.append("bio",e),t.append("csrf",window.csrf),codex.ajax.call({type:"POST",url:"/user/updateBio",data:t,beforeSend:a,success:r})},a=function(){e.classList.add("loading")},r=function(t){if(t=JSON.parse(t),!t.success||!t.bio)return e.classList.remove("loading"),void codex.alerts.show({type:"error",message:"Saving error, sorry"});var n=document.createTextNode(t.bio||"");window.csrf=t.csrf,codex.core.replace(e,n)};return{edit:t}}(),a=function(){var e=null,t=null,n=function(n){try{if(n=JSON.parse(n),n.success)return codex.core.replace(e.parentNode,codex.core.parseHTML(n.island)[0]),codex.alerts.show({type:"success",message:"Адрес почты обновлен. Теперь вам нужно подтвердить его, перейдя по ссылке в письме."}),void(e=null)}catch(e){}t.classList.remove("loading"),codex.alerts.show({type:"error",message:n.message||"Произошла ошибка, попробуйте позже"})},o=function(){if(""==e.value.trim())return void codex.alerts.show({type:"error",message:"Введите email"});t=this,t.classList.add("loading");var o=new FormData;o.append("email",e.value),o.append("csrf",window.csrf),codex.ajax.call({url:"user/changeEmail",type:"POST",data:o,success:n,error:n})},a=function(e){var t=function(t){t=JSON.parse(t),codex.alerts.show({type:"success",message:t.message}),e.classList.remove("loading")};e.classList.add("loading"),codex.ajax.call({url:"/ajax/confirmation-email",success:t})},r=function(t){if(!e){e=t;var n=document.createElement("BUTTON"),a=t.parentNode.querySelector("button");a&&a.classList.remove("master"),n.classList.add("button","master"),n.textContent="Сохранить",n.addEventListener("click",o),t.oninput=null,t.parentNode.appendChild(n)}},s=function(t){t.classList.add("hide");var n=document.getElementById("set-email-form");n.classList.remove("hide"),e=document.getElementById("set-email-input")};return{sendConfirmation:a,changed:r,send:o,set:s}}();return{changePassword:n,promote:t,photo:e,bio:o,email:a}}()},function(e,t){var n={init:function(){for(var e=document.querySelectorAll(".js-share"),t=e.length-1;t>=0;t--)e[t].addEventListener("click",n.click,!0)},shareVk:function(e){var t="https://vk.com/share.php?";t+="url="+e.url,t+="&title="+e.title,t+="&description="+e.desc,t+="&image="+e.img,t+="&noparse=true",this.popup(t,"vkontakte")},shareFacebook:function(e){var t=0x62eef6f1917ee,n="https://www.facebook.com/dialog/share?display=popup";n+="&app_id="+t,n+="&href="+e.url,n+="&redirect_uri="+document.location.href,this.popup(n,"facebook")},shareTwitter:function(e){var t="https://twitter.com/share?";t+="text="+e.title,t+="&url="+e.url,t+="&counturl="+e.url,this.popup(t,"twitter")},shareTelegram:function(e){var t="https://telegram.me/share/url";t+="?text="+e.title,t+="&url="+e.url,this.popup(t,"telegram")},popup:function(e,t){window.open(e,"","toolbar=0,status=0,width=626,height=436"),window.yaCounter32652805&&window.yaCounter32652805.reachGoal("article-share",function(){},this,{type:t,url:e})},click:function(e){var t=e.target,o=t.dataset.shareType||t.parentNode.dataset.shareType;if(n[o]){var a={url:t.dataset.url||t.parentNode.dataset.url,title:t.dataset.title||t.parentNode.dataset.title,desc:t.dataset.desc||t.parentNode.dataset.desc,img:t.dataset.img||t.parentNode.dataset.title};n[o](a)}}};e.exports=n},function(e,t){e.exports=function(){function e(e){for(var t in e)r[t]=e[t]}function t(){var e=1,t=2;codex.editor.start({holderId:r.holderId,initialBlockPlugin:r.initialBlockPlugin,hideToolbar:r.hideEditorToolbar,sanitizer:{tags:{p:{},a:{href:!0,target:"_blank"}}},tools:{paragraph:{type:"paragraph",iconClassname:"ce-icon-paragraph",render:window.paragraph.render,validate:window.paragraph.validate,save:window.paragraph.save,allowedToPaste:!0,showInlineToolbar:!0,destroy:window.paragraph.destroy,allowRenderOnPaste:!0},header:{type:"header",iconClassname:"ce-icon-header",appendCallback:window.header.appendCallback,makeSettings:window.header.makeSettings,render:window.header.render,validate:window.header.validate,save:window.header.save,destroy:window.header.destroy,displayInToolbox:!0},image:{type:"image",iconClassname:"ce-icon-picture",appendCallback:window.image.appendCallback,prepare:window.image.prepare,makeSettings:window.image.makeSettings,render:window.image.render,save:window.image.save,destroy:window.image.destroy,isStretched:!0,showInlineToolbar:!0,displayInToolbox:!0,renderOnPastePatterns:window.image.pastePatterns,config:{uploadImage:"/upload/"+e,uploadFromUrl:""}},attaches:{type:"attaches",displayInToolbox:!0,iconClassname:"cdx-attaches__icon",prepare:window.cdxAttaches.prepare,render:window.cdxAttaches.render,save:window.cdxAttaches.save,validate:window.cdxAttaches.validate,destroy:window.cdxAttaches.destroy,appendCallback:window.cdxAttaches.appendCallback,config:{fetchUrl:"/upload/"+t,maxSize:25e3}},list:{type:"list",iconClassname:"ce-icon-list-bullet",make:window.list.make,appendCallback:null,makeSettings:window.list.makeSettings,render:window.list.render,validate:window.list.validate,save:window.list.save,destroy:window.list.destroy,displayInToolbox:!0,showInlineToolbar:!0,enableLineBreaks:!0,allowedToPaste:!0}},data:r.data});var n=document.getElementById(r.titleId);n.focus(),n.addEventListener("keydown",i)}function n(e){var t=e.name,n=e.path.script,o=e.path.style;return Promise.all([codex.loader.importScript(n,t),codex.loader.importStyle(o,t)])}var o=!1,a=null,r={hideEditorToolbar:!1,titleId:"editorWritingTitle",initialBlockPlugin:"paragraph",data:{items:[]},resources:[],holderId:null,pageId:0,parentId:0},s=function(t){return e(t),u(r.resources).then(function(){o=!0})},i=function(e){e.keyCode==codex.core.keys.ENTER&&(e.preventDefault(),c())},c=function(){var e,t=codex.editor.nodes.redactor.firstChild,n=t.firstChild,o=n.firstChild;e=document.createTextNode("​"),o.appendChild(e),codex.editor.caret.set(o,0,0)},d=function(){o&&t()},l=function(e,t,n){if(o){var a=e;document.getElementById(t).classList.remove("hide"),a.classList.add(n),a.onclick=null,d()}},u=function(e){return Promise.all(e.map(n))},p=function(){var e=document.forms.atlas;if(e){var t=document.createElement("TEXTAREA");return t.name="content",t.id="json_result",t.hidden=!0,e.appendChild(t),codex.editor.saver.saveBlocks(),e}},m=function(e){var t,n=document.forms.atlas.elements.title;return""===n.value.trim()?void codex.editor.notifications.notification({type:"warn",message:"Заполните заголовок"}):(t=p(),a=e,a.classList.add("loading"),void window.setTimeout(function(){t.elements.content.innerHTML=JSON.stringify({items:codex.editor.state.jsonOutput}),codex.ajax.call({url:"/p/save",data:new FormData(t),success:f,type:"POST"})},500))},f=function(e){return a.classList.remove("loading"),e=JSON.parse(e),e.success?void(window.location=e.redirect):void codex.editor.notifications.notification({type:"warn",message:e.message})},h=function(){var e=p();window.setTimeout(function(){e.elements.content.innerHTML=JSON.stringify({items:codex.editor.state.jsonOutput}),e.submit()},500)};return{init:d,prepare:s,open:l,openEditorFullscreen:h,submit:m}}()},function(e,t){e.exports={prefixJS:"cdx-script-",prefixCSS:"cdx-style-",importScript:function(e,t){return new Promise(function(n,o){var a;t?document.getElementById(this.prefixJS+t)&&n(e):o("Instance name is missed"),a=document.createElement("SCRIPT"),a.async=!0,a.defer=!0,a.id=codex.loader.prefixJS+t,a.onload=function(){n(e)},a.onerror=function(){o(e)},a.src=e,document.head.appendChild(a)})},importStyle:function(e,t){return new Promise(function(n,o){var a;t?document.getElementById(this.prefixCSS+t)&&n(e):o("Instance name is missed"),a=document.createElement("LINK"),a.type="text/css",a.href=e,a.rel="stylesheet",a.id=codex.loader.prefixCSS+t,a.onload=function(){n(e)},a.onerror=function(){o(e)},a.src=e,document.head.appendChild(a)})}}},function(e,t){e.exports=function(){var e=300,t=0,n=null,o=null,a=function(e){var o=document.getElementById(e);return o?(t=o.offsetWidth,n=d(),n.addEventListener("click",r),window.addEventListener("scroll",s),window.addEventListener("resize",c,!1),i(),void s()):void codex.core.log("Layout center-col ID wissed","scrollUp","warn")},r=function(e){window.scrollTo(0,e)},s=function(){var t=window.pageYOffset>e;t?n.classList.add("show"):n.classList.remove("show")},i=function(){var e=document.body.clientWidth,o=(e-t)/2;n.style.width=o+"px"},c=function(){o&&window.clearTimeout(o),o=window.setTimeout(i,150)},d=function(){var e=document.createElement("DIV"),t=document.createElement("DIV");return e.classList.add("scroll-up"),t.classList.add("scroll-up__arrow"),e.appendChild(t),document.body.appendChild(e),e};return{init:a}}()},function(e,t){e.exports=function(){var e="branding--empty",t="branding--loading",n="branding__preloader",o="branding__preloader--shown",a=null,r=function(){if(a=document.getElementById("brandingSection")){var e=a.dataset.src;s(e)}},s=function(e,t){var r=a.querySelector("."+n),s=document.createElement("IMG");t&&(r.style.backgroundImage="url('"+t+"')",r.classList.add(o)),s.src=e,s.onload=function(){a.style.backgroundImage="url('"+e+"')",r.classList.remove(o)}},i=function(){codex.transport.init({url:"/upload/4",accept:"image/*",beforeSend:function(){a.classList.add(t)},success:function(n){var o,r,i=JSON.parse(n);a.classList.remove(t),i.success?(o=i.data.url,r="/upload/branding/preload_"+i.data.name+".jpg",a.classList.contains(e)&&a.classList.remove(e),s(o,r)):codex.alerts.show({type:"error",message:"Uploading failed"})},error:function(){a.classList.remove(t),codex.alerts.show({type:"error",message:"Error while uploading branding image;"})}})};return{init:r,change:i}}({})},function(e,t){e.exports=function(){var e=null,t=function(){e=this;var t=e.dataset.id;document.location="/p/writing?id="+t},n=function(){e=this;var t=e.dataset.id;window.confirm("Подтвердите удаление страницы")&&codex.ajax.call({url:"/p/"+t+"/delete",success:i})},o=function(){e=this;var t=e.dataset.id;document.location="/p/writing?parent="+t},a=function(){e=this,e.classList.add("loading");var t=e.dataset.id;codex.ajax.call({url:"/p/"+t+"/promote?list=menu",success:c})},r=function(){e=this,e.classList.add("loading");var t=e.dataset.id;codex.ajax.call({url:"/p/"+t+"/promote?list=news",success:c})},s=function(e){try{e=JSON.parse(e)}catch(e){return{success:0,message:"Произошла ошибка, попробуйте позже"}}return e},i=function(e){return e=s(e),e.success?void window.location.replace(e.redirect):void codex.alerts.show({type:"error",message:e.message})},c=function(t){return t=s(t),e.classList.remove("loading"),t.success?(t.buttonText&&d(e,t.buttonText),t.menu&&l(t.menu),void codex.alerts.show({type:"success",message:t.message})):void codex.alerts.show({type:"error",message:t.message})},d=function(e,t){var n=e.dataset.itemIndex,o=e.dataset.index;codex.islandSettings.updateItem(o,n,t),e.textContent=t},l=function(e){var t=document.getElementById("js-site-menu"),n=codex.core.parseHTML(e)[0];codex.core.replace(t,n)},u=function(){e=this,e.classList.add("loading");var t=e.dataset.id;codex.ajax.call({url:"/p/"+t+"/pin",success:function(e){codex.alerts.show({message:e})}})};return{openWriting:t,newChild:o,addToMenu:a,addToNews:r,remove:n,pin:u}}()},function(e,t){e.exports=function(){var e=new window.CustomEvent("toggle"),t={wrapper:"cdx-checkbox",checkbox:"cdx-checkbox__slider",checked:"cdx-checkbox--checked",defaultCheckbox:"cdx-default-checkbox--hidden"},n={checkbox:"cdx-custom-checkbox",defaultInput:"cdx-custom-checkbox"},o=function(e){var o=document.createElement("INPUT"),r=document.createElement("SPAN"),s=e.firstChild;o.type="checkbox",o.name=e.dataset.name||n.defaultInput,o.value=1,o.classList.add(t.defaultCheckbox),r.classList.add(t.checkbox),r.appendChild(o),e.classList.add(t.wrapper),e.addEventListener("click",a),e.dataset.checked&&(o.checked=!0,e.classList.add(t.checked)),s?e.insertBefore(r,s):e.appendChild(r)},a=function(){var n=this,o=n.querySelector("."+t.checkbox),a=o.querySelector("input");o.parentNode.classList.toggle(t.checked),a.checked=!a.checked,e.checked=a.checked,o.dispatchEvent(e)},r=function(){var e=document.getElementsByName(n.checkbox);Array.prototype.forEach.call(e,o)};return{init:r}}()}]);
//# sourceMappingURL=bundle.js.map