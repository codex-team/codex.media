var codex=function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){n(1),codex=function(e){"use strict";return e.nodes={content:null},e.init=function(){e.content.customCheckboxes.init(),e.content.approvalButtons.init(),e.autoresizeTextarea.init(),window.codexSpecial.init({blockId:"js-contrast-version-holder"}),e.core.log("Initialized","App init","info")},e}({}),codex.docReady=function(e){/in/.test(document.readyState)?window.setTimeout(codex.docReady,9,e):e()},codex.core=n(3),codex.ajax=n(4),codex.transport=n(5),codex.content=n(6),codex.appender=n(7),codex.parser=n(8),codex.comments=n(9),codex.alerts=n(10),codex.autoresizeTextarea=n(12),codex.profileSettings=n(13),codex.sharer=n(14),codex.writing=n(15),codex.loader=n(16),e.exports=codex,codex.docReady(function(){codex.init()})},function(e,t){},,function(e,t){e.exports={log:function(e,t,n,o){var r=32;if(t){for(t=t.length<r?t:t.substr(0,r-2);t.length<r-1;)t+=" ";t+=":",e=t+e}n=n||"log";try{"console"in window&&window.console[n]&&(o?console[n](e,o):console[n](e))}catch(e){}},getOffset:function(e){var t,n,o,r;if(e)return e.getClientRects().length?(o=e.getBoundingClientRect(),o.width||o.height?(r=e.ownerDocument,n=window,t=r.documentElement,{top:o.top+n.pageYOffset-t.clientTop,left:o.left+n.pageXOffset-t.clientLeft}):o):{top:0,left:0}},isElementOnScreen:function(e){var t=codex.core.getOffset(e).top,n=window.scrollY+window.innerHeight;return n>t},css:function(e){return window.getComputedStyle(e)},insertAfter:function(e,t){e.parentNode.insertBefore(t,e.nextSibling)},replace:function(e,t){return e.parentNode.replaceChild(t,e)},insertBefore:function(e,t){e.parentNode.insertBefore(t,e)},random:function(e,t){return Math.floor(Math.random()*(t-e+1))+e},delegateEvent:function(e,t,n,o){e.addEventListener(n,function(e){for(var n,r=e.target;r&&!n;)n=r.matches(t),n||(r=r.parentElement);n&&o.call(e.target,e,r)},!0)},nodeTypes:{TAG:1,TEXT:3,COMMENT:8,DOCUMENT_FRAGMENT:11},keys:{BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,LEFT:37,UP:38,DOWN:40,RIGHT:39,DELETE:46,META:91},isDomNode:function(e){return e&&"object"==typeof e&&e.nodeType&&e.nodeType==this.nodeTypes.TAG},parseHTML:function(e){var t,n,o=[];t=document.createElement("div"),t.innerHTML=e.trim(),n=t.childNodes;for(var r,a=0;r=n[a];a++)(r.nodeType!=codex.core.nodeTypes.TEXT||r.textContent.trim())&&o.push(r);return o},isEmpty:function(e){return 0===Object.keys(e).length},isVisible:function(e){return null!==e.offsetParent},setCookie:function(e,t,n,o,r){var a=e+"="+t;n&&(a+="; expires="+n.toGMTString()),o&&(a+="; path="+o),r&&(a+="; domain="+r),document.cookie=a},getCookie:function(e){var t=document.cookie,n=e+"=",o=t.indexOf("; "+n);if(o==-1){if(o=t.indexOf(n),0!==o)return null}else o+=2;var r=document.cookie.indexOf(";",o);return r==-1&&(r=t.length),unescape(t.substring(o+n.length,r))}}},function(e,t){var n=function(){function e(e){return"function"==typeof e.append}var t=function(t){if(t&&t.url){var n=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP"),o=function(){};t.async=!0,t.type=t.type||"GET",t.data=t.data||"",t["content-type"]=t["content-type"]||"application/json; charset=utf-8",o=t.success||o,"GET"==t.type&&t.data&&(t.url=/\?/.test(t.url)?t.url+"&"+t.data:t.url+"?"+t.data),t.withCredentials&&(n.withCredentials=!0),t.beforeSend&&"function"==typeof t.beforeSend&&t.beforeSend.call(),n.open(t.type,t.url,t.async),e(t.data)||n.setRequestHeader("Content-type",t["content-type"]),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.onreadystatechange=function(){4==n.readyState&&200==n.status&&o(n.responseText)},n.send(t.data)}};return{call:t}}();e.exports=n},function(e,t){e.exports=function(e){var t=null;e.input=null,e.init=function(r){if(!r.url)return void codex.core.log("can't send request because `url` is missed","Transport module","error");t=r;var a=document.createElement("INPUT");a.type="file",t&&t.multiple&&a.setAttribute("multiple","multiple"),t&&t.accept&&a.setAttribute("accept",t.accept),a.addEventListener("change",o,!1),e.input=a,n()};var n=function(){e.input.click()},o=function(){for(var n=t.url,o=t.beforeSend,r=t.success,a=t.error,i=new FormData,d=e.input.files,c=0;c<d.length;c++)i.append("files[]",d[c],d[c].name);codex.ajax.call({type:"POST",data:i,url:n,beforeSend:o,success:r,error:a})};return e}({})},function(e,t){e.exports=function(){var e=function(e){var t=document.getElementById("js-mobile-menu-holder"),n="mobile-menu-holder--opened";t.classList.toggle(n),e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault()},t={CHECKED_CLASS:"checked",init:function(){var e=document.getElementsByClassName("js-custom-checkbox");if(e.length)for(var t=e.length-1;t>=0;t--)e[t].addEventListener("click",codex.content.customCheckboxes.clicked,!1)},clicked:function(){var e=this,t=this.querySelector("input"),n=this.classList.contains(codex.content.customCheckboxes.CHECKED_CLASS);e.classList.toggle(codex.content.customCheckboxes.CHECKED_CLASS),n?t.removeAttribute("checked"):t.setAttribute("checked","checked")}},n={CLICKED_CLASS:"click-again-to-approve",init:function(){var e=document.getElementsByClassName("js-approval-button");if(e.length)for(var t=e.length-1;t>=0;t--)e[t].addEventListener("click",codex.content.approvalButtons.clicked,!1)},clicked:function(e){var t=this,n=this.classList.contains(codex.content.approvalButtons.CLICKED_CLASS);n||(t.classList.add(codex.content.approvalButtons.CLICKED_CLASS),e.preventDefault())}};return{toggleMobileMenu:e,customCheckboxes:t,approvalButtons:n}}()},function(e,t){var n={page:1,settings:null,blockForItems:null,loadMoreButton:null,buttonText:null,init:function(e){return this.settings=e,this.loadMoreButton=document.getElementById(this.settings.buttonId),!!this.loadMoreButton&&(this.blockForItems=document.getElementById(this.settings.targetBlockId),!!this.blockForItems&&(this.page=e.currentPage,this.buttonText=this.loadMoreButton.innerHTML,this.settings.autoLoading&&(this.autoLoading.isAllowed=!0),void this.loadMoreButton.addEventListener("click",function(e){codex.appender.load(),e.preventDefault(),codex.appender.autoLoading.init()},!1)))},load:function(){var e=this.settings.url+(parseInt(this.page)+1);codex.ajax.call({type:"post",url:e,data:{},beforeSend:function(){codex.appender.loadMoreButton.classList.add("loading")},success:function(e){if(e=JSON.parse(e),e.success){if(!e.pages)return;codex.appender.blockForItems.innerHTML+=e.pages,codex.appender.page++,codex.appender.settings.autoLoading&&(codex.appender.autoLoading.canLoad=!0),e.next_page||codex.appender.disable()}else codex.core.showException("Не удалось подгрузить новости");codex.appender.loadMoreButton.classList.remove("loading")}})},disable:function(){codex.appender.loadMoreButton.style.display="none",codex.appender.autoLoading.isLaunched&&codex.appender.autoLoading.disable()},autoLoading:{isAllowed:!1,isLaunched:!1,canLoad:!0,init:function(){this.isAllowed&&(window.addEventListener("scroll",codex.appender.autoLoading.scrollEvent),codex.appender.autoLoading.isLaunched=!0)},disable:function(){window.removeEventListener("scroll",codex.appender.autoLoading.scrollEvent),codex.appender.autoLoading.isLaunched=!1},scrollEvent:function(){var e=window.pageYOffset+window.innerHeight>=document.body.clientHeight;e&&codex.appender.autoLoading.canLoad&&(codex.appender.autoLoading.canLoad=!1,codex.appender.load())}}};e.exports=n},function(e,t){var n={input:null,init:function(){var e=this;this.input.addEventListener("paste",function(){e.inputPasteCallback()},!1)},inputPasteCallback:function(){var e=this.input,t=this;window.setTimeout(function(){t.sendRequest(e.value)},100)},sendRequest:function(e){codex.core.ajax({type:"get",url:"/ajax/get_page",data:{url:e},success:function(t){var n,o,r;1==t.success?(n=document.getElementById("page_form_title"),o=document.getElementById("page_form_content"),r=document.getElementById("source_link"),n.value=t.title,o.value=t.article,r.value=e,document.getElementsByClassName("redactor_redactor")[0].innerHTML=t.article):codex.core.showException("Не удалось импортировать страницу")}})}};e.exports=n},function(e,t){e.exports=function(){function e(e){f=document.getElementById(e.listId),m&&p()}function t(e){if(!e.classList.contains(h.replyOpened)){var t={parentId:e.dataset.parentId,rootId:e.dataset.rootId,action:e.dataset.action},o=n(t);codex.core.insertAfter(e,o),e.classList.add(h.replyOpened),i(o).focus()}}function n(e){var t=o(),n=r(),a=document.createElement("DIV");return a.classList.add(h.replyForm),t.dataset.parentId=e.parentId,t.dataset.rootId=e.rootId,t.dataset.action=e.action,a.appendChild(t),a.appendChild(n),a}function o(){var e=document.createElement("TEXTAREA");return e.classList.add(h.replyTextarea),e.placeholder="Ваш комментарий",e.addEventListener("keydown",s,!1),e.addEventListener("blur",d,!1),codex.autoresizeTextarea.addListener(e),e}function r(){var e=document.createElement("DIV");return e.classList.add(h.replySubmitButton,"button","master"),e.textContent="Отправить",e.addEventListener("click",a,!1),e}function a(){var e=this,t=e.parentNode,n=i(t);l(n)}function i(e){return e.getElementsByTagName("TEXTAREA")[0]}function d(e){var t=e.target,n=t.parentNode,o=t.dataset.parentId;t.value.trim()||c(n,o)}function c(e,t){var n=document.getElementById("reply"+t);e.remove(),n.classList.remove(h.replyOpened)}function s(e){var t=e.ctrlKey||e.metaKey,n=13==e.keyCode,o=e.target;t&&n&&(l(o),e.preventDefault())}function l(e){var t=new FormData,n=e.parentNode,o=n.querySelector("."+h.replySubmitButton),r=e.dataset.rootId,a=e.dataset.parentId,i=e.dataset.action;t.append("root_id",r),t.append("parent_id",a),t.append("comment_text",e.value),t.append("csrf",window.csrf),codex.ajax.call({type:"POST",url:i,data:t,beforeSend:function(){o.classList.add("loading")},success:function(e){var t,r;o.classList.remove("loading"),e=JSON.parse(e),e.success?(c(n,a),r=document.querySelector(".js-empty-comments"),r&&r.remove(),t=codex.core.parseHTML(e.comment)[0],f.appendChild(t),window.scrollTo(0,document.body.scrollHeight),u(e.commentId)):codex.alerts.show(e.error)}})}function u(e){var t=document.getElementById("comment"+e);t.classList.add(h.highlighted),window.setTimeout(function(){t.classList.remove(h.highlighted)},500)}function p(){var e,t=m.match(/\d+/);t&&(e=t[0],u(e))}var f=null,m=document.location.hash,h={replyForm:"comments-form",replyTextarea:"comment-form__text",replyOpened:"comment-form__placeholder--opened",replySubmitButton:"comment-form__button",highlighted:"comment--highligthed"};return{init:e,reply:t}}()},function(e,t,n){e.exports=function(){function e(){return!!r||(r=document.createElement("DIV"),r.classList.add(o.wrapper),void document.body.appendChild(r))}function t(t){e();var n=document.createElement("DIV");n.classList.add(o.exception),n.innerHTML=t,r.appendChild(n),n.classList.add("bounceIn"),window.setTimeout(function(){n.remove()},8e3)}n(11);var o={wrapper:"exceptionWrapper",exception:"clientException"},r=null;return{show:t}}({})},function(e,t){},function(e,t){e.exports=function(){var e=function(){var e=document.getElementsByClassName("js-autoresizable");if(e.length)for(var n=0;n<e.length;n++)t(e[n])},t=function(e){e.addEventListener("input",n,!1)},n=function(e){var t=e.target;o(t)},o=function(e){e.scrollHeight>e.clientHeight&&(e.style.height=e.scrollHeight+"px")};return{init:e,addListener:t}}()},function(e,t){e.exports=function(){var e=function(){t()},t=function(){var e=document.getElementById("repeat-email-confirmation");e.addEventListener("click",n)},n=function(e){var t=function(t){t=JSON.parse(t),codex.alerts.show(t.message),e.target.classList.remove("loading")};e.target.classList.add("loading"),codex.ajax.call({url:"/ajax/confirmation-email",success:t})};return{init:e}}()},function(e,t){var n={init:function(){for(var e=document.querySelectorAll(".js-share"),t=e.length-1;t>=0;t--)e[t].addEventListener("click",n.click,!0)},shareVk:function(e){var t="https://vk.com/share.php?";t+="url="+e.url,t+="&title="+e.title,t+="&description="+e.desc,t+="&image="+e.img,t+="&noparse=true",this.popup(t,"vkontakte")},shareFacebook:function(e){var t=0x62eef6f1917ee,n="https://www.facebook.com/dialog/share?display=popup";n+="&app_id="+t,n+="&href="+e.url,n+="&redirect_uri="+document.location.href,this.popup(n,"facebook")},shareTwitter:function(e){var t="https://twitter.com/share?";t+="text="+e.title,t+="&url="+e.url,t+="&counturl="+e.url,this.popup(t,"twitter")},shareTelegram:function(e){var t="https://telegram.me/share/url";t+="?text="+e.title,t+="&url="+e.url,this.popup(t,"telegram")},popup:function(e,t){window.open(e,"","toolbar=0,status=0,width=626,height=436"),window.yaCounter32652805&&window.yaCounter32652805.reachGoal("article-share",function(){},this,{type:t,url:e})},click:function(e){var t=e.target,o=t.dataset.shareType||t.parentNode.dataset.shareType;if(n[o]){var r={url:t.dataset.url||t.parentNode.dataset.url,title:t.dataset.title||t.parentNode.dataset.title,desc:t.dataset.desc||t.parentNode.dataset.desc,img:t.dataset.img||t.parentNode.dataset.title};n[o](r)}}};e.exports=n},function(e,t){e.exports=function(){var e={_editorIsReady:!1,_settings:{hideEditorToolbar:!1,titleId:"editorWritingTitle",initialBlockPlugin:"paragraph",items:[],plugins:["paragraph","header"],holderId:null,pageId:null,parentId:null},prepare:function(n){return e._mergeSettings(n),t(e._settings.plugins).then(function(){e._editorIsReady=!0})},_mergeSettings:function(t){for(var n in t)e._settings[n]=t[n]},_appendTextareaToTarget:function(t){var n;n=e._createElem("TEXTAREA",{name:"content",id:"json_result",hidden:!0},[]),t.appendChild(n)},_createElem:function(e,t,n){var o=document.createElement(e);for(var r in t)o[r]=t[r];for(var a in n)o.classList.add(n[a]);return o},_startEditor:function(){codex.editor.start({holderId:e._settings.holderId,initialBlockPlugin:e._settings.initialBlockPlugin,hideToolbar:e._settings.hideEditorToolbar,tools:{paragraph:{type:"paragraph",iconClassname:"ce-icon-paragraph",render:paragraph.render,validate:paragraph.validate,save:paragraph.save,allowedToPaste:!0,showInlineToolbar:!0,destroy:paragraph.destroy,allowRenderOnPaste:!0},header:{type:"header",iconClassname:"ce-icon-header",appendCallback:header.appendCallback,makeSettings:header.makeSettings,render:header.render,validate:header.validate,save:header.save,destroy:header.destroy,displayInToolbox:!0}},data:{items:e._settings.items}}),document.getElementById(e._settings.titleId).focus()},init:function(){if(e._editorIsReady){var t=document.getElementById(e._settings.holderId);e._appendTextareaToTarget(t),e._startEditor()}},open:function(t,n,o){if(e._editorIsReady){var r=t;document.getElementById(n).classList.remove("hide"),r.classList.add(o),r.onclick=null,e.init()}}},t=function(){var e={_version:"1.6",load:function(t){var n=t.map(e._loadPlugin);return n.push(e._loadCore()),Promise.all(n)},_loadCore:function(){var t="https://cdn.ifmo.su/editor/v"+e._version+"/codex-editor",n=t+".js",o=t+".css";return Promise.all([codex.loader.importScript(n,"editor-core"),codex.loader.importStyle(o,"editor-core")])},_loadPlugin:function(t){var n="https://cdn.ifmo.su/editor/v"+e._version+"/plugins/"+t+"/"+t,o=n+".js",r=n+".css";return Promise.all([codex.loader.importScript(o,t),codex.loader.importStyle(r,t)])}};return e.load}(),n=function(){return{submitAtlasForm:function(){var e=document.forms.atlas;if(e){var t=document.getElementById("json_result");codex.editor.saver.saveBlocks(),window.setTimeout(function(){var n=codex.editor.state.jsonOutput.length;n?t.innerHTML=JSON.stringify({data:codex.editor.state.jsonOutput}):t.innerHTML="",e.submit()},100)}},openEditorFullscreen:function(){var e=document.forms.atlas,t=document.createElement("input");t.type="hidden",t.name="openFullScreen",t.value=1,e.append(t),this.submitAtlasForm()}}}();return{init:e.init,prepare:e.prepare,open:e.open,openEditorFullscreen:n.openEditorFullscreen,submitAtlasForm:n.submitAtlasForm}}()},function(e,t){e.exports={prefixJS:"cdx-loader-js-",prefixCSS:"cdx-loader-css-",importScript:function(e,t){return new Promise(function(n,o){var r;t?document.getElementById(this.prefixJS+t)&&n(e):o("Instance name is missed"),r=document.createElement("SCRIPT"),r.async=!0,r.defer=!0,r.id=codex.loader.prefixJS+t,r.onload=function(){n(e)},r.onerror=function(){o(e)},r.src=e,document.head.appendChild(r)})},importStyle:function(e,t){return new Promise(function(n,o){var r;t?document.getElementById(this.prefixCSS+t)&&n(e):o("Instance name is missed"),r=document.createElement("LINK"),r.type="text/css",r.href=e,r.rel="stylesheet",r.id=codex.loader.prefixCSS+t,r.onload=function(){n(e)},r.onerror=function(){o(e)},r.src=e,document.head.appendChild(r)})}}}]);
//# sourceMappingURL=bundle.js.map