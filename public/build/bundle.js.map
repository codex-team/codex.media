{"version":3,"sources":["webpack:///public/build/bundle.js","webpack:///webpack/bootstrap 863a2f6abc8d3d8408a9","webpack:///./public/app/js/main.js","webpack:///./public/app/js/modules/core.js","webpack:///./public/app/js/modules/ajax.js","webpack:///./public/app/js/modules/transport.js","webpack:///./public/app/js/modules/content.js","webpack:///./public/app/js/modules/appender.js","webpack:///./public/app/js/modules/parser.js","webpack:///./public/app/js/modules/comments.js","webpack:///./public/app/js/modules/alerts.js","webpack:///./public/app/js/modules/islandSettings.js","webpack:///./public/app/js/modules/autoresizeTextarea.js","webpack:///./public/app/js/modules/user.js","webpack:///./public/app/js/modules/sharer.js","webpack:///./public/app/js/modules/writing.js","webpack:///./public/app/js/modules/loader.js","webpack:///./public/app/js/modules/scrollUp.js","webpack:///./public/app/js/modules/branding.js","webpack:///./public/app/js/modules/pages.js"],"names":["codex","modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","nodes","content","init","customCheckboxes","approvalButtons","autoresizeTextarea","window","codexSpecial","blockId","scrollUp","core","log","branding","docReady","f","test","document","readyState","setTimeout","ajax","transport","appender","parser","comments","alerts","islandSettings","user","sharer","writing","loader","pages","str","prefix","type","arg","staticLength","length","substr","console","e","getOffset","elem","docElem","win","rect","doc","getClientRects","getBoundingClientRect","width","height","ownerDocument","documentElement","top","pageYOffset","clientTop","left","pageXOffset","clientLeft","isElementOnScreen","el","elPositon","screenBottom","scrollY","innerHeight","css","getComputedStyle","insertAfter","target","element","parentNode","insertBefore","nextSibling","replace","nodeToReplace","replaceWith","replaceChild","random","min","max","Math","floor","delegateEvent","targetSelector","eventName","callback","addEventListener","event","matched","matches","parentElement","nodeTypes","TAG","TEXT","COMMENT","DOCUMENT_FRAGMENT","keys","BACKSPACE","TAB","ENTER","SHIFT","CTRL","ALT","ESC","SPACE","LEFT","UP","DOWN","RIGHT","DELETE","META","isDomNode","nodeType","this","parseHTML","inputString","contentHolder","childs","parsedNodes","createElement","innerHTML","trim","childNodes","node","i","textContent","push","isEmpty","obj","Object","isVisible","offsetParent","setCookie","name","value","expires","path","domain","toGMTString","cookie","getCookie","dc","begin","indexOf","end","unescape","substring","isFormData","object","append","data","url","XMLHTTP","XMLHttpRequest","ActiveXObject","successFunction","async","success","withCredentials","beforeSend","open","setRequestHeader","onreadystatechange","status","responseText","send","config_","input","configuration","inputElement","multiple","setAttribute","accept","send_","clickInput_","click","error","formData","FormData","files","toggle","which","marker","elements","querySelectorAll","classList","toggleMobileMenu","menu","getElementById","openedClass","stopPropagation","stopImmediatePropagation","preventDefault","CHECKED_CLASS","checkboxes","getElementsByClassName","clicked","checkbox","querySelector","isChecked","contains","removeAttribute","CLICKED_CLASS","buttons","button","isClicked","add","page","settings","blockForItems","loadMoreButton","buttonText","buttonId","targetBlockId","currentPage","autoLoading","isAllowed","load","requestUrl","parseInt","response","JSON","parse","list","canLoad","next_page","disable","showException","remove","style","display","isLaunched","scrollEvent","removeEventListener","scrollReachedEnd","body","clientHeight","_this","inputPasteCallback","sendRequest","title","sourceLink","article","commentsList","listId","anchor","highligthAnchor","reply","replyButton","CSS_","replyOpened","replyParams","parentId","dataset","rootId","action","form","createForm","getFormTextarea","focus","params","textarea","createTextarea","createButton","replyForm","appendChild","replyTextarea","placeholder","keydownSubmitHandler","blurTextareaHandler","addListener","replySubmitButton","submitClicked_","submit","getElementsByTagName","commentId","removeForm","ctrlPressed","ctrlKey","metaKey","enterPressed","keyCode","submitBtn","actionURL","csrf","comment","removeEmptyCommentsBlock","scrollTo","scrollHeight","highligthComment","activateMenu","show","emptyCommentsBlock","menuToggler","menuTogglerSelector","prepareToggler","highlighted","numbers","match","itemClicked","targetId","confirm","location","hash","prepare_","wrapper_","wrapper","message","notify","exception","menuHolder","activated","CSS","item","showed","menuTogglers","selector","toggler","menuTogglerHovered","menuParams","createMenu","opened","getMenuParams","assert","items","fill","move","initialSelector","filter","compareSelector","pop","itemData","itemElement","createItem","attr","itemEl","handler","block","container","textareas","textareaChanged","checkScrollHeight","photo","updatableElementsName","change","transportType","uploaded","uploadError","updateAll","newSource","updatebleImages","getElementsByName","src","changeStatus","changePassword","showForm","_csrf","label","requestChange","onclick","stringify","currentPassword","ajaxResponse","showSuccessMessage","text","textDiv","bio","edit","keydown","val","saved","newBio","createTextNode","shareButtons","shareVk","link","desc","img","popup","shareFacebook","FB_APP_ID","href","shareTwitter","shareTelegram","socialType","yaCounter32652805","reachGoal","shareType","shareData","mergeSettings","initSettings","key","startEditor","EDITOR_IMAGE","EDITOR_FILE","editor","start","holderId","initialBlockPlugin","hideToolbar","hideEditorToolbar","tools","paragraph","iconClassname","render","validate","save","allowedToPaste","showInlineToolbar","destroy","allowRenderOnPaste","header","appendCallback","makeSettings","displayInToolbox","image","prepare","isStretched","renderOnPastePatterns","pastePatterns","config","uploadImage","uploadFromUrl","attaches","cdxAttaches","fetchUrl","maxSize","titleInput","titleId","titleKeydownHandler","loadResource","resource","scriptUrl","script","styleUrl","Promise","all","importScript","importStyle","editorIsReady","submitButton","resources","pageId","loadEditorResources","then","focusRedactor","aloneTextNode","firstBlock","redactor","firstChild","firstToolWrapper","caret","set","targetClicked","formId","hidePlaceholderClass","holder","map","getForm","atlasForm","forms","atlas","JSONinput","hidden","saver","saveBlocks","notifications","notification","state","jsonOutput","submitResponse","redirect","openEditorFullscreen","prefixJS","prefixCSS","scriptPath","instanceName","resolve","reject","defer","onload","onerror","head","stylePath","rel","offsetToShow","layoutWidth","clickableZone","resizeStopWatcher","layoutHolderId","layout","offsetWidth","makeUI","scrollPage","windowScrollHandler","sizeChanged","resize","yCoords","notTheTop","windowWidth","clientWidth","leftColumtWidth","clearTimeout","arrow","emptyBrandingClass","loadingClass","preloaderClass","preloadShown","preload","fullUrl","previewUrl","preloader","backgroundImage","result","preview","currentItemClicked","openWriting","ajaxResponses","delete","newChild","addToMenu","promote","addToNews","getResponse","replaceMenu","oldMenu","newMenu"],"mappings":"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","file":"./public/build/bundle.js","sourcesContent":["var codex =\n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/**\r\n\t* Require CSS build\r\n\t*/\r\n\t__webpack_require__(1);\r\n\t\r\n\t/**\r\n\t* Codex client\r\n\t* @author Savchenko Peter <specc.dev@gmail.com>\r\n\t*/\r\n\tcodex = (function (codex) {\r\n\t\r\n\t    'use strict';\r\n\t\r\n\t    /**\r\n\t    * Static nodes cache\r\n\t    */\r\n\t    codex.nodes = {\r\n\t        content : null\r\n\t    };\r\n\t\r\n\t    codex.init = function () {\r\n\t\r\n\t        /**\r\n\t        * Stylize custom checkboxes\r\n\t        */\r\n\t        codex.content.customCheckboxes.init();\r\n\t\r\n\t        /**\r\n\t        * Init approval buttons\r\n\t        */\r\n\t        codex.content.approvalButtons.init();\r\n\t\r\n\t        codex.autoresizeTextarea.init();\r\n\t\r\n\t        /**\r\n\t        * Init CodeX Special module for contrast version\r\n\t        * @see https://github.com/codex-team/codex.special\r\n\t        */\r\n\t        window.codexSpecial.init({\r\n\t            blockId : 'js-contrast-version-holder',\r\n\t        });\r\n\t\r\n\t        /**\r\n\t         * Activate scroll-up button\r\n\t         */\r\n\t        codex.scrollUp.init('js-layout-holder');\r\n\t\r\n\t        /**\r\n\t         * Client is ready\r\n\t         */\r\n\t        codex.core.log('Initialized', 'CodeX', 'info');\r\n\t\r\n\t        /**\r\n\t         * Initiate branding preload\r\n\t         */\r\n\t        codex.branding.init();\r\n\t\r\n\t    };\r\n\t\r\n\t    return codex;\r\n\t\r\n\t})({});\r\n\t\r\n\t/**\r\n\t* Document ready handler\r\n\t*/\r\n\tcodex.docReady = function (f) {\r\n\t\r\n\t    /in/.test(document.readyState) ? window.setTimeout(codex.docReady, 9, f) : f();\r\n\t\r\n\t};\r\n\t\r\n\t\r\n\t/**\r\n\t* Load modules\r\n\t*/\r\n\tcodex.core               = __webpack_require__(3);\r\n\tcodex.ajax               = __webpack_require__(4);\r\n\tcodex.transport          = __webpack_require__(5);\r\n\tcodex.content            = __webpack_require__(6);\r\n\tcodex.appender           = __webpack_require__(7);\r\n\tcodex.parser             = __webpack_require__(8);\r\n\tcodex.comments           = __webpack_require__(9);\r\n\tcodex.alerts             = __webpack_require__(10);\r\n\tcodex.islandSettings     = __webpack_require__(12);\r\n\tcodex.autoresizeTextarea = __webpack_require__(13);\r\n\tcodex.user               = __webpack_require__(14);\r\n\tcodex.sharer             = __webpack_require__(15);\r\n\tcodex.writing            = __webpack_require__(16);\r\n\tcodex.loader             = __webpack_require__(17);\r\n\tcodex.scrollUp           = __webpack_require__(18);\r\n\tcodex.branding           = __webpack_require__(19);\r\n\tcodex.pages              = __webpack_require__(20);\r\n\t\r\n\t\r\n\tmodule.exports = codex;\r\n\t\r\n\tcodex.docReady(function () {\r\n\t\r\n\t    codex.init();\r\n\t\r\n\t});\r\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ },\n/* 2 */,\n/* 3 */\n/***/ function(module, exports) {\n\n\t/**\r\n\t* Significant core methods\r\n\t*/\r\n\t\r\n\tmodule.exports = {\r\n\t\r\n\t    /** Logging method */\r\n\t    log : function (str, prefix, type, arg) {\r\n\t\r\n\t        var staticLength = 32;\r\n\t\r\n\t        if (prefix) {\r\n\t\r\n\t            prefix = prefix.length < staticLength ? prefix : prefix.substr( 0, staticLength - 2 );\r\n\t\r\n\t            while (prefix.length < staticLength - 1) {\r\n\t\r\n\t                prefix += ' ';\r\n\t\r\n\t            }\r\n\t\r\n\t            prefix += ':';\r\n\t            str = prefix + str;\r\n\t\r\n\t        }\r\n\t\r\n\t        type = type || 'log';\r\n\t\r\n\t        try {\r\n\t\r\n\t            if ('console' in window && window.console[ type ]) {\r\n\t\r\n\t                if (arg) console[type](str, arg);\r\n\t                else console[type](str);\r\n\t\r\n\t            }\r\n\t\r\n\t        } catch(e) {}\r\n\t\r\n\t    },\r\n\t\r\n\t    /**\r\n\t    * @return {object} dom element real offset\r\n\t    */\r\n\t    getOffset : function (elem) {\r\n\t\r\n\t        var docElem, win, rect, doc;\r\n\t\r\n\t        if (!elem) {\r\n\t\r\n\t            return;\r\n\t\r\n\t        }\r\n\t\r\n\t        /**\r\n\t        * Support: IE <=11 only\r\n\t        * Running getBoundingClientRect on a\r\n\t        * disconnected node in IE throws an error\r\n\t        */\r\n\t        if (!elem.getClientRects().length) {\r\n\t\r\n\t            return {\r\n\t                top: 0,\r\n\t                left: 0\r\n\t            };\r\n\t\r\n\t        }\r\n\t\r\n\t        rect = elem.getBoundingClientRect();\r\n\t\r\n\t        /** Make sure element is not hidden (display: none) */\r\n\t        if (rect.width || rect.height) {\r\n\t\r\n\t            doc = elem.ownerDocument;\r\n\t            win = window;\r\n\t            docElem = doc.documentElement;\r\n\t\r\n\t            return {\r\n\t                top: rect.top + win.pageYOffset - docElem.clientTop,\r\n\t                left: rect.left + win.pageXOffset - docElem.clientLeft\r\n\t            };\r\n\t\r\n\t        }\r\n\t\r\n\t        /** Return zeros for disconnected and hidden elements (gh-2310) */\r\n\t        return rect;\r\n\t\r\n\t    },\r\n\t\r\n\t    /**\r\n\t    * Checks if element visible on screen at the moment\r\n\t    * @param {Element} - HTML NodeElement\r\n\t    */\r\n\t    isElementOnScreen : function (el) {\r\n\t\r\n\t        var elPositon    = codex.core.getOffset(el).top,\r\n\t            screenBottom = window.scrollY + window.innerHeight;\r\n\t\r\n\t        return screenBottom > elPositon;\r\n\t\r\n\t    },\r\n\t\r\n\t    /**\r\n\t    * Returns computed css styles for element\r\n\t    * @param {Element} el\r\n\t    */\r\n\t    css : function (el) {\r\n\t\r\n\t        return window.getComputedStyle(el);\r\n\t\r\n\t    },\r\n\t\r\n\t    /**\r\n\t    * Helper for inserting one element after another\r\n\t    */\r\n\t    insertAfter : function (target, element) {\r\n\t\r\n\t        target.parentNode.insertBefore(element, target.nextSibling);\r\n\t\r\n\t    },\r\n\t\r\n\t    /**\r\n\t    * Replaces node with\r\n\t    * @param {Element} nodeToReplace\r\n\t    * @param {Element} replaceWith\r\n\t    */\r\n\t    replace : function (nodeToReplace, replaceWith) {\r\n\t\r\n\t        return nodeToReplace.parentNode.replaceChild(replaceWith, nodeToReplace);\r\n\t\r\n\t    },\r\n\t\r\n\t    /**\r\n\t    * Helper for insert one element before another\r\n\t    */\r\n\t    insertBefore : function (target, element) {\r\n\t\r\n\t        target.parentNode.insertBefore(element, target);\r\n\t\r\n\t    },\r\n\t\r\n\t    /**\r\n\t    * Returns random {int} between numbers\r\n\t    */\r\n\t    random : function (min, max) {\r\n\t\r\n\t        return Math.floor(Math.random() * (max - min + 1)) + min;\r\n\t\r\n\t    },\r\n\t\r\n\t    /**\r\n\t    * Attach event to Element in parent\r\n\t    * @param {Element} parentNode    - Element that holds event\r\n\t    * @param {string} targetSelector - selector to filter target\r\n\t    * @param {string} eventName      - name of event\r\n\t    * @param {function} callback     - callback function\r\n\t    */\r\n\t    delegateEvent : function (parentNode, targetSelector, eventName, callback) {\r\n\t\r\n\t        parentNode.addEventListener(eventName, function (event) {\r\n\t\r\n\t            var el = event.target, matched;\r\n\t\r\n\t            while (el && !matched) {\r\n\t\r\n\t                matched = el.matches(targetSelector);\r\n\t\r\n\t                if (!matched) el = el.parentElement;\r\n\t\r\n\t            }\r\n\t\r\n\t            if (matched) {\r\n\t\r\n\t                callback.call(event.target, event, el);\r\n\t\r\n\t            }\r\n\t\r\n\t        }, true);\r\n\t\r\n\t    },\r\n\t\r\n\t\r\n\t    /**\r\n\t    * Readable DOM-node types map\r\n\t    */\r\n\t    nodeTypes : {\r\n\t        TAG     : 1,\r\n\t        TEXT    : 3,\r\n\t        COMMENT : 8,\r\n\t        DOCUMENT_FRAGMENT : 11\r\n\t    },\r\n\t\r\n\t    /**\r\n\t    * Readable keys map\r\n\t    */\r\n\t    keys : { BACKSPACE: 8, TAB: 9, ENTER: 13, SHIFT: 16, CTRL: 17, ALT: 18, ESC: 27, SPACE: 32, LEFT: 37, UP: 38, DOWN: 40, RIGHT: 39, DELETE: 46, META: 91 },\r\n\t\r\n\t    /**\r\n\t    * @protected\r\n\t    * Check object for DOM node\r\n\t    */\r\n\t    isDomNode : function (el) {\r\n\t\r\n\t        return el && typeof el === 'object' && el.nodeType && el.nodeType == this.nodeTypes.TAG;\r\n\t\r\n\t    },\r\n\t\r\n\t    /**\r\n\t    * Parses string to nodeList\r\n\t    * Removes empty text nodes\r\n\t    * @param {string} inputString\r\n\t    * @return {array} of nodes\r\n\t    *\r\n\t    * Does not supports <tr> and <td> on firts level of inputString\r\n\t    */\r\n\t\r\n\t    parseHTML : function (inputString) {\r\n\t\r\n\t        // var templatesSupported = spark.supports.templates();\r\n\t\r\n\t        var contentHolder,\r\n\t            childs,\r\n\t            parsedNodes = [];\r\n\t\r\n\t        // if ( false &&   templatesSupported ) {\r\n\t\r\n\t        //     contentHolder = document.createElement('template');\r\n\t        //     contentHolder.innerHTML = inputString.trim();\r\n\t\r\n\t        //     console.log(\"contentHolder: %o\", contentHolder);\r\n\t\r\n\t        //     childs = contentHolder.content.cloneNode(true).childNodes;\r\n\t\r\n\t        // } else {\r\n\t\r\n\t        contentHolder = document.createElement('div');\r\n\t        contentHolder.innerHTML = inputString.trim();\r\n\t\r\n\t        childs = contentHolder.childNodes;\r\n\t\r\n\t        // }\r\n\t\r\n\t\r\n\t        /**\r\n\t        * Iterate childNodes and remove empty Text Nodes on first-level\r\n\t        */\r\n\t        for (var i = 0, node; !!(node = childs[i]); i++) {\r\n\t\r\n\t            if (node.nodeType == codex.core.nodeTypes.TEXT && !node.textContent.trim()) {\r\n\t\r\n\t                continue;\r\n\t\r\n\t            }\r\n\t\r\n\t            parsedNodes.push(node);\r\n\t\r\n\t        }\r\n\t\r\n\t        return parsedNodes;\r\n\t\r\n\t    },\r\n\t\r\n\t    /**\r\n\t    * Checks passed object for emptiness\r\n\t    * @require ES5 - Object.keys\r\n\t    * @param {object}\r\n\t    */\r\n\t    isEmpty : function (obj) {\r\n\t\r\n\t        return Object.keys(obj).length === 0;\r\n\t\r\n\t    },\r\n\t\r\n\t    /**\r\n\t    * Check for Element visibility\r\n\t    * @param {Element} el\r\n\t    */\r\n\t    isVisible : function (el) {\r\n\t\r\n\t        return el.offsetParent !== null;\r\n\t\r\n\t    },\r\n\t\r\n\t    setCookie : function (name, value, expires, path, domain) {\r\n\t\r\n\t        var str = name + '=' + value;\r\n\t\r\n\t        if (expires) str += '; expires=' + expires.toGMTString();\r\n\t        if (path)    str += '; path=' + path;\r\n\t        if (domain)  str += '; domain=' + domain;\r\n\t\r\n\t        document.cookie = str;\r\n\t\r\n\t    },\r\n\t\r\n\t    getCookie : function (name) {\r\n\t\r\n\t        var dc = document.cookie;\r\n\t\r\n\t        var prefix = name + '=',\r\n\t            begin = dc.indexOf('; ' + prefix);\r\n\t\r\n\t        if (begin == -1) {\r\n\t\r\n\t            begin = dc.indexOf(prefix);\r\n\t            if (begin !== 0) return null;\r\n\t\r\n\t        } else\r\n\t            begin += 2;\r\n\t\r\n\t        var end = document.cookie.indexOf(';', begin);\r\n\t\r\n\t        if (end == -1) end = dc.length;\r\n\t\r\n\t        return unescape(dc.substring(begin + prefix.length, end));\r\n\t\r\n\t    },\r\n\t\r\n\t};\r\n\n\n/***/ },\n/* 4 */\n/***/ function(module, exports) {\n\n\t/**\r\n\t* AJAX module\r\n\t*/\r\n\tvar ajax = (function () {\r\n\t\r\n\t    /**\r\n\t    * @usage codex.ajax.call();\r\n\t    */\r\n\t    var call = function (data) {\r\n\t\r\n\t        if (!data || !data.url) return;\r\n\t\r\n\t        var XMLHTTP          = window.XMLHttpRequest ? new window.XMLHttpRequest() : new window.ActiveXObject('Microsoft.XMLHTTP'),\r\n\t            successFunction  = function () {};\r\n\t\r\n\t        data.async           = true;\r\n\t        data.type            = data.type || 'GET';\r\n\t        data.data            = data.data || '';\r\n\t        data['content-type'] = data['content-type'] || 'application/json; charset=utf-8';\r\n\t        successFunction      = data.success || successFunction;\r\n\t\r\n\t        if (data.type == 'GET' && data.data) {\r\n\t\r\n\t            data.url = /\\?/.test(data.url) ? data.url + '&' + data.data : data.url + '?' + data.data;\r\n\t\r\n\t        }\r\n\t\r\n\t        if (data.withCredentials) {\r\n\t\r\n\t            XMLHTTP.withCredentials = true;\r\n\t\r\n\t        }\r\n\t\r\n\t        if (data.beforeSend && typeof data.beforeSend == 'function') {\r\n\t\r\n\t            data.beforeSend.call();\r\n\t\r\n\t        }\r\n\t\r\n\t        XMLHTTP.open(data.type, data.url, data.async);\r\n\t\r\n\t        /**\r\n\t        * If we send FormData, we need no content-type header\r\n\t        */\r\n\t        if (!isFormData(data.data)) {\r\n\t\r\n\t            XMLHTTP.setRequestHeader('Content-type', data['content-type']);\r\n\t\r\n\t        }\r\n\t\r\n\t        XMLHTTP.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\r\n\t        XMLHTTP.onreadystatechange = function () {\r\n\t\r\n\t            if (XMLHTTP.readyState == 4 && XMLHTTP.status == 200) {\r\n\t\r\n\t                successFunction(XMLHTTP.responseText);\r\n\t\r\n\t            }\r\n\t\r\n\t        };\r\n\t\r\n\t        XMLHTTP.send(data.data);\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t     * Function for checking is it FormData object to send.\r\n\t     * @param {Object} object to check\r\n\t     * @return boolean\r\n\t     */\r\n\t    function isFormData(object) {\r\n\t\r\n\t        return typeof object.append === 'function';\r\n\t\r\n\t    };\r\n\t\r\n\t    return {\r\n\t\r\n\t        call : call\r\n\t\r\n\t    };\r\n\t\r\n\t}());\r\n\t\r\n\tmodule.exports = ajax;\r\n\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\n\t/**\r\n\t * File transport module\r\n\t *\r\n\t * @module Transport module. Uploads file and returns some response from server\r\n\t * @copyright Codex-Team 2017\r\n\t *\r\n\t * @example\r\n\t *\r\n\t * Basic usage :\r\n\t *  codex.transport.init( {\r\n\t *      url : fetchURL,\r\n\t *      multiple : bool,\r\n\t *      accept : string  // http://htmlbook.ru/html/input/accept\r\n\t *      beforeSend : Function,\r\n\t *      success : Function,\r\n\t *      error : Function\r\n\t * });\r\n\t *\r\n\t * You can handle all of this event like:\r\n\t *  - what should happen before data sending with XMLHTTP\r\n\t *  - what should after success request\r\n\t *  - error handler\r\n\t */\r\n\t\r\n\tmodule.exports = ( function (transport) {\r\n\t\r\n\t    /** Empty configuration */\r\n\t    var config_ = null;\r\n\t\r\n\t    /** File holder */\r\n\t    transport.input = null;\r\n\t\r\n\t    /** initialize module */\r\n\t    transport.init = function (configuration) {\r\n\t\r\n\t        if (!configuration.url) {\r\n\t\r\n\t            codex.core.log('can\\'t send request because `url` is missed', 'Transport module', 'error');\r\n\t            return;\r\n\t\r\n\t        }\r\n\t\r\n\t        config_ = configuration;\r\n\t\r\n\t        var inputElement = document.createElement('INPUT');\r\n\t\r\n\t        inputElement.type = 'file';\r\n\t\r\n\t        if (config_ && config_.multiple) {\r\n\t\r\n\t            inputElement.setAttribute('multiple', 'multiple');\r\n\t\r\n\t        }\r\n\t\r\n\t        if (config_ && config_.accept) {\r\n\t\r\n\t            inputElement.setAttribute('accept', config_.accept);\r\n\t\r\n\t        }\r\n\t\r\n\t        inputElement.addEventListener('change', send_, false);\r\n\t\r\n\t        /** Save input */\r\n\t        transport.input = inputElement;\r\n\t\r\n\t        /** click input to show upload window */\r\n\t        clickInput_();\r\n\t\r\n\t    };\r\n\t\r\n\t    var clickInput_ = function () {\r\n\t\r\n\t        transport.input.click();\r\n\t\r\n\t    };\r\n\t\r\n\t    var send_ = function () {\r\n\t\r\n\t        var url        = config_.url,\r\n\t            beforeSend = config_.beforeSend,\r\n\t            success    = config_.success,\r\n\t            error      = config_.error,\r\n\t            formData   = new FormData(),\r\n\t            files      = transport.input.files;\r\n\t\r\n\t        if (files.length > 1) {\r\n\t\r\n\t            for (var i = 0; i < files.length; i++) {\r\n\t\r\n\t                formData.append('files[]', files[i], files[i].name);\r\n\t\r\n\t            }\r\n\t\r\n\t        } else {\r\n\t\r\n\t            formData.append('files', files[0], files[0].name);\r\n\t\r\n\t        }\r\n\t\r\n\t        codex.ajax.call({\r\n\t            type : 'POST',\r\n\t            data : formData,\r\n\t            url : url,\r\n\t            beforeSend : beforeSend,\r\n\t            success : success,\r\n\t            error : error\r\n\t        });\r\n\t\r\n\t    };\r\n\t\r\n\t    return transport;\r\n\t\r\n\t})({});\r\n\n\n/***/ },\n/* 6 */\n/***/ function(module, exports) {\n\n\t/**\r\n\t* Operations with pages\r\n\t*/\r\n\tmodule.exports = (function () {\r\n\t\r\n\t     /**\r\n\t    * Toggles classname on passed blocks\r\n\t    * @param {string} selector\r\n\t    * @param {string} toggled classname\r\n\t    */\r\n\t    var toggle = function ( which, marker ) {\r\n\t\r\n\t        var elements = document.querySelectorAll( which );\r\n\t\r\n\t        for (var i = elements.length - 1; i >= 0; i--) {\r\n\t\r\n\t            elements[i].classList.toggle( marker );\r\n\t\r\n\t        }\r\n\t\r\n\t    };\r\n\t\r\n\t\r\n\t    /**\r\n\t    * Toggles mobile menu\r\n\t    * Handles clicks on the hamburger icon in header\r\n\t    */\r\n\t    var toggleMobileMenu = function ( event ) {\r\n\t\r\n\t        var menu = document.getElementById('js-mobile-menu-holder'),\r\n\t            openedClass = 'mobile-menu-holder--opened';\r\n\t\r\n\t        menu.classList.toggle(openedClass);\r\n\t\r\n\t        event.stopPropagation();\r\n\t        event.stopImmediatePropagation();\r\n\t        event.preventDefault();\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t    * Module uses for toggle custom checkboxes\r\n\t    * that has 'js-custom-checkbox' class and input[type=\"checkbox\"] included\r\n\t    * Example:\r\n\t    * <span class=\"js-custom-checkbox\">\r\n\t    *    <input type=\"checkbox\" name=\"\" value=\"1\"/>\r\n\t    * </span>\r\n\t    */\r\n\t    var customCheckboxes = {\r\n\t\r\n\t        /**\r\n\t        * This class specifies checked custom-checkbox\r\n\t        * You may set it on serverisde\r\n\t        */\r\n\t        CHECKED_CLASS : 'checked',\r\n\t\r\n\t        init : function () {\r\n\t\r\n\t            var checkboxes = document.getElementsByClassName('js-custom-checkbox');\r\n\t\r\n\t            if (checkboxes.length) for (var i = checkboxes.length - 1; i >= 0; i--) {\r\n\t\r\n\t                checkboxes[i].addEventListener('click', codex.content.customCheckboxes.clicked, false);\r\n\t\r\n\t            }\r\n\t\r\n\t        },\r\n\t\r\n\t        clicked : function () {\r\n\t\r\n\t            var checkbox  = this,\r\n\t                input     = this.querySelector('input'),\r\n\t                isChecked = this.classList.contains(codex.content.customCheckboxes.CHECKED_CLASS);\r\n\t\r\n\t            checkbox.classList.toggle(codex.content.customCheckboxes.CHECKED_CLASS);\r\n\t\r\n\t            if (isChecked) {\r\n\t\r\n\t                input.removeAttribute('checked');\r\n\t\r\n\t            } else {\r\n\t\r\n\t                input.setAttribute('checked', 'checked');\r\n\t\r\n\t            }\r\n\t\r\n\t        }\r\n\t    };\r\n\t\r\n\t    var approvalButtons = {\r\n\t\r\n\t        CLICKED_CLASS : 'click-again-to-approve',\r\n\t\r\n\t        init : function () {\r\n\t\r\n\t            var buttons = document.getElementsByClassName('js-approval-button');\r\n\t\r\n\t            if (buttons.length) for (var i = buttons.length - 1; i >= 0; i--) {\r\n\t\r\n\t                buttons[i].addEventListener('click', codex.content.approvalButtons.clicked, false);\r\n\t\r\n\t            }\r\n\t\r\n\t        },\r\n\t\r\n\t        clicked : function (event) {\r\n\t\r\n\t            var button    = this,\r\n\t                isClicked = this.classList.contains(codex.content.approvalButtons.CLICKED_CLASS);\r\n\t\r\n\t            if (!isClicked) {\r\n\t\r\n\t                /*  ,        */\r\n\t                button.classList.add(codex.content.approvalButtons.CLICKED_CLASS);\r\n\t\r\n\t                event.preventDefault();\r\n\t\r\n\t            }\r\n\t\r\n\t        }\r\n\t    };\r\n\t\r\n\t    return {\r\n\t\r\n\t        toggleMobileMenu : toggleMobileMenu,\r\n\t        customCheckboxes : customCheckboxes,\r\n\t        approvalButtons : approvalButtons,\r\n\t        toggle : toggle\r\n\t\r\n\t    };\r\n\t\r\n\t}());\n\n/***/ },\n/* 7 */\n/***/ function(module, exports) {\n\n\t/**\r\n\t * Appender is being used for ajax-loading next pages of lists\r\n\t *\r\n\t *    codex.appender.init({\r\n\t *        buttonId      : 'buttonLoadNews',       // button for listening\r\n\t *        currentPage   : '<?= $page_number ?>',    // currentPage number\r\n\t *        url           : '/',                      // url for ajax-requests\r\n\t *        targetBlockId : 'list_of_news',           // target for appending\r\n\t *        autoLoading   : true,                     // allow loading when reach bottom while scrolling\r\n\t *    });\r\n\t */\r\n\t\r\n\tvar appender = {\r\n\t\r\n\t    /* Pagination. Here is a number of current page */\r\n\t    page : 1,\r\n\t\r\n\t    settings : null,\r\n\t\r\n\t    blockForItems : null,\r\n\t\r\n\t    loadMoreButton : null,\r\n\t\r\n\t    /**\r\n\t     * Button's text for saving it.\r\n\t     * On its place dots will be while news are loading\r\n\t     */\r\n\t    buttonText : null,\r\n\t\r\n\t    init : function (settings) {\r\n\t\r\n\t        this.settings = settings;\r\n\t\r\n\t        /* Checking for existing button and field for loaded info */\r\n\t        this.loadMoreButton = document.getElementById(this.settings.buttonId);\r\n\t\r\n\t        if (!this.loadMoreButton) return false;\r\n\t\r\n\t        this.blockForItems = document.getElementById(this.settings.targetBlockId);\r\n\t\r\n\t        if (!this.blockForItems) return false;\r\n\t\r\n\t        this.page       = settings.currentPage;\r\n\t        this.buttonText = this.loadMoreButton.innerHTML;\r\n\t\r\n\t        if (this.settings.autoLoading) this.autoLoading.isAllowed = true;\r\n\t\r\n\t        this.loadMoreButton.addEventListener('click', function (event) {\r\n\t\r\n\t            codex.appender.load();\r\n\t\r\n\t            event.preventDefault();\r\n\t\r\n\t            codex.appender.autoLoading.init();\r\n\t\r\n\t        }, false);\r\n\t\r\n\t    },\r\n\t\r\n\t    load : function () {\r\n\t\r\n\t        var requestUrl = this.settings.url + (parseInt(this.page) + 1);\r\n\t            // separator   = '<a href=\"' + requestUrl + '\"><div class=\"article post-list-item w_island separator\">Page ' + (parseInt(this.page) + 1) + '</div></a>';\r\n\t\r\n\t        codex.ajax.call({\r\n\t            type: 'post',\r\n\t            url: requestUrl,\r\n\t            data: {},\r\n\t            beforeSend : function () {\r\n\t\r\n\t                codex.appender.loadMoreButton.classList.add('loading');\r\n\t\r\n\t            },\r\n\t            success : function (response) {\r\n\t\r\n\t                response = JSON.parse(response);\r\n\t\r\n\t                if (response.success) {\r\n\t\r\n\t                    if (!response.list) return;\r\n\t\r\n\t                    /* Append items */\r\n\t                    // codex.appender.blockForItems.innerHTML += separator;\r\n\t                    codex.appender.blockForItems.innerHTML += response.list;\r\n\t\r\n\t                    /* Next page */\r\n\t                    codex.appender.page++;\r\n\t\r\n\t                    if (codex.appender.settings.autoLoading) {\r\n\t\r\n\t                        /* Removing restriction for auto loading */\r\n\t                        codex.appender.autoLoading.canLoad = true;\r\n\t\r\n\t                    }\r\n\t\r\n\t                    /* Checking for next page's existing. If no  hide the button for loading news and remove listener */\r\n\t                    if (!response.next_page) codex.appender.disable();\r\n\t\r\n\t                } else {\r\n\t\r\n\t                    codex.core.showException('   ');\r\n\t\r\n\t                }\r\n\t\r\n\t                codex.appender.loadMoreButton.classList.remove('loading');\r\n\t\r\n\t            }\r\n\t\r\n\t        });\r\n\t\r\n\t    },\r\n\t\r\n\t    disable : function () {\r\n\t\r\n\t        codex.appender.loadMoreButton.style.display = 'none';\r\n\t\r\n\t        if (codex.appender.autoLoading.isLaunched) {\r\n\t\r\n\t            codex.appender.autoLoading.disable();\r\n\t\r\n\t        }\r\n\t\r\n\t    },\r\n\t\r\n\t    autoLoading : {\r\n\t\r\n\t        isAllowed : false,\r\n\t\r\n\t        isLaunched : false,\r\n\t\r\n\t        /**\r\n\t         * Possibility to load news by scrolling.\r\n\t         * Restriction for reduction requests which could be while scrolling\r\n\t         */\r\n\t        canLoad : true,\r\n\t\r\n\t        init : function () {\r\n\t\r\n\t            if (!this.isAllowed) return;\r\n\t\r\n\t            window.addEventListener('scroll', codex.appender.autoLoading.scrollEvent);\r\n\t\r\n\t            codex.appender.autoLoading.isLaunched = true;\r\n\t\r\n\t        },\r\n\t\r\n\t        disable : function () {\r\n\t\r\n\t            window.removeEventListener('scroll', codex.appender.autoLoading.scrollEvent);\r\n\t\r\n\t            codex.appender.autoLoading.isLaunched = false;\r\n\t\r\n\t        },\r\n\t\r\n\t        scrollEvent : function () {\r\n\t\r\n\t            var scrollReachedEnd = window.pageYOffset + window.innerHeight >= document.body.clientHeight;\r\n\t\r\n\t            if (scrollReachedEnd && codex.appender.autoLoading.canLoad) {\r\n\t\r\n\t                codex.appender.autoLoading.canLoad = false;\r\n\t\r\n\t                codex.appender.load();\r\n\t\r\n\t            }\r\n\t\r\n\t        },\r\n\t\r\n\t    }\r\n\t\r\n\t};\r\n\t\r\n\tmodule.exports = appender;\r\n\n\n/***/ },\n/* 8 */\n/***/ function(module, exports) {\n\n\t/**\r\n\t * Parser module\r\n\t * @author Taly Guryn\r\n\t */\r\n\tvar parser = {\r\n\t\r\n\t    input : null,\r\n\t\r\n\t    init : function () {\r\n\t\r\n\t        // this.input = document.getElementById(settings.input_id);\r\n\t\r\n\t        var _this = this;\r\n\t\r\n\t        this.input.addEventListener('paste', function () {\r\n\t\r\n\t            _this.inputPasteCallback();\r\n\t\r\n\t        }, false);\r\n\t\r\n\t    },\r\n\t\r\n\t    inputPasteCallback : function () {\r\n\t\r\n\t        var e = this.input;\r\n\t\r\n\t        var _this = this;\r\n\t\r\n\t        window.setTimeout(function () {\r\n\t\r\n\t            _this.sendRequest(e.value);\r\n\t\r\n\t        }, 100);\r\n\t\r\n\t    },\r\n\t\r\n\t\r\n\t    sendRequest : function (url) {\r\n\t\r\n\t        codex.core.ajax({\r\n\t            type: 'get',\r\n\t            url: '/ajax/get_page',\r\n\t            data: { 'url' : url },\r\n\t            success: function (response) {\r\n\t\r\n\t                var title, content, sourceLink;\r\n\t\r\n\t                if ( response.success == 1) {\r\n\t\r\n\t                    title = document.getElementById('page_form_title');\r\n\t                    content = document.getElementById('page_form_content');\r\n\t                    sourceLink = document.getElementById('source_link');\r\n\t\r\n\t                    title.value = response.title;\r\n\t                    content.value = response.article;\r\n\t                    sourceLink.value = url;\r\n\t\r\n\t                    // while we have no own editor, we should use this getting element\r\n\t                    // cause I can't edit code for external editor\r\n\t                    document.getElementsByClassName('redactor_redactor')[0].innerHTML = response.article;\r\n\t\r\n\t                } else {\r\n\t\r\n\t                    codex.core.showException('   ');\r\n\t\r\n\t                }\r\n\t\r\n\t            }\r\n\t\r\n\t        });\r\n\t\r\n\t    }\r\n\t};\r\n\t\r\n\tmodule.exports = parser;\r\n\n\n/***/ },\n/* 9 */\n/***/ function(module, exports) {\n\n\t/**\r\n\t * Comments module\r\n\t * @author  @guryn @neSpecc\r\n\t * @copyright CodeX Team https://github.com/codex-team\r\n\t * @version 1.1.0\r\n\t */\r\n\tmodule.exports = (function () {\r\n\t\r\n\t    var commentsList = null,\r\n\t        anchor       = document.location.hash;\r\n\t\r\n\t    var CSS_ = {\r\n\t        replyForm :         'comments-form',\r\n\t        replyTextarea :     'comment-form__text',\r\n\t        replyOpened :       'comment-form__placeholder--opened',\r\n\t        replySubmitButton : 'comment-form__button',\r\n\t        highlighted :       'comment--highligthed'\r\n\t    };\r\n\t\r\n\t    /**\r\n\t     * Settings-menu toggler selector\r\n\t     * @type {String}\r\n\t     */\r\n\t    var menuTogglerSelector = '.js-comment-settings';\r\n\t\r\n\t    /**\r\n\t     * Initialize comments\r\n\t     * @param {object} data        params\r\n\t     * @param {sring} data.listId  comments list wrapper id\r\n\t     */\r\n\t    function init(data) {\r\n\t\r\n\t        commentsList = document.getElementById(data.listId);\r\n\t\r\n\t        if (anchor) {\r\n\t\r\n\t            highligthAnchor();\r\n\t\r\n\t        }\r\n\t\r\n\t    }\r\n\t\r\n\t    /**\r\n\t     * Remove holder and append form for comment\r\n\t     * @param {Element} placeholder 'Write reply...' button\r\n\t     */\r\n\t    function reply( replyButton ) {\r\n\t\r\n\t        /** If reply already opened, do noting */\r\n\t        if ( replyButton.classList.contains( CSS_.replyOpened ) ) {\r\n\t\r\n\t            return;\r\n\t\r\n\t        }\r\n\t\r\n\t        /** Get reply params from dataset */\r\n\t        var replyParams = {\r\n\t            parentId : replyButton.dataset.parentId,\r\n\t            rootId   : replyButton.dataset.rootId,\r\n\t            action   : replyButton.dataset.action\r\n\t        };\r\n\t\r\n\t        /** Create reply form */\r\n\t        var form = createForm( replyParams );\r\n\t\r\n\t        /** Insert form after reply button */\r\n\t        codex.core.insertAfter( replyButton, form );\r\n\t\r\n\t        replyButton.classList.add( CSS_.replyOpened );\r\n\t        getFormTextarea(form).focus();\r\n\t\r\n\t    }\r\n\t\r\n\t    /**\r\n\t     * Returns reply form\r\n\t     *\r\n\t     * @param {object} params\r\n\t     * @param {Number} params.parentId     parent comment's id\r\n\t     * @param {Number} params.rootId       root comment's id\r\n\t     * @param {String} params.action       URL for saving\r\n\t     *\r\n\t     * @return {Element} element that holds textarea and submit-button\r\n\t     */\r\n\t    function createForm( params ) {\r\n\t\r\n\t        var textarea     = createTextarea(),\r\n\t            button       = createButton(),\r\n\t            form         = document.createElement('DIV');\r\n\t\r\n\t        form.classList.add(CSS_.replyForm);\r\n\t\r\n\t        /** Store data in Textarea */\r\n\t        textarea.dataset.parentId = params.parentId;\r\n\t        textarea.dataset.rootId   = params.rootId;\r\n\t        textarea.dataset.action   = params.action;\r\n\t\r\n\t        form.appendChild(textarea);\r\n\t        form.appendChild(button);\r\n\t\r\n\t        return form;\r\n\t\r\n\t    }\r\n\t\r\n\t    /** Return textarea for form for comment */\r\n\t    function createTextarea() {\r\n\t\r\n\t        var textarea = document.createElement('TEXTAREA');\r\n\t\r\n\t        textarea.classList.add(CSS_.replyTextarea);\r\n\t        textarea.placeholder = ' ';\r\n\t\r\n\t        textarea.addEventListener('keydown', keydownSubmitHandler, false);\r\n\t        textarea.addEventListener('blur', blurTextareaHandler, false);\r\n\t\r\n\t        codex.autoresizeTextarea.addListener(textarea);\r\n\t\r\n\t        return textarea;\r\n\t\r\n\t    }\r\n\t\r\n\t    /** Return submit button for form*/\r\n\t    function createButton() {\r\n\t\r\n\t        var button = document.createElement('DIV');\r\n\t\r\n\t        button.classList.add( CSS_.replySubmitButton, 'button', 'master');\r\n\t        button.textContent = '';\r\n\t\r\n\t        button.addEventListener('click', submitClicked_, false);\r\n\t\r\n\t        return button;\r\n\t\r\n\t    }\r\n\t\r\n\t    /**\r\n\t     * Reply submit button click handler\r\n\t     */\r\n\t    function submitClicked_() {\r\n\t\r\n\t        var submit = this,\r\n\t            form   = submit.parentNode,\r\n\t            textarea = getFormTextarea(form);\r\n\t\r\n\t        send_( textarea );\r\n\t\r\n\t    }\r\n\t\r\n\t    /* Return textarea for given form */\r\n\t    function getFormTextarea(form) {\r\n\t\r\n\t        return form.getElementsByTagName('TEXTAREA')[0];\r\n\t\r\n\t    }\r\n\t\r\n\t    /**\r\n\t     * Remove form on textarea blur\r\n\t     * @param {Event} blur Event\r\n\t     */\r\n\t    function blurTextareaHandler( event ) {\r\n\t\r\n\t        var textarea  = event.target,\r\n\t            form      = textarea.parentNode,\r\n\t            commentId = textarea.dataset.parentId;\r\n\t\r\n\t        if (!textarea.value.trim()) {\r\n\t\r\n\t            removeForm(form, commentId);\r\n\t\r\n\t        }\r\n\t\r\n\t    }\r\n\t\r\n\t    /**\r\n\t     * Removes reply form\r\n\t     * @param {Element} form\r\n\t     * @param {Number} commentId   reply target comment id\r\n\t     */\r\n\t    function removeForm( form, commentId ) {\r\n\t\r\n\t        var replyButton = document.getElementById('reply' + commentId );\r\n\t\r\n\t        form.remove();\r\n\t        replyButton.classList.remove(CSS_.replyOpened);\r\n\t\r\n\t    }\r\n\t\r\n\t    /**\r\n\t     * Catch Ctrl+Enter or Cmd+Enter for send form\r\n\t     * @param {Event} event    Keydown Event\r\n\t     */\r\n\t    function keydownSubmitHandler(event) {\r\n\t\r\n\t        var ctrlPressed  = event.ctrlKey || event.metaKey,\r\n\t            enterPressed = event.keyCode == 13,\r\n\t            textarea = event.target;\r\n\t\r\n\t        if ( ctrlPressed && enterPressed ) {\r\n\t\r\n\t            send_( textarea );\r\n\t\r\n\t            event.preventDefault();\r\n\t\r\n\t        }\r\n\t\r\n\t    }\r\n\t\r\n\t    /**\r\n\t     * Ajax function for submit comment\r\n\t     * @param {Element} textarea    input with dataset and text\r\n\t     */\r\n\t    function send_( textarea ) {\r\n\t\r\n\t        var formData  = new FormData(),\r\n\t            form      = textarea.parentNode,\r\n\t            submitBtn = form.querySelector('.' + CSS_.replySubmitButton),\r\n\t            rootId    = textarea.dataset.rootId,\r\n\t            parentId  = textarea.dataset.parentId,\r\n\t            actionURL = textarea.dataset.action;\r\n\t\r\n\t        formData.append('root_id', rootId);\r\n\t        formData.append('parent_id', parentId);\r\n\t        formData.append('comment_text', textarea.value);\r\n\t        formData.append('csrf', window.csrf);\r\n\t\r\n\t        codex.ajax.call({\r\n\t            type: 'POST',\r\n\t            url: actionURL,\r\n\t            data: formData,\r\n\t            beforeSend : function () {\r\n\t\r\n\t                submitBtn.classList.add('loading');\r\n\t\r\n\t            },\r\n\t            success : function (response) {\r\n\t\r\n\t                var comment;\r\n\t\r\n\t                submitBtn.classList.remove('loading');\r\n\t\r\n\t                response = JSON.parse(response);\r\n\t\r\n\t                if (!response.success) {\r\n\t\r\n\t                    codex.alerts.show(response.error);\r\n\t                    return;\r\n\t\r\n\t                }\r\n\t\r\n\t                /** Remove form and return placeholder */\r\n\t                removeForm(form, parentId);\r\n\t\r\n\t                /** Remove empty-feed block */\r\n\t                removeEmptyCommentsBlock();\r\n\t\r\n\t                comment = codex.core.parseHTML(response.comment)[0];\r\n\t                commentsList.appendChild(comment);\r\n\t\r\n\t                /** Scroll down to the new comment */\r\n\t                window.scrollTo(0, document.body.scrollHeight);\r\n\t\r\n\t                /** Highligth new comment */\r\n\t                highligthComment(response.commentId);\r\n\t\r\n\t                /** If menu found, activate it */\r\n\t                activateMenu(comment);\r\n\t\r\n\t            }\r\n\t\r\n\t        });\r\n\t\r\n\t    }\r\n\t\r\n\t    /**\r\n\t     * Removes empty-feed motivation\r\n\t     */\r\n\t    function removeEmptyCommentsBlock() {\r\n\t\r\n\t        var emptyCommentsBlock = document.querySelector('.js-empty-comments');\r\n\t\r\n\t        if (!emptyCommentsBlock) {\r\n\t\r\n\t            return;\r\n\t\r\n\t        }\r\n\t\r\n\t        emptyCommentsBlock.remove();\r\n\t\r\n\t    }\r\n\t\r\n\t    /**\r\n\t     * If menu-toggler found in comment\r\n\t     * @return {Element} comment - comment's island\r\n\t     */\r\n\t    function activateMenu( comment ) {\r\n\t\r\n\t        var  menuToggler = comment.querySelector(menuTogglerSelector);\r\n\t\r\n\t        if (!menuToggler) {\r\n\t\r\n\t            return;\r\n\t\r\n\t        }\r\n\t\r\n\t        codex.islandSettings.prepareToggler(menuToggler, menuTogglerSelector);\r\n\t\r\n\t    }\r\n\t\r\n\t    /**\r\n\t     * Highligth comment by id for a time\r\n\t     * @param {Number} commentId   id comment to highlight\r\n\t     */\r\n\t    function highligthComment(commentId) {\r\n\t\r\n\t        var comment = document.getElementById('comment' + commentId);\r\n\t\r\n\t        comment.classList.add(CSS_.highlighted);\r\n\t\r\n\t        window.setTimeout(function () {\r\n\t\r\n\t            comment.classList.remove(CSS_.highlighted);\r\n\t\r\n\t        }, 500);\r\n\t\r\n\t    }\r\n\t\r\n\t    /** Highligth comment if anchor is in url */\r\n\t    function highligthAnchor() {\r\n\t\r\n\t        var numbers = anchor.match(/\\d+/),\r\n\t            commentId;\r\n\t\r\n\t        if (!numbers) return;\r\n\t\r\n\t        commentId = numbers[0];\r\n\t\r\n\t        highligthComment(commentId);\r\n\t\r\n\t    }\r\n\t\r\n\t    /**\r\n\t     * Comment removing action\r\n\t     * @return {Event} click Event\r\n\t     */\r\n\t    function remove() {\r\n\t\r\n\t        var itemClicked = this,\r\n\t            targetId    = itemClicked.dataset.id;\r\n\t\r\n\t        if (!window.confirm('  ')) {\r\n\t\r\n\t            return;\r\n\t\r\n\t        }\r\n\t\r\n\t        document.location = '/delete-comment/' + targetId;\r\n\t\r\n\t    }\r\n\t\r\n\t    return {\r\n\t        init : init,\r\n\t        reply : reply,\r\n\t        remove : remove\r\n\t    };\r\n\t\r\n\t}());\r\n\n\n/***/ },\n/* 10 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/**\r\n\t* Notifications tips module\r\n\t*/\r\n\tmodule.exports = (function () {\r\n\t\r\n\t    __webpack_require__(11);\r\n\t\r\n\t    var CSS_ = {\r\n\t        wrapper : 'exceptionWrapper',\r\n\t        exception : 'clientException'\r\n\t    };\r\n\t\r\n\t    var wrapper_ = null;\r\n\t\r\n\t    function prepare_() {\r\n\t\r\n\t        if ( wrapper_ ) {\r\n\t\r\n\t            return true;\r\n\t\r\n\t        }\r\n\t\r\n\t        wrapper_ = document.createElement('DIV');\r\n\t        wrapper_.classList.add(CSS_.wrapper);\r\n\t\r\n\t        document.body.appendChild(wrapper_);\r\n\t\r\n\t    }\r\n\t\r\n\t    /**\r\n\t    * @param {String} message - may content HTML\r\n\t    */\r\n\t    function show(message) {\r\n\t\r\n\t        prepare_();\r\n\t\r\n\t        var notify = document.createElement('DIV');\r\n\t\r\n\t        notify.classList.add(CSS_.exception);\r\n\t        notify.innerHTML = message;\r\n\t\r\n\t        wrapper_.appendChild(notify);\r\n\t\r\n\t        notify.classList.add('bounceIn');\r\n\t\r\n\t        window.setTimeout(function () {\r\n\t\r\n\t            notify.remove();\r\n\t\r\n\t        }, 8000);\r\n\t\r\n\t    }\r\n\t\r\n\t    return {\r\n\t        show : show\r\n\t    };\r\n\t\r\n\t})({});\r\n\n\n/***/ },\n/* 11 */\n/***/ function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ },\n/* 12 */\n/***/ function(module, exports) {\n\n\t/**\r\n\t* Dropdown menu module\r\n\t* @author: @ndawn\r\n\t*/\r\n\t\r\n\tmodule.exports = (function () {\r\n\t\r\n\t    /**\r\n\t     * Menu block cache\r\n\t     * @type {Element|null}\r\n\t     */\r\n\t    var menuHolder = null;\r\n\t\r\n\t    /**\r\n\t     * Activated menus\r\n\t     * @type {Array}\r\n\t     */\r\n\t    var activated = [];\r\n\t\r\n\t    /**\r\n\t     * CSS class names\r\n\t     * @type {Object}\r\n\t     */\r\n\t    var CSS = {\r\n\t        menu   : 'island-settings__menu',\r\n\t        item   : 'island-settings__item',\r\n\t        showed : 'island-settings__menu--showed'\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t     * Initialization\r\n\t     * @param  {Object} settings  - initial settings\r\n\t     */\r\n\t    var init = function (settings) {\r\n\t\r\n\t        var menuTogglers = document.querySelectorAll(settings.selector);\r\n\t\r\n\t        /**\r\n\t         * Save initial object\r\n\t         */\r\n\t        activated.push(settings);\r\n\t\r\n\t        for (var i = menuTogglers.length - 1; i >= 0; i--) {\r\n\t\r\n\t            prepareToggler(menuTogglers[i], settings.selector);\r\n\t\r\n\t        }\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t     * @public\r\n\t     * Add event listener to the toggler\r\n\t     * @param  {Element} toggler\r\n\t     * @param  {String}  selector  - selector to find settings object\r\n\t     */\r\n\t    var prepareToggler = function (toggler, selector) {\r\n\t\r\n\t        /** Save initial selector to specify menu type */\r\n\t        toggler.dataset.selector = selector;\r\n\t        toggler.addEventListener('mouseover', menuTogglerHovered, false);\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t     * @private\r\n\t     *\r\n\t     * Island circled-icon mouseover handler\r\n\t     *\r\n\t     * @param {Event} event     mouseover-event\r\n\t     */\r\n\t    var menuTogglerHovered = function () {\r\n\t\r\n\t        var menuToggler = this,\r\n\t            menuParams;\r\n\t\r\n\t        if (!menuHolder) {\r\n\t\r\n\t            menuHolder = createMenu();\r\n\t\r\n\t        }\r\n\t\r\n\t        /** Prevent mouseover handling multiple times */\r\n\t        if ( menuHolder.dataset.opened == 'true' ) {\r\n\t\r\n\t            return;\r\n\t\r\n\t        }\r\n\t\r\n\t        menuHolder.dataset.opened = true;\r\n\t\r\n\t        /** if user fast moving cursor to the next toggler, let him */\r\n\t        window.setTimeout(function () {\r\n\t\r\n\t            menuHolder.dataset.opened = false;\r\n\t\r\n\t        }, 300);\r\n\t\r\n\t        /**\r\n\t         * Get current menu params\r\n\t         * @type {Object}\r\n\t         */\r\n\t        menuParams = getMenuParams(menuToggler.dataset.selector);\r\n\t\r\n\t        console.assert(menuParams.items, 'Menu items missed');\r\n\t\r\n\t        fill(menuParams.items, menuToggler);\r\n\t        move(menuToggler);\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t     * Return menu parametres by initial selector\r\n\t     * @param {string}  initialSelector  - selector passed in init() method\r\n\t     * @return {Object}\r\n\t     */\r\n\t    var getMenuParams = function (initialSelector) {\r\n\t\r\n\t        return activated.filter(compareSelector, initialSelector).pop();\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t     * Find settings object by selector\r\n\t     *\r\n\t     * @param  {Object}  obj    passed object with 'selector' key\r\n\t     * @this   {String}         selector to compare with\r\n\t     *\r\n\t     * @return {Boolean}        true if passed selector same as looking for\r\n\t     */\r\n\t    var compareSelector = function (obj) {\r\n\t\r\n\t        return obj.selector == this;\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t     * Fills menu with items\r\n\t     * @param  {Array}   items     list of menu items\r\n\t     * @param  {Element} toggler   islan menu icon with data-attributes\r\n\t     */\r\n\t\r\n\t    var fill = function (items, toggler) {\r\n\t\r\n\t        var i,\r\n\t            itemData,\r\n\t            itemElement;\r\n\t\r\n\t        menuHolder.innerHTML = '';\r\n\t\r\n\t        for (i = 0; !!(itemData = items[i]); i++) {\r\n\t\r\n\t            itemElement = createItem(itemData);\r\n\t\r\n\t            /** Pass all parametres stored in icon's dataset to the item's dataset */\r\n\t            for (var attr in toggler.dataset) {\r\n\t\r\n\t                itemElement.dataset[attr] = toggler.dataset[attr];\r\n\t\r\n\t            }\r\n\t\r\n\t            menuHolder.appendChild(itemElement);\r\n\t\r\n\t        }\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t    * @private\r\n\t    * Creates an option block\r\n\t    * @param {Object}   item          - menu item data\r\n\t    * @param {String}   item.title    - title\r\n\t    * @param {Function} item.handler  - click handler\r\n\t    *\r\n\t    * @return {Element} menu item with click handler\r\n\t    */\r\n\t    var createItem = function ( item ) {\r\n\t\r\n\t        var itemEl = document.createElement('LI');\r\n\t\r\n\t        itemEl.classList.add(CSS.item);\r\n\t\r\n\t        console.assert(item.title, 'islandSettings: item title is missed');\r\n\t        console.assert(typeof item.handler == 'function', 'islandSettings: item handler is not a function');\r\n\t\r\n\t        itemEl.textContent = item.title;\r\n\t        itemEl.addEventListener('click', item.handler);\r\n\t\r\n\t        return itemEl;\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t    * @private\r\n\t    * Creates the dropdown menu\r\n\t    */\r\n\t    var createMenu = function () {\r\n\t\r\n\t        var block = document.createElement('UL');\r\n\t\r\n\t        block.classList.add(CSS.menu);\r\n\t\r\n\t        return block;\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t    * Appends a menu to the container\r\n\t    * @param {Element} container - where to append menu\r\n\t    */\r\n\t    var move = function (container) {\r\n\t\r\n\t        container.appendChild(menuHolder);\r\n\t        menuHolder.classList.add(CSS.showed);\r\n\t\r\n\t    };\r\n\t\r\n\t    return {\r\n\t        init: init,\r\n\t        prepareToggler: prepareToggler\r\n\t    };\r\n\t\r\n\t})();\r\n\n\n/***/ },\n/* 13 */\n/***/ function(module, exports) {\n\n\t/**\r\n\t* Module for comments textarea autoresize\r\n\t*/\r\n\tmodule.exports = (function () {\r\n\t\r\n\t    /**\r\n\t    * Textareas initialization\r\n\t    */\r\n\t    var init = function () {\r\n\t\r\n\t        var textareas = document.getElementsByClassName('js-autoresizable');\r\n\t\r\n\t        if (textareas.length) {\r\n\t\r\n\t            for (var i = 0; i < textareas.length; i++) {\r\n\t\r\n\t                addListener(textareas[i]);\r\n\t\r\n\t            }\r\n\t\r\n\t        }\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t    * Add input event listener to textarea\r\n\t    *\r\n\t    * @param {Element} textarea  node which need to be able to autoresize\r\n\t    */\r\n\t    var addListener = function (textarea) {\r\n\t\r\n\t        textarea.addEventListener('input', textareaChanged, false);\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t    * Hanging events on textareas\r\n\t    */\r\n\t    var textareaChanged = function (event) {\r\n\t\r\n\t        var textarea = event.target;\r\n\t\r\n\t        checkScrollHeight(textarea);\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t    * Increasing textarea height\r\n\t    */\r\n\t    var checkScrollHeight = function (textarea) {\r\n\t\r\n\t        if (textarea.scrollHeight > textarea.clientHeight) {\r\n\t\r\n\t            textarea.style.height = textarea.scrollHeight + 'px';\r\n\t\r\n\t        }\r\n\t\r\n\t    };\r\n\t\r\n\t    return {\r\n\t        init: init,\r\n\t        addListener : addListener\r\n\t    };\r\n\t\r\n\t}());\r\n\n\n/***/ },\n/* 14 */\n/***/ function(module, exports) {\n\n\t/**\r\n\t * User methods module\r\n\t */\r\n\tmodule.exports = function () {\r\n\t\r\n\t    /**\r\n\t     * Manupulations with user photo\r\n\t     * @return {Object} - Module\r\n\t     */\r\n\t    var photo = function () {\r\n\t\r\n\t        /**\r\n\t         * Mark elements with this name=\"\" to dynamically update their sources\r\n\t         * @type {String}\r\n\t         */\r\n\t        var updatableElementsName = 'js-img-updatable';\r\n\t\r\n\t        /**\r\n\t         * Changes user's photo\r\n\t         * @param  {Event}  event   click event\r\n\t         */\r\n\t        var change = function ( event, transportType ) {\r\n\t\r\n\t            codex.transport.init({\r\n\t                url : '/upload/' + transportType,\r\n\t                success : uploaded,\r\n\t                error   : error\r\n\t            });\r\n\t\r\n\t        };\r\n\t\r\n\t        /**\r\n\t         * Uploading error\r\n\t         * @param  {Object} error\r\n\t         */\r\n\t        var error = function (uploadError) {\r\n\t\r\n\t            console.log(uploadError);\r\n\t\r\n\t        };\r\n\t\r\n\t        /**\r\n\t         * Photo uploading callback\r\n\t         * @param  {String} response    server answer\r\n\t         */\r\n\t        var uploaded = function (response) {\r\n\t\r\n\t            response = JSON.parse(response);\r\n\t\r\n\t            if ( !response.success ) {\r\n\t\r\n\t                codex.alerts.show(response.message || 'File uploading error :(');\r\n\t                return;\r\n\t\r\n\t            }\r\n\t\r\n\t            console.assert( response.data && response.data.url, 'Wrong response data');\r\n\t\r\n\t            updateAll( response.data.url );\r\n\t\r\n\t        };\r\n\t\r\n\t        /**\r\n\t         * Updates all user photo sources\r\n\t         * @uses   updatableElementsName  to find img tags\r\n\t         * @param  {String} newSource\r\n\t         */\r\n\t        var updateAll = function ( newSource) {\r\n\t\r\n\t            var updatebleImages = document.getElementsByName(updatableElementsName);\r\n\t\r\n\t            for (var i = updatebleImages.length - 1; i >= 0; i--) {\r\n\t\r\n\t                updatebleImages[i].src = newSource;\r\n\t\r\n\t            }\r\n\t\r\n\t        };\r\n\t\r\n\t        return {\r\n\t            change : change\r\n\t        };\r\n\t\r\n\t    }();\r\n\t\r\n\t    /**\r\n\t     * Changes user status\r\n\t     * @param  {} argument [description]\r\n\t     * @return {[type]}          [description]\r\n\t     */\r\n\t    var changeStatus = function () {\r\n\t\r\n\t        console.log('user status changing');\r\n\t\r\n\t    };\r\n\t\r\n\t    var changePassword = function () {\r\n\t\r\n\t        var wrapper = null,\r\n\t            input   = null,\r\n\t            message = null,\r\n\t            button  = null,\r\n\t            csrf    = null;\r\n\t\r\n\t        var showForm = function (_csrf) {\r\n\t\r\n\t            var label       = document.createElement('LABEL');\r\n\t\r\n\t            wrapper = this;\r\n\t            input   = document.createElement('INPUT');\r\n\t            button  = document.createElement('SPAN');\r\n\t            message = document.createElement('DIV');\r\n\t\r\n\t            csrf = _csrf;\r\n\t\r\n\t            label.classList.add('form__label');\r\n\t            label.textContent = ' ';\r\n\t\r\n\t            input.classList.add('form__input');\r\n\t            input.type = 'password';\r\n\t\r\n\t            button.classList.add('button');\r\n\t            button.classList.add('form__hint');\r\n\t            button.classList.add('master');\r\n\t            button.textContent = '';\r\n\t\r\n\t            button.addEventListener('click', requestChange);\r\n\t\r\n\t            wrapper.classList.remove('island--centered');\r\n\t            wrapper.classList.remove('profile-settings__change-password-btn');\r\n\t            wrapper.innerHTML   = '';\r\n\t            wrapper.onclick     = '';\r\n\t\r\n\t            wrapper.appendChild(label);\r\n\t            wrapper.appendChild(input);\r\n\t            wrapper.appendChild(button);\r\n\t            wrapper.appendChild(message);\r\n\t\r\n\t        };\r\n\t\r\n\t        var requestChange = function () {\r\n\t\r\n\t            button.classList.add('loading');\r\n\t\r\n\t            codex.ajax.call({\r\n\t                url: '/user/passchange',\r\n\t                type: 'POST',\r\n\t                data: JSON.stringify({\r\n\t                    csrf: csrf,\r\n\t                    currentPassword: input.value\r\n\t                }),\r\n\t                success: ajaxResponse,\r\n\t                error: ajaxResponse\r\n\t            });\r\n\t\r\n\t        };\r\n\t\r\n\t        var ajaxResponse = function (response) {\r\n\t\r\n\t            button.classList.remove('loading');\r\n\t\r\n\t            try {\r\n\t\r\n\t                response = JSON.parse(response);\r\n\t\r\n\t            } catch (e) {\r\n\t\r\n\t                response = {success: 0, message: ' '};\r\n\t\r\n\t            }\r\n\t\r\n\t            if (!response.success) {\r\n\t\r\n\t                input.classList.add('form__input--invalid');\r\n\t\r\n\t            } else {\r\n\t\r\n\t                showSuccessMessage(response.message);\r\n\t                return;\r\n\t\r\n\t            }\r\n\t\r\n\t            message.textContent = response.message;\r\n\t\r\n\t        };\r\n\t\r\n\t        var showSuccessMessage = function (text) {\r\n\t\r\n\t            if (wrapper.dataset.success) {\r\n\t\r\n\t                return;\r\n\t\r\n\t            }\r\n\t\r\n\t            var textDiv     = document.createElement('DIV');\r\n\t\r\n\t            button = document.createElement('BUTTON');\r\n\t\r\n\t            textDiv.textContent = text;\r\n\t            textDiv.classList.add('profile-settings__change-password-result-text');\r\n\t\r\n\t            button.classList.add('button', 'master');\r\n\t            button.addEventListener('click', requestChange);\r\n\t            button.textContent = '  ';\r\n\t\r\n\t            wrapper.innerHTML = '';\r\n\t            wrapper.classList.add('island--centered');\r\n\t\r\n\t            wrapper.appendChild(textDiv);\r\n\t            wrapper.appendChild(button);\r\n\t            wrapper.dataset.success = 1;\r\n\t\r\n\t        };\r\n\t\r\n\t        return {\r\n\t            showForm: showForm\r\n\t        };\r\n\t\r\n\t    }();\r\n\t\r\n\t    // var init = function () {\r\n\t    //\r\n\t    //     // bindEvents();\r\n\t    //\r\n\t    // };\r\n\t\r\n\t    // var bindEvents = function () {\r\n\t    //\r\n\t    //     var repeatConfirmEmailBtn = document.getElementById('repeat-email-confirmation');\r\n\t    //\r\n\t    //     repeatConfirmEmailBtn.addEventListener('click', sendEmeailConfirmation);\r\n\t    //\r\n\t    // };\r\n\t\r\n\t    // var sendEmeailConfirmation = function (e) {\r\n\t    //\r\n\t    //     var success = function (response) {\r\n\t    //\r\n\t    //         response = JSON.parse(response);\r\n\t    //\r\n\t    //         codex.alerts.show(response.message);\r\n\t    //         e.target.classList.remove('loading');\r\n\t    //\r\n\t    //     };\r\n\t    //\r\n\t    //     e.target.classList.add('loading');\r\n\t    //\r\n\t    //     codex.ajax.call({\r\n\t    //         url: '/ajax/confirmation-email',\r\n\t    //         success: success\r\n\t    //     });\r\n\t    //\r\n\t    // };\r\n\t\r\n\t\r\n\t    /**\r\n\t     * Working with bio\r\n\t     */\r\n\t    var bio = function () {\r\n\t\r\n\t        /**\r\n\t         * Edited textarea cache\r\n\t         * @type {Element|null}\r\n\t         */\r\n\t        var textarea = null;\r\n\t\r\n\t        /**\r\n\t         * Edit bio click handler;\r\n\t         * @param {Element} button  - button clicked\r\n\t         */\r\n\t        var edit = function ( button ) {\r\n\t\r\n\t            var opened = button.querySelector('textarea');\r\n\t\r\n\t            if (opened) {\r\n\t\r\n\t                return;\r\n\t\r\n\t            }\r\n\t\r\n\t            textarea = document.createElement('TEXTAREA');\r\n\t            textarea.innerHTML = button.textContent.trim();\r\n\t            textarea.addEventListener('keydown', keydown);\r\n\t\r\n\t            button.innerHTML = '';\r\n\t            button.appendChild(textarea);\r\n\t\r\n\t            textarea.focus();\r\n\t\r\n\t            /** Fire autoresize */\r\n\t            codex.autoresizeTextarea.addListener(textarea);\r\n\t\r\n\t        };\r\n\t\r\n\t        /**\r\n\t         * Bio textarea keydowns\r\n\t         * Sends via AJAX by ENTER\r\n\t         */\r\n\t        var keydown = function ( event ) {\r\n\t\r\n\t            if ( event.keyCode == codex.core.keys.ENTER ) {\r\n\t\r\n\t                send(this.value);\r\n\t                event.preventDefault();\r\n\t\r\n\t            }\r\n\t\r\n\t        };\r\n\t\r\n\t        /**\r\n\t         * Sends bio field\r\n\t         * @param  {String} val textarea value\r\n\t         */\r\n\t        var send = function (val) {\r\n\t\r\n\t            if (!val.trim()) {\r\n\t\r\n\t                codex.alerts.show('Write something about yourself');\r\n\t                return;\r\n\t\r\n\t            }\r\n\t\r\n\t            var formData = new FormData();\r\n\t\r\n\t            formData.append('bio', val);\r\n\t            formData.append('csrf', window.csrf);\r\n\t\r\n\t            codex.ajax.call({\r\n\t                type : 'POST',\r\n\t                url : '/user/updateBio',\r\n\t                data : formData,\r\n\t                beforeSend: beforeSend,\r\n\t                success : saved\r\n\t            });\r\n\t\r\n\t        };\r\n\t\r\n\t        /**\r\n\t         * Simple beforeSend method\r\n\t         */\r\n\t        var beforeSend = function () {\r\n\t\r\n\t            textarea.classList.add('loading');\r\n\t\r\n\t        };\r\n\t\r\n\t        /**\r\n\t         * Success saving callback\r\n\t         */\r\n\t        var saved = function (response) {\r\n\t\r\n\t            response = JSON.parse(response);\r\n\t\r\n\t            if (!response.success || !response.bio) {\r\n\t\r\n\t                textarea.classList.remove('loading');\r\n\t                codex.alerts.show('Saving error, sorry');\r\n\t                return;\r\n\t\r\n\t            }\r\n\t\r\n\t            var newBio = document.createTextNode(response.bio || '');\r\n\t\r\n\t            /** Update user's CSRF token */\r\n\t            window.csrf = response.csrf;\r\n\t\r\n\t            codex.core.replace(textarea, newBio);\r\n\t\r\n\t        };\r\n\t\r\n\t        return {\r\n\t            edit: edit\r\n\t        };\r\n\t\r\n\t    }();\r\n\t\r\n\t    return {\r\n\t        changePassword: changePassword,\r\n\t        changeStatus: changeStatus,\r\n\t        photo: photo,\r\n\t        bio : bio,\r\n\t    };\r\n\t\r\n\t}();\r\n\n\n/***/ },\n/* 15 */\n/***/ function(module, exports) {\n\n\tvar sharer = {\r\n\t\r\n\t    init : function () {\r\n\t\r\n\t        var shareButtons = document.querySelectorAll('.js-share');\r\n\t\r\n\t        for (var i = shareButtons.length - 1; i >= 0; i--) {\r\n\t\r\n\t            shareButtons[i].addEventListener('click', sharer.click, true);\r\n\t\r\n\t        }\r\n\t\r\n\t    },\r\n\t\r\n\t    shareVk : function (data) {\r\n\t\r\n\t        var link  = 'https://vk.com/share.php?';\r\n\t\r\n\t        link += 'url='          + data.url;\r\n\t        link += '&title='       + data.title;\r\n\t        link += '&description=' + data.desc;\r\n\t        link += '&image='       + data.img;\r\n\t        link += '&noparse=true';\r\n\t\r\n\t        this.popup( link, 'vkontakte'  );\r\n\t\r\n\t    },\r\n\t\r\n\t    shareFacebook : function (data) {\r\n\t\r\n\t        var FB_APP_ID = 1740455756240878,\r\n\t            link      = 'https://www.facebook.com/dialog/share?display=popup';\r\n\t\r\n\t        link += '&app_id='       + FB_APP_ID;\r\n\t        link += '&href='         + data.url;\r\n\t        link += '&redirect_uri=' + document.location.href;\r\n\t\r\n\t        this.popup( link, 'facebook' );\r\n\t\r\n\t    },\r\n\t\r\n\t    shareTwitter : function (data) {\r\n\t\r\n\t        var link = 'https://twitter.com/share?';\r\n\t\r\n\t        link += 'text='      + data.title;\r\n\t        link += '&url='      + data.url;\r\n\t        link += '&counturl=' + data.url;\r\n\t\r\n\t        this.popup( link, 'twitter' );\r\n\t\r\n\t    },\r\n\t\r\n\t    shareTelegram : function (data) {\r\n\t\r\n\t        var link  = 'https://telegram.me/share/url';\r\n\t\r\n\t        link += '?text=' + data.title;\r\n\t        link += '&url='  + data.url;\r\n\t\r\n\t        this.popup( link, 'telegram' );\r\n\t\r\n\t    },\r\n\t\r\n\t    popup : function ( url, socialType ) {\r\n\t\r\n\t        window.open( url, '', 'toolbar=0,status=0,width=626,height=436' );\r\n\t\r\n\t        /**\r\n\t         * Write analytics goal\r\n\t         */\r\n\t        if ( window.yaCounter32652805 ) {\r\n\t\r\n\t            window.yaCounter32652805.reachGoal('article-share', function () {}, this, {type: socialType, url: url});\r\n\t\r\n\t        }\r\n\t\r\n\t    },\r\n\t\r\n\t    click : function (event) {\r\n\t\r\n\t        var target = event.target;\r\n\t\r\n\t        /**\r\n\t         * Social provider stores in data 'shareType' attribute on share-button\r\n\t         * But click may be fired on child-element in button, so we need to handle it.\r\n\t         */\r\n\t        var type = target.dataset.shareType || target.parentNode.dataset.shareType;\r\n\t\r\n\t        if (!sharer[type]) return;\r\n\t\r\n\t        /**\r\n\t         * Sanitize share params\r\n\t         * @todo test for taint strings\r\n\t         */\r\n\t            // for (key in window.shareData){\r\n\t            //      window.shareData[key] = encodeURIComponent(window.shareData[key]);\r\n\t            // }\r\n\t\r\n\t        var shareData = {\r\n\t\r\n\t            url:    target.dataset.url || target.parentNode.dataset.url,\r\n\t            title:  target.dataset.title || target.parentNode.dataset.title,\r\n\t            desc:   target.dataset.desc || target.parentNode.dataset.desc,\r\n\t            img:    target.dataset.img || target.parentNode.dataset.title\r\n\t\r\n\t        };\r\n\t\r\n\t        /**\r\n\t         * Fire click handler\r\n\t         */\r\n\t\r\n\t        sharer[type](shareData);\r\n\t\r\n\t    }\r\n\t\r\n\t};\r\n\t\r\n\tmodule.exports = sharer;\n\n/***/ },\n/* 16 */\n/***/ function(module, exports) {\n\n\t/**\r\n\t * Module for load and start codex-editor\r\n\t *\r\n\t * Using:\r\n\t *\r\n\t * codex.writing.prepare({\r\n\t *     holderId : 'placeForEditor',                                         // (required)\r\n\t *     hideEditorToolbar : <?= $hideEditorToolbar ? 'true' : 'false' ?>,\r\n\t *     items : <?= json_encode($page->blocks) ?: '[]' ?>,\r\n\t *     pageId   : <?= $page->id ?>,\r\n\t *     parentId : <?= $page->id_parent ?>,\r\n\t * }).then(\r\n\t *    codex.writing.init\r\n\t * );\r\n\t */\r\n\t\r\n\t\r\n\tmodule.exports = (function () {\r\n\t\r\n\t    var editorIsReady = false,\r\n\t        submitButton = null,\r\n\t        settings = {\r\n\t            hideEditorToolbar   : false,\r\n\t            titleId             : 'editorWritingTitle',\r\n\t            initialBlockPlugin  : 'paragraph',\r\n\t            data                : {items: []},\r\n\t            resources           : [],\r\n\t            holderId            : null,\r\n\t            pageId              : 0,\r\n\t            parentId            : 0,\r\n\t        };\r\n\t\r\n\t    /**\r\n\t     * Prepare editor's resourses\r\n\t     *\r\n\t     * @param  {Object} initSettings    base settings for editor\r\n\t     * @return {Promise}            all editor's resources are ready\r\n\t     */\r\n\t    var prepare = function (initSettings) {\r\n\t\r\n\t        mergeSettings(initSettings);\r\n\t\r\n\t        return loadEditorResources(settings.resources)\r\n\t                .then(function () {\r\n\t\r\n\t                    editorIsReady = true;\r\n\t\r\n\t                });\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t     * Fill module's settings by settings from params\r\n\t     *\r\n\t     * @param  {Object} initSettings  list of params from init\r\n\t     */\r\n\t    function mergeSettings(initSettings) {\r\n\t\r\n\t        for (var key in initSettings) {\r\n\t\r\n\t            settings[key] = initSettings[key];\r\n\t\r\n\t        }\r\n\t\r\n\t    }\r\n\t\r\n\t    /**\r\n\t     * Run editor\r\n\t     */\r\n\t    function startEditor() {\r\n\t\r\n\t        /**\r\n\t         * @todo get from server\r\n\t         */\r\n\t        var EDITOR_IMAGE = 1;\r\n\t        var EDITOR_FILE  = 2;\r\n\t\r\n\t        codex.editor.start({\r\n\t\r\n\t            holderId:  settings.holderId,\r\n\t\r\n\t            initialBlockPlugin : settings.initialBlockPlugin,\r\n\t\r\n\t            hideToolbar: settings.hideEditorToolbar,\r\n\t\r\n\t            tools : {\r\n\t                paragraph: {\r\n\t                    type               : 'paragraph',\r\n\t                    iconClassname      : 'ce-icon-paragraph',\r\n\t                    render             : window.paragraph.render,\r\n\t                    validate           : window.paragraph.validate,\r\n\t                    save               : window.paragraph.save,\r\n\t                    allowedToPaste     : true,\r\n\t                    showInlineToolbar  : true,\r\n\t                    destroy            : window.paragraph.destroy,\r\n\t                    allowRenderOnPaste : true\r\n\t                },\r\n\t                header: {\r\n\t                    type             : 'header',\r\n\t                    iconClassname    : 'ce-icon-header',\r\n\t                    appendCallback   : window.header.appendCallback,\r\n\t                    makeSettings     : window.header.makeSettings,\r\n\t                    render           : window.header.render,\r\n\t                    validate         : window.header.validate,\r\n\t                    save             : window.header.save,\r\n\t                    destroy          : window.header.destroy,\r\n\t                    displayInToolbox : true\r\n\t                },\r\n\t                image: {\r\n\t                    type                  : 'image',\r\n\t                    iconClassname         : 'ce-icon-picture',\r\n\t                    appendCallback        : window.image.appendCallback,\r\n\t                    prepare               : window.image.prepare,\r\n\t                    makeSettings          : window.image.makeSettings,\r\n\t                    render                : window.image.render,\r\n\t                    save                  : window.image.save,\r\n\t                    destroy               : window.image.destroy,\r\n\t                    isStretched           : true,\r\n\t                    showInlineToolbar     : true,\r\n\t                    displayInToolbox      : true,\r\n\t                    renderOnPastePatterns : window.image.pastePatterns,\r\n\t                    config: {\r\n\t                        uploadImage : '/upload/' + EDITOR_IMAGE,\r\n\t                        uploadFromUrl : ''\r\n\t                    }\r\n\t                },\r\n\t                attaches: {\r\n\t                    type             : 'attaches',\r\n\t                    displayInToolbox : true,\r\n\t                    iconClassname    : 'cdx-attaches__icon',\r\n\t                    prepare          : window.cdxAttaches.prepare,\r\n\t                    render           : window.cdxAttaches.render,\r\n\t                    save             : window.cdxAttaches.save,\r\n\t                    validate         : window.cdxAttaches.validate,\r\n\t                    destroy          : window.cdxAttaches.destroy,\r\n\t                    appendCallback   : window.cdxAttaches.appendCallback,\r\n\t                    config: {\r\n\t                        fetchUrl: '/upload/' + EDITOR_FILE,\r\n\t                        maxSize: 25000,\r\n\t                    }\r\n\t                }\r\n\t            },\r\n\t\r\n\t            data : settings.data\r\n\t        });\r\n\t\r\n\t        var titleInput = document.getElementById(settings.titleId);\r\n\t\r\n\t        /**\r\n\t         * Focus at the title\r\n\t         */\r\n\t        titleInput.focus();\r\n\t        titleInput.addEventListener('keydown', titleKeydownHandler );\r\n\t\r\n\t    }\r\n\t\r\n\t    /**\r\n\t     * Title input keydowns\r\n\t     * @description  By ENTER, sets focus on editor\r\n\t     * @param  {Event} event  - keydown event\r\n\t     */\r\n\t    var titleKeydownHandler = function (event) {\r\n\t\r\n\t        /* Set focus on Editor by Enter     */\r\n\t        if ( event.keyCode == codex.core.keys.ENTER ) {\r\n\t\r\n\t            event.preventDefault();\r\n\t\r\n\t            focusRedactor();\r\n\t\r\n\t        }\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t     * Temporary scheme to focus Codex Editor first-block\r\n\t     */\r\n\t    var focusRedactor = function () {\r\n\t\r\n\t        var firstBlock       = codex.editor.nodes.redactor.firstChild,\r\n\t            contentHolder    = firstBlock.firstChild,\r\n\t            firstToolWrapper = contentHolder.firstChild,\r\n\t            aloneTextNode;\r\n\t\r\n\t        /**\r\n\t         * Caret will not be placed in empty textNode, so we need textNode with zero-width char\r\n\t         */\r\n\t        aloneTextNode = document.createTextNode('\\u200B');\r\n\t\r\n\t        /**\r\n\t         * We need to append manually created textnode before returning\r\n\t         */\r\n\t        firstToolWrapper.appendChild(aloneTextNode);\r\n\t\r\n\t        codex.editor.caret.set(firstToolWrapper, 0, 0);\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t     * Public function for run editor\r\n\t     */\r\n\t    var init = function () {\r\n\t\r\n\t        if (!editorIsReady) return;\r\n\t\r\n\t        startEditor();\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t     * Show form and hide placeholder\r\n\t     *\r\n\t     * @param  {Element} targetClicked       placeholder with wrapper\r\n\t     * @param  {String}  formId               remove 'hide' from this form by id\r\n\t     * @param  {String}  hidePlaceholderClass add this class to placeholder\r\n\t     */\r\n\t    var open = function (targetClicked, formId, hidePlaceholderClass) {\r\n\t\r\n\t        if (!editorIsReady) return;\r\n\t\r\n\t        var holder = targetClicked;\r\n\t\r\n\t        document.getElementById(formId).classList.remove('hide');\r\n\t        holder.classList.add(hidePlaceholderClass);\r\n\t        holder.onclick = null;\r\n\t\r\n\t        init();\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t     * Load editor resources and append block with them to body\r\n\t     *\r\n\t     * @param  {Array} resources list of resources which should be loaded\r\n\t     * @return {Promise}\r\n\t     */\r\n\t    var loadEditorResources = function (resources) {\r\n\t\r\n\t        return Promise.all(\r\n\t            resources.map(loadResource)\r\n\t        );\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t     * Loads resource\r\n\t     *\r\n\t     * @param  {Object} resource name and paths for js and css\r\n\t     * @return {Promise}\r\n\t     */\r\n\t    function loadResource(resource) {\r\n\t\r\n\t        var name      = resource.name,\r\n\t            scriptUrl = resource.path.script,\r\n\t            styleUrl  = resource.path.style;\r\n\t\r\n\t        return Promise.all([\r\n\t            codex.loader.importScript(scriptUrl, name),\r\n\t            codex.loader.importStyle(styleUrl, name)\r\n\t        ]);\r\n\t\r\n\t    }\r\n\t\r\n\t    /**\r\n\t    * Prepares form to submit\r\n\t    */\r\n\t    var getForm = function () {\r\n\t\r\n\t        var atlasForm = document.forms.atlas;\r\n\t\r\n\t        if (!atlasForm) return;\r\n\t\r\n\t        /** CodeX.Editor */\r\n\t        var JSONinput = document.createElement('TEXTAREA');\r\n\t\r\n\t        JSONinput.name   = 'content';\r\n\t        JSONinput.id     = 'json_result';\r\n\t        JSONinput.hidden = true;\r\n\t        atlasForm.appendChild(JSONinput);\r\n\t\r\n\t        /**\r\n\t         * Save blocks\r\n\t         */\r\n\t        codex.editor.saver.saveBlocks();\r\n\t\r\n\t        return atlasForm;\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t     * Send ajax request with writing form data\r\n\t     * @param button - submit button (needed to add loading animation)\r\n\t     */\r\n\t    var submit = function (button) {\r\n\t\r\n\t        var title = document.forms.atlas.elements['title'],\r\n\t            form;\r\n\t\r\n\t        if (title.value.trim() === '') {\r\n\t\r\n\t            codex.editor.notifications.notification({\r\n\t                type: 'warn',\r\n\t                message: ' '\r\n\t            });\r\n\t\r\n\t            return;\r\n\t\r\n\t        }\r\n\t\r\n\t        form = getForm();\r\n\t\r\n\t        submitButton = button;\r\n\t\r\n\t        submitButton.classList.add('loading');\r\n\t\r\n\t        window.setTimeout(function () {\r\n\t\r\n\t            form.elements['content'].innerHTML = JSON.stringify({items: codex.editor.state.jsonOutput});\r\n\t\r\n\t            codex.ajax.call({\r\n\t                url: '/p/save',\r\n\t                data: new FormData(form),\r\n\t                success: submitResponse,\r\n\t                type: 'POST'\r\n\t            });\r\n\t\r\n\t        }, 500);\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t     * Response handler for page saving\r\n\t     * @param response\r\n\t     */\r\n\t    var submitResponse = function (response) {\r\n\t\r\n\t        submitButton.classList.remove('loading');\r\n\t\r\n\t        response = JSON.parse(response);\r\n\t\r\n\t        if (response.success) {\r\n\t\r\n\t            window.location = response.redirect;\r\n\t            return;\r\n\t\r\n\t        }\r\n\t\r\n\t        codex.editor.notifications.notification({\r\n\t            type: 'warn',\r\n\t            message: response.message\r\n\t        });\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t    * Submits writing form for opening in full-screan page without saving\r\n\t    */\r\n\t    var openEditorFullscreen = function () {\r\n\t\r\n\t\r\n\t        var form = getForm();\r\n\t\r\n\t        window.setTimeout(function () {\r\n\t\r\n\t            form.elements['content'].innerHTML = JSON.stringify({ items: codex.editor.state.jsonOutput });\r\n\t\r\n\t            form.submit();\r\n\t\r\n\t        }, 500);\r\n\t\r\n\t    };\r\n\t\r\n\t    return {\r\n\t        init    : init,\r\n\t        prepare : prepare,\r\n\t        open    : open,\r\n\t        openEditorFullscreen : openEditorFullscreen,\r\n\t        submit               : submit,\r\n\t    };\r\n\t\r\n\t})();\r\n\n\n/***/ },\n/* 17 */\n/***/ function(module, exports) {\n\n\tmodule.exports = {\r\n\t\r\n\t    prefixJS : 'cdx-script-',\r\n\t\r\n\t    prefixCSS : 'cdx-style-',\r\n\t\r\n\t    importScript : function (scriptPath, instanceName) {\r\n\t\r\n\t        return new Promise(function (resolve, reject) {\r\n\t\r\n\t            var script;\r\n\t\r\n\t            /** Script is already loaded */\r\n\t            if ( !instanceName ) {\r\n\t\r\n\t                reject('Instance name is missed');\r\n\t\r\n\t            } else if ( document.getElementById(this.prefixJS + instanceName) ) {\r\n\t\r\n\t                resolve(scriptPath);\r\n\t\r\n\t            }\r\n\t\r\n\t            script = document.createElement('SCRIPT');\r\n\t            script.async = true;\r\n\t            script.defer = true;\r\n\t            script.id    = codex.loader.prefixJS + instanceName;\r\n\t\r\n\t            script.onload = function () {\r\n\t\r\n\t                resolve(scriptPath);\r\n\t\r\n\t            };\r\n\t\r\n\t            script.onerror = function () {\r\n\t\r\n\t                reject(scriptPath);\r\n\t\r\n\t            };\r\n\t\r\n\t            script.src = scriptPath;\r\n\t            document.head.appendChild(script);\r\n\t\r\n\t        });\r\n\t\r\n\t    },\r\n\t\r\n\t    importStyle : function (stylePath, instanceName) {\r\n\t\r\n\t        return new Promise(function (resolve, reject) {\r\n\t\r\n\t            var style;\r\n\t\r\n\t            /** Style is already loaded */\r\n\t            if ( !instanceName ) {\r\n\t\r\n\t                reject('Instance name is missed');\r\n\t\r\n\t            } else if ( document.getElementById(this.prefixCSS + instanceName) ) {\r\n\t\r\n\t                resolve(stylePath);\r\n\t\r\n\t            }\r\n\t\r\n\t            style = document.createElement('LINK');\r\n\t            style.type = 'text/css';\r\n\t            style.href = stylePath;\r\n\t            style.rel  = 'stylesheet';\r\n\t            style.id   = codex.loader.prefixCSS + instanceName;\r\n\t\r\n\t            style.onload = function () {\r\n\t\r\n\t                resolve(stylePath);\r\n\t\r\n\t            };\r\n\t\r\n\t            style.onerror = function () {\r\n\t\r\n\t                reject(stylePath);\r\n\t\r\n\t            };\r\n\t\r\n\t            style.src = stylePath;\r\n\t            document.head.appendChild(style);\r\n\t\r\n\t        });\r\n\t\r\n\t    },\r\n\t\r\n\t};\r\n\n\n/***/ },\n/* 18 */\n/***/ function(module, exports) {\n\n\t/**\r\n\t* Module for scroll-up button\r\n\t* @author @scytem @guryn\r\n\t*/\r\n\t\r\n\t\r\n\tmodule.exports = (function () {\r\n\t\r\n\t\r\n\t    /**\r\n\t     * Scroll-up will be shown after sroll reaches this value\r\n\t     * @type {Number}\r\n\t     */\r\n\t    var offsetToShow = 300;\r\n\t\r\n\t    /**\r\n\t     * Size content width\r\n\t     * @type {Number}\r\n\t     */\r\n\t    var layoutWidth = 0;\r\n\t\r\n\t    /**\r\n\t     * Clickable Element that holds arrow\r\n\t     * @type {Element}\r\n\t     */\r\n\t    var clickableZone = null;\r\n\t\r\n\t    /**\r\n\t     * Window Resize stop watcher Timeout\r\n\t     * @type {timeoutId}\r\n\t     */\r\n\t    var resizeStopWatcher = null;\r\n\t\r\n\t    /**\r\n\t     * @public\r\n\t     *\r\n\t     * Init method\r\n\t     * Fired after document is ready\r\n\t     */\r\n\t    var init = function ( layoutHolderId ) {\r\n\t\r\n\t        var layout = document.getElementById(layoutHolderId);\r\n\t\r\n\t        if (!layout) {\r\n\t\r\n\t            codex.core.log('Layout center-col ID wissed', 'scrollUp', 'warn');\r\n\t            return;\r\n\t\r\n\t        }\r\n\t\r\n\t        layoutWidth = layout.offsetWidth;\r\n\t\r\n\t        clickableZone = makeUI();\r\n\t\r\n\t        /** Bind click event on scroll-up button */\r\n\t        clickableZone.addEventListener('click', scrollPage);\r\n\t\r\n\t        /** Global window scroll handler */\r\n\t        window.addEventListener('scroll', windowScrollHandler);\r\n\t\r\n\t        /** Autoresize */\r\n\t        window.addEventListener('resize', sizeChanged, false);\r\n\t\r\n\t        /** Set size */\r\n\t        resize();\r\n\t\r\n\t        /* Check heigth */\r\n\t        windowScrollHandler();\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t    * Scroll the document to the begin position\r\n\t    * @param {number} yCoords Y-coordinate\r\n\t    */\r\n\t    var scrollPage = function (yCoords) {\r\n\t\r\n\t        window.scrollTo(0, yCoords);\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t    * Hiding Scroll-up button if user on the top of page\r\n\t    */\r\n\t    var windowScrollHandler = function () {\r\n\t\r\n\t        var notTheTop = window.pageYOffset > offsetToShow;\r\n\t\r\n\t        if (notTheTop) {\r\n\t\r\n\t            clickableZone.classList.add('show');\r\n\t\r\n\t        } else {\r\n\t\r\n\t            clickableZone.classList.remove('show');\r\n\t\r\n\t        }\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t    * Resize hover/click area touching user width of screen\r\n\t    */\r\n\t    var resize = function () {\r\n\t\r\n\t        var windowWidth     = document.body.clientWidth,\r\n\t            leftColumtWidth = (windowWidth - layoutWidth) / 2;\r\n\t\r\n\t        clickableZone.style.width = leftColumtWidth + 'px';\r\n\t\r\n\t    };\r\n\t\r\n\t\r\n\t    /**\r\n\t    * Delay for resize\r\n\t    */\r\n\t    var sizeChanged = function () {\r\n\t\r\n\t        if ( resizeStopWatcher ) {\r\n\t\r\n\t            window.clearTimeout(resizeStopWatcher);\r\n\t\r\n\t        }\r\n\t\r\n\t        resizeStopWatcher = window.setTimeout(resize, 150);\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t     * Makes scroll-up arrow and wrapper\r\n\t     */\r\n\t    var makeUI = function () {\r\n\t\r\n\t        var wrapper = document.createElement('DIV'),\r\n\t            arrow   = document.createElement('DIV');\r\n\t\r\n\t        wrapper.classList.add('scroll-up');\r\n\t        arrow.classList.add('scroll-up__arrow');\r\n\t\r\n\t        wrapper.appendChild(arrow);\r\n\t        document.body.appendChild(wrapper);\r\n\t\r\n\t        return wrapper;\r\n\t\r\n\t    };\r\n\t\r\n\t    return {\r\n\t        init: init\r\n\t    };\r\n\t\r\n\t}());\r\n\n\n/***/ },\n/* 19 */\n/***/ function(module, exports) {\n\n\t/**\r\n\t * Admin module\r\n\t */\r\n\t\r\n\tmodule.exports = (function () {\r\n\t\r\n\t    var emptyBrandingClass = 'branding--empty';\r\n\t    var loadingClass       = 'branding--loading';\r\n\t    var preloaderClass     = 'branding__preloader';\r\n\t    var preloadShown       = 'branding__preloader--shown';\r\n\t\r\n\t    /**\r\n\t     * Branding holder\r\n\t     * @type {Element|null}\r\n\t     */\r\n\t    var wrapper = null;\r\n\t\r\n\t    /**\r\n\t     * Initialization\r\n\t     * @fires preload\r\n\t     */\r\n\t    var init = function () {\r\n\t\r\n\t        wrapper = document.getElementById('brandingSection');\r\n\t\r\n\t        if ( !wrapper ) {\r\n\t\r\n\t            return;\r\n\t\r\n\t        }\r\n\t\r\n\t        var url = wrapper.dataset.src;\r\n\t\r\n\t        preload( url );\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t     * Shows blurred preview and change it to the full-view image\r\n\t     * @param  {String} fullUrl          - URL of original image\r\n\t     * @return {String|null} previewUrl  - pass to renew preloader\r\n\t     */\r\n\t    var preload = function ( fullUrl, previewUrl ) {\r\n\t\r\n\t        var preloader = wrapper.querySelector('.' + preloaderClass),\r\n\t            img = document.createElement('IMG');\r\n\t\r\n\t        if ( previewUrl ) {\r\n\t\r\n\t            preloader.style.backgroundImage = \"url('\" + previewUrl + \"')\";\r\n\t            preloader.classList.add(preloadShown);\r\n\t\r\n\t        }\r\n\t\r\n\t        img.src = fullUrl;\r\n\t        img.onload = function () {\r\n\t\r\n\t            wrapper.style.backgroundImage = \"url('\" + fullUrl + \"')\";\r\n\t            preloader.classList.remove(preloadShown);\r\n\t\r\n\t        };\r\n\t\r\n\t    };\r\n\t\r\n\t\r\n\t\r\n\t    /**\r\n\t     * changes site branding\r\n\t     * @private\r\n\t     */\r\n\t    var change = function () {\r\n\t\r\n\t        codex.transport.init({\r\n\t\r\n\t            url : '/upload/4',\r\n\t            accept : 'image/*',\r\n\t            beforeSend: function () {\r\n\t\r\n\t                wrapper.classList.add(loadingClass);\r\n\t\r\n\t            },\r\n\t            success : function (result) {\r\n\t\r\n\t                var response = JSON.parse(result),\r\n\t                    url,\r\n\t                    preview;\r\n\t\r\n\t                wrapper.classList.remove(loadingClass);\r\n\t\r\n\t                if ( response.success ) {\r\n\t\r\n\t                    url = response.data.url;\r\n\t                    preview = '/upload/branding/preload_' + response.data.name + '.jpg';\r\n\t\r\n\t                    if ( wrapper.classList.contains(emptyBrandingClass) ) {\r\n\t\r\n\t                        wrapper.classList.remove(emptyBrandingClass);\r\n\t\r\n\t                    }\r\n\t\r\n\t                    preload( url, preview );\r\n\t\r\n\t                } else {\r\n\t\r\n\t                    codex.alerts.show('Uploading failed');\r\n\t\r\n\t                }\r\n\t\r\n\t            },\r\n\t            error: function () {\r\n\t\r\n\t                wrapper.classList.remove(loadingClass);\r\n\t\r\n\t                codex.alerts.show('Error while uploading branding image;');\r\n\t\r\n\t            }\r\n\t\r\n\t        });\r\n\t\r\n\t    };\r\n\t\r\n\t    return {\r\n\t        init: init,\r\n\t        change : change\r\n\t    };\r\n\t\r\n\t})({});\r\n\n\n/***/ },\n/* 20 */\n/***/ function(module, exports) {\n\n\t/**\r\n\t * Page significant methods\r\n\t */\r\n\tmodule.exports = (function () {\r\n\t\r\n\t    /**\r\n\t     * Saves current clicked item in page drop-down menu\r\n\t     * @type {Element}\r\n\t     */\r\n\t    var currentItemClicked = null;\r\n\t\r\n\t    /**\r\n\t     * Opens page-writing form\r\n\t     */\r\n\t    var openWriting = function () {\r\n\t\r\n\t        currentItemClicked = this;\r\n\t\r\n\t        var targetId = currentItemClicked.dataset.id;\r\n\t\r\n\t        document.location = '/p/writing?id=' + targetId;\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t     * Opens page-writing form\r\n\t     */\r\n\t    var remove = function () {\r\n\t\r\n\t        currentItemClicked = this;\r\n\t\r\n\t        var targetId    = currentItemClicked.dataset.id;\r\n\t\r\n\t        if (!window.confirm('  ')) {\r\n\t\r\n\t            return;\r\n\t\r\n\t        }\r\n\t\r\n\t        codex.ajax.call({\r\n\t            url : '/p/' + targetId + '/delete',\r\n\t            success: ajaxResponses.delete\r\n\t        });\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t     * Opens writing form for child page\r\n\t     */\r\n\t    var newChild = function () {\r\n\t\r\n\t        currentItemClicked = this;\r\n\t\r\n\t        var targetId = currentItemClicked.dataset.id;\r\n\t\r\n\t        document.location = '/p/writing?parent=' + targetId;\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t     * Send ajax request to add page to menu\r\n\t     */\r\n\t    var addToMenu = function () {\r\n\t\r\n\t        currentItemClicked = this;\r\n\t        currentItemClicked.classList.add('loading');\r\n\t\r\n\t        var targetId =currentItemClicked.dataset.id;\r\n\t\r\n\t        codex.ajax.call({\r\n\t            url : '/p/' + targetId + '/promote?list=menu',\r\n\t            success: ajaxResponses.promote\r\n\t        });\r\n\t\r\n\t    };\r\n\t\r\n\t    /**\r\n\t     * Send ajax request to add page to news\r\n\t     */\r\n\t    var addToNews = function () {\r\n\t\r\n\t        currentItemClicked = this;\r\n\t        currentItemClicked.classList.add('loading');\r\n\t\r\n\t        var targetId =currentItemClicked.dataset.id;\r\n\t\r\n\t        codex.ajax.call({\r\n\t            url : '/p/' + targetId + '/promote?list=news',\r\n\t            success: ajaxResponses.promote\r\n\t        });\r\n\t\r\n\t    };\r\n\t\r\n\t    var ajaxResponses = {\r\n\t\r\n\t        /**\r\n\t         * Parse JSON response\r\n\t         * @param {JSON} response\r\n\t         * @returns {Object} response\r\n\t         */\r\n\t        getResponse: function (response) {\r\n\t\r\n\t            try {\r\n\t\r\n\t                response = JSON.parse(response);\r\n\t\r\n\t            } catch(e) {\r\n\t\r\n\t                return {\r\n\t                    success: 0,\r\n\t                    message: ' ,  '\r\n\t                };\r\n\t\r\n\t            }\r\n\t\r\n\t            return response;\r\n\t\r\n\t        },\r\n\t\r\n\t        /**\r\n\t         * Response handler for page remove\r\n\t         * @param response\r\n\t         */\r\n\t        delete: function (response) {\r\n\t\r\n\t            response = ajaxResponses.getResponse(response);\r\n\t\r\n\t            if (response.success) {\r\n\t\r\n\t                window.location.replace(response.redirect);\r\n\t                return;\r\n\t\r\n\t            }\r\n\t\r\n\t            codex.alerts.show(response.message);\r\n\t\r\n\t        },\r\n\t\r\n\t        /**\r\n\t         * Response handler for page promotion\r\n\t         * @param response\r\n\t         */\r\n\t        promote: function (response) {\r\n\t\r\n\t            response = ajaxResponses.getResponse(response);\r\n\t\r\n\t            currentItemClicked.classList.remove('loading');\r\n\t\r\n\t            if (response.success) {\r\n\t\r\n\t                if (response.menu) {\r\n\t\r\n\t                    ajaxResponses.replaceMenu(response.menu);\r\n\t\r\n\t                }\r\n\t\r\n\t                /**\r\n\t                 * TODO:    \r\n\t                 **/\r\n\t\r\n\t                codex.alerts.show(response.message);\r\n\t\r\n\t                return;\r\n\t\r\n\t            }\r\n\t\r\n\t            codex.alerts.show(response.message);\r\n\t\r\n\t        },\r\n\t\r\n\t        /**\r\n\t         * Replace site menu with code from server response\r\n\t         * @param menu\r\n\t         */\r\n\t        replaceMenu: function (menu) {\r\n\t\r\n\t            var oldMenu = document.getElementById('menu'),\r\n\t                newMenu = codex.core.parseHTML(menu)[0];\r\n\t\r\n\t            codex.core.replace(oldMenu, newMenu);\r\n\t\r\n\t        }\r\n\t\r\n\t    };\r\n\t\r\n\t\r\n\t\r\n\t    return {\r\n\t        openWriting: openWriting,\r\n\t        newChild: newChild,\r\n\t        addToMenu: addToMenu,\r\n\t        addToNews: addToNews,\r\n\t        remove : remove\r\n\t    };\r\n\t\r\n\t}());\n\n/***/ }\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// public/build/bundle.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 863a2f6abc8d3d8408a9","/**\r\n* Require CSS build\r\n*/\r\nrequire('../css/main.css');\r\n\r\n/**\r\n* Codex client\r\n* @author Savchenko Peter <specc.dev@gmail.com>\r\n*/\r\ncodex = (function (codex) {\r\n\r\n    'use strict';\r\n\r\n    /**\r\n    * Static nodes cache\r\n    */\r\n    codex.nodes = {\r\n        content : null\r\n    };\r\n\r\n    codex.init = function () {\r\n\r\n        /**\r\n        * Stylize custom checkboxes\r\n        */\r\n        codex.content.customCheckboxes.init();\r\n\r\n        /**\r\n        * Init approval buttons\r\n        */\r\n        codex.content.approvalButtons.init();\r\n\r\n        codex.autoresizeTextarea.init();\r\n\r\n        /**\r\n        * Init CodeX Special module for contrast version\r\n        * @see https://github.com/codex-team/codex.special\r\n        */\r\n        window.codexSpecial.init({\r\n            blockId : 'js-contrast-version-holder',\r\n        });\r\n\r\n        /**\r\n         * Activate scroll-up button\r\n         */\r\n        codex.scrollUp.init('js-layout-holder');\r\n\r\n        /**\r\n         * Client is ready\r\n         */\r\n        codex.core.log('Initialized', 'CodeX', 'info');\r\n\r\n        /**\r\n         * Initiate branding preload\r\n         */\r\n        codex.branding.init();\r\n\r\n    };\r\n\r\n    return codex;\r\n\r\n})({});\r\n\r\n/**\r\n* Document ready handler\r\n*/\r\ncodex.docReady = function (f) {\r\n\r\n    /in/.test(document.readyState) ? window.setTimeout(codex.docReady, 9, f) : f();\r\n\r\n};\r\n\r\n\r\n/**\r\n* Load modules\r\n*/\r\ncodex.core               = require('./modules/core');\r\ncodex.ajax               = require('./modules/ajax');\r\ncodex.transport          = require('./modules/transport');\r\ncodex.content            = require('./modules/content');\r\ncodex.appender           = require('./modules/appender');\r\ncodex.parser             = require('./modules/parser');\r\ncodex.comments           = require('./modules/comments');\r\ncodex.alerts             = require('./modules/alerts');\r\ncodex.islandSettings     = require('./modules/islandSettings');\r\ncodex.autoresizeTextarea = require('./modules/autoresizeTextarea');\r\ncodex.user               = require('./modules/user');\r\ncodex.sharer             = require('./modules/sharer');\r\ncodex.writing            = require('./modules/writing');\r\ncodex.loader             = require('./modules/loader');\r\ncodex.scrollUp           = require('./modules/scrollUp');\r\ncodex.branding           = require('./modules/branding');\r\ncodex.pages              = require('./modules/pages');\r\n\r\n\r\nmodule.exports = codex;\r\n\r\ncodex.docReady(function () {\r\n\r\n    codex.init();\r\n\r\n});\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./public/app/js/main.js\n// module id = 0\n// module chunks = 0","/**\r\n* Significant core methods\r\n*/\r\n\r\nmodule.exports = {\r\n\r\n    /** Logging method */\r\n    log : function (str, prefix, type, arg) {\r\n\r\n        var staticLength = 32;\r\n\r\n        if (prefix) {\r\n\r\n            prefix = prefix.length < staticLength ? prefix : prefix.substr( 0, staticLength - 2 );\r\n\r\n            while (prefix.length < staticLength - 1) {\r\n\r\n                prefix += ' ';\r\n\r\n            }\r\n\r\n            prefix += ':';\r\n            str = prefix + str;\r\n\r\n        }\r\n\r\n        type = type || 'log';\r\n\r\n        try {\r\n\r\n            if ('console' in window && window.console[ type ]) {\r\n\r\n                if (arg) console[type](str, arg);\r\n                else console[type](str);\r\n\r\n            }\r\n\r\n        } catch(e) {}\r\n\r\n    },\r\n\r\n    /**\r\n    * @return {object} dom element real offset\r\n    */\r\n    getOffset : function (elem) {\r\n\r\n        var docElem, win, rect, doc;\r\n\r\n        if (!elem) {\r\n\r\n            return;\r\n\r\n        }\r\n\r\n        /**\r\n        * Support: IE <=11 only\r\n        * Running getBoundingClientRect on a\r\n        * disconnected node in IE throws an error\r\n        */\r\n        if (!elem.getClientRects().length) {\r\n\r\n            return {\r\n                top: 0,\r\n                left: 0\r\n            };\r\n\r\n        }\r\n\r\n        rect = elem.getBoundingClientRect();\r\n\r\n        /** Make sure element is not hidden (display: none) */\r\n        if (rect.width || rect.height) {\r\n\r\n            doc = elem.ownerDocument;\r\n            win = window;\r\n            docElem = doc.documentElement;\r\n\r\n            return {\r\n                top: rect.top + win.pageYOffset - docElem.clientTop,\r\n                left: rect.left + win.pageXOffset - docElem.clientLeft\r\n            };\r\n\r\n        }\r\n\r\n        /** Return zeros for disconnected and hidden elements (gh-2310) */\r\n        return rect;\r\n\r\n    },\r\n\r\n    /**\r\n    * Checks if element visible on screen at the moment\r\n    * @param {Element} - HTML NodeElement\r\n    */\r\n    isElementOnScreen : function (el) {\r\n\r\n        var elPositon    = codex.core.getOffset(el).top,\r\n            screenBottom = window.scrollY + window.innerHeight;\r\n\r\n        return screenBottom > elPositon;\r\n\r\n    },\r\n\r\n    /**\r\n    * Returns computed css styles for element\r\n    * @param {Element} el\r\n    */\r\n    css : function (el) {\r\n\r\n        return window.getComputedStyle(el);\r\n\r\n    },\r\n\r\n    /**\r\n    * Helper for inserting one element after another\r\n    */\r\n    insertAfter : function (target, element) {\r\n\r\n        target.parentNode.insertBefore(element, target.nextSibling);\r\n\r\n    },\r\n\r\n    /**\r\n    * Replaces node with\r\n    * @param {Element} nodeToReplace\r\n    * @param {Element} replaceWith\r\n    */\r\n    replace : function (nodeToReplace, replaceWith) {\r\n\r\n        return nodeToReplace.parentNode.replaceChild(replaceWith, nodeToReplace);\r\n\r\n    },\r\n\r\n    /**\r\n    * Helper for insert one element before another\r\n    */\r\n    insertBefore : function (target, element) {\r\n\r\n        target.parentNode.insertBefore(element, target);\r\n\r\n    },\r\n\r\n    /**\r\n    * Returns random {int} between numbers\r\n    */\r\n    random : function (min, max) {\r\n\r\n        return Math.floor(Math.random() * (max - min + 1)) + min;\r\n\r\n    },\r\n\r\n    /**\r\n    * Attach event to Element in parent\r\n    * @param {Element} parentNode    - Element that holds event\r\n    * @param {string} targetSelector - selector to filter target\r\n    * @param {string} eventName      - name of event\r\n    * @param {function} callback     - callback function\r\n    */\r\n    delegateEvent : function (parentNode, targetSelector, eventName, callback) {\r\n\r\n        parentNode.addEventListener(eventName, function (event) {\r\n\r\n            var el = event.target, matched;\r\n\r\n            while (el && !matched) {\r\n\r\n                matched = el.matches(targetSelector);\r\n\r\n                if (!matched) el = el.parentElement;\r\n\r\n            }\r\n\r\n            if (matched) {\r\n\r\n                callback.call(event.target, event, el);\r\n\r\n            }\r\n\r\n        }, true);\r\n\r\n    },\r\n\r\n\r\n    /**\r\n    * Readable DOM-node types map\r\n    */\r\n    nodeTypes : {\r\n        TAG     : 1,\r\n        TEXT    : 3,\r\n        COMMENT : 8,\r\n        DOCUMENT_FRAGMENT : 11\r\n    },\r\n\r\n    /**\r\n    * Readable keys map\r\n    */\r\n    keys : { BACKSPACE: 8, TAB: 9, ENTER: 13, SHIFT: 16, CTRL: 17, ALT: 18, ESC: 27, SPACE: 32, LEFT: 37, UP: 38, DOWN: 40, RIGHT: 39, DELETE: 46, META: 91 },\r\n\r\n    /**\r\n    * @protected\r\n    * Check object for DOM node\r\n    */\r\n    isDomNode : function (el) {\r\n\r\n        return el && typeof el === 'object' && el.nodeType && el.nodeType == this.nodeTypes.TAG;\r\n\r\n    },\r\n\r\n    /**\r\n    * Parses string to nodeList\r\n    * Removes empty text nodes\r\n    * @param {string} inputString\r\n    * @return {array} of nodes\r\n    *\r\n    * Does not supports <tr> and <td> on firts level of inputString\r\n    */\r\n\r\n    parseHTML : function (inputString) {\r\n\r\n        // var templatesSupported = spark.supports.templates();\r\n\r\n        var contentHolder,\r\n            childs,\r\n            parsedNodes = [];\r\n\r\n        // if ( false &&   templatesSupported ) {\r\n\r\n        //     contentHolder = document.createElement('template');\r\n        //     contentHolder.innerHTML = inputString.trim();\r\n\r\n        //     console.log(\"contentHolder: %o\", contentHolder);\r\n\r\n        //     childs = contentHolder.content.cloneNode(true).childNodes;\r\n\r\n        // } else {\r\n\r\n        contentHolder = document.createElement('div');\r\n        contentHolder.innerHTML = inputString.trim();\r\n\r\n        childs = contentHolder.childNodes;\r\n\r\n        // }\r\n\r\n\r\n        /**\r\n        * Iterate childNodes and remove empty Text Nodes on first-level\r\n        */\r\n        for (var i = 0, node; !!(node = childs[i]); i++) {\r\n\r\n            if (node.nodeType == codex.core.nodeTypes.TEXT && !node.textContent.trim()) {\r\n\r\n                continue;\r\n\r\n            }\r\n\r\n            parsedNodes.push(node);\r\n\r\n        }\r\n\r\n        return parsedNodes;\r\n\r\n    },\r\n\r\n    /**\r\n    * Checks passed object for emptiness\r\n    * @require ES5 - Object.keys\r\n    * @param {object}\r\n    */\r\n    isEmpty : function (obj) {\r\n\r\n        return Object.keys(obj).length === 0;\r\n\r\n    },\r\n\r\n    /**\r\n    * Check for Element visibility\r\n    * @param {Element} el\r\n    */\r\n    isVisible : function (el) {\r\n\r\n        return el.offsetParent !== null;\r\n\r\n    },\r\n\r\n    setCookie : function (name, value, expires, path, domain) {\r\n\r\n        var str = name + '=' + value;\r\n\r\n        if (expires) str += '; expires=' + expires.toGMTString();\r\n        if (path)    str += '; path=' + path;\r\n        if (domain)  str += '; domain=' + domain;\r\n\r\n        document.cookie = str;\r\n\r\n    },\r\n\r\n    getCookie : function (name) {\r\n\r\n        var dc = document.cookie;\r\n\r\n        var prefix = name + '=',\r\n            begin = dc.indexOf('; ' + prefix);\r\n\r\n        if (begin == -1) {\r\n\r\n            begin = dc.indexOf(prefix);\r\n            if (begin !== 0) return null;\r\n\r\n        } else\r\n            begin += 2;\r\n\r\n        var end = document.cookie.indexOf(';', begin);\r\n\r\n        if (end == -1) end = dc.length;\r\n\r\n        return unescape(dc.substring(begin + prefix.length, end));\r\n\r\n    },\r\n\r\n};\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./public/app/js/modules/core.js\n// module id = 3\n// module chunks = 0","/**\r\n* AJAX module\r\n*/\r\nvar ajax = (function () {\r\n\r\n    /**\r\n    * @usage codex.ajax.call();\r\n    */\r\n    var call = function (data) {\r\n\r\n        if (!data || !data.url) return;\r\n\r\n        var XMLHTTP          = window.XMLHttpRequest ? new window.XMLHttpRequest() : new window.ActiveXObject('Microsoft.XMLHTTP'),\r\n            successFunction  = function () {};\r\n\r\n        data.async           = true;\r\n        data.type            = data.type || 'GET';\r\n        data.data            = data.data || '';\r\n        data['content-type'] = data['content-type'] || 'application/json; charset=utf-8';\r\n        successFunction      = data.success || successFunction;\r\n\r\n        if (data.type == 'GET' && data.data) {\r\n\r\n            data.url = /\\?/.test(data.url) ? data.url + '&' + data.data : data.url + '?' + data.data;\r\n\r\n        }\r\n\r\n        if (data.withCredentials) {\r\n\r\n            XMLHTTP.withCredentials = true;\r\n\r\n        }\r\n\r\n        if (data.beforeSend && typeof data.beforeSend == 'function') {\r\n\r\n            data.beforeSend.call();\r\n\r\n        }\r\n\r\n        XMLHTTP.open(data.type, data.url, data.async);\r\n\r\n        /**\r\n        * If we send FormData, we need no content-type header\r\n        */\r\n        if (!isFormData(data.data)) {\r\n\r\n            XMLHTTP.setRequestHeader('Content-type', data['content-type']);\r\n\r\n        }\r\n\r\n        XMLHTTP.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\r\n        XMLHTTP.onreadystatechange = function () {\r\n\r\n            if (XMLHTTP.readyState == 4 && XMLHTTP.status == 200) {\r\n\r\n                successFunction(XMLHTTP.responseText);\r\n\r\n            }\r\n\r\n        };\r\n\r\n        XMLHTTP.send(data.data);\r\n\r\n    };\r\n\r\n    /**\r\n     * Function for checking is it FormData object to send.\r\n     * @param {Object} object to check\r\n     * @return boolean\r\n     */\r\n    function isFormData(object) {\r\n\r\n        return typeof object.append === 'function';\r\n\r\n    };\r\n\r\n    return {\r\n\r\n        call : call\r\n\r\n    };\r\n\r\n}());\r\n\r\nmodule.exports = ajax;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./public/app/js/modules/ajax.js\n// module id = 4\n// module chunks = 0","/**\r\n * File transport module\r\n *\r\n * @module Transport module. Uploads file and returns some response from server\r\n * @copyright Codex-Team 2017\r\n *\r\n * @example\r\n *\r\n * Basic usage :\r\n *  codex.transport.init( {\r\n *      url : fetchURL,\r\n *      multiple : bool,\r\n *      accept : string  // http://htmlbook.ru/html/input/accept\r\n *      beforeSend : Function,\r\n *      success : Function,\r\n *      error : Function\r\n * });\r\n *\r\n * You can handle all of this event like:\r\n *  - what should happen before data sending with XMLHTTP\r\n *  - what should after success request\r\n *  - error handler\r\n */\r\n\r\nmodule.exports = ( function (transport) {\r\n\r\n    /** Empty configuration */\r\n    var config_ = null;\r\n\r\n    /** File holder */\r\n    transport.input = null;\r\n\r\n    /** initialize module */\r\n    transport.init = function (configuration) {\r\n\r\n        if (!configuration.url) {\r\n\r\n            codex.core.log('can\\'t send request because `url` is missed', 'Transport module', 'error');\r\n            return;\r\n\r\n        }\r\n\r\n        config_ = configuration;\r\n\r\n        var inputElement = document.createElement('INPUT');\r\n\r\n        inputElement.type = 'file';\r\n\r\n        if (config_ && config_.multiple) {\r\n\r\n            inputElement.setAttribute('multiple', 'multiple');\r\n\r\n        }\r\n\r\n        if (config_ && config_.accept) {\r\n\r\n            inputElement.setAttribute('accept', config_.accept);\r\n\r\n        }\r\n\r\n        inputElement.addEventListener('change', send_, false);\r\n\r\n        /** Save input */\r\n        transport.input = inputElement;\r\n\r\n        /** click input to show upload window */\r\n        clickInput_();\r\n\r\n    };\r\n\r\n    var clickInput_ = function () {\r\n\r\n        transport.input.click();\r\n\r\n    };\r\n\r\n    var send_ = function () {\r\n\r\n        var url        = config_.url,\r\n            beforeSend = config_.beforeSend,\r\n            success    = config_.success,\r\n            error      = config_.error,\r\n            formData   = new FormData(),\r\n            files      = transport.input.files;\r\n\r\n        if (files.length > 1) {\r\n\r\n            for (var i = 0; i < files.length; i++) {\r\n\r\n                formData.append('files[]', files[i], files[i].name);\r\n\r\n            }\r\n\r\n        } else {\r\n\r\n            formData.append('files', files[0], files[0].name);\r\n\r\n        }\r\n\r\n        codex.ajax.call({\r\n            type : 'POST',\r\n            data : formData,\r\n            url : url,\r\n            beforeSend : beforeSend,\r\n            success : success,\r\n            error : error\r\n        });\r\n\r\n    };\r\n\r\n    return transport;\r\n\r\n})({});\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./public/app/js/modules/transport.js\n// module id = 5\n// module chunks = 0","/**\r\n* Operations with pages\r\n*/\r\nmodule.exports = (function () {\r\n\r\n     /**\r\n    * Toggles classname on passed blocks\r\n    * @param {string} selector\r\n    * @param {string} toggled classname\r\n    */\r\n    var toggle = function ( which, marker ) {\r\n\r\n        var elements = document.querySelectorAll( which );\r\n\r\n        for (var i = elements.length - 1; i >= 0; i--) {\r\n\r\n            elements[i].classList.toggle( marker );\r\n\r\n        }\r\n\r\n    };\r\n\r\n\r\n    /**\r\n    * Toggles mobile menu\r\n    * Handles clicks on the hamburger icon in header\r\n    */\r\n    var toggleMobileMenu = function ( event ) {\r\n\r\n        var menu = document.getElementById('js-mobile-menu-holder'),\r\n            openedClass = 'mobile-menu-holder--opened';\r\n\r\n        menu.classList.toggle(openedClass);\r\n\r\n        event.stopPropagation();\r\n        event.stopImmediatePropagation();\r\n        event.preventDefault();\r\n\r\n    };\r\n\r\n    /**\r\n    * Module uses for toggle custom checkboxes\r\n    * that has 'js-custom-checkbox' class and input[type=\"checkbox\"] included\r\n    * Example:\r\n    * <span class=\"js-custom-checkbox\">\r\n    *    <input type=\"checkbox\" name=\"\" value=\"1\"/>\r\n    * </span>\r\n    */\r\n    var customCheckboxes = {\r\n\r\n        /**\r\n        * This class specifies checked custom-checkbox\r\n        * You may set it on serverisde\r\n        */\r\n        CHECKED_CLASS : 'checked',\r\n\r\n        init : function () {\r\n\r\n            var checkboxes = document.getElementsByClassName('js-custom-checkbox');\r\n\r\n            if (checkboxes.length) for (var i = checkboxes.length - 1; i >= 0; i--) {\r\n\r\n                checkboxes[i].addEventListener('click', codex.content.customCheckboxes.clicked, false);\r\n\r\n            }\r\n\r\n        },\r\n\r\n        clicked : function () {\r\n\r\n            var checkbox  = this,\r\n                input     = this.querySelector('input'),\r\n                isChecked = this.classList.contains(codex.content.customCheckboxes.CHECKED_CLASS);\r\n\r\n            checkbox.classList.toggle(codex.content.customCheckboxes.CHECKED_CLASS);\r\n\r\n            if (isChecked) {\r\n\r\n                input.removeAttribute('checked');\r\n\r\n            } else {\r\n\r\n                input.setAttribute('checked', 'checked');\r\n\r\n            }\r\n\r\n        }\r\n    };\r\n\r\n    var approvalButtons = {\r\n\r\n        CLICKED_CLASS : 'click-again-to-approve',\r\n\r\n        init : function () {\r\n\r\n            var buttons = document.getElementsByClassName('js-approval-button');\r\n\r\n            if (buttons.length) for (var i = buttons.length - 1; i >= 0; i--) {\r\n\r\n                buttons[i].addEventListener('click', codex.content.approvalButtons.clicked, false);\r\n\r\n            }\r\n\r\n        },\r\n\r\n        clicked : function (event) {\r\n\r\n            var button    = this,\r\n                isClicked = this.classList.contains(codex.content.approvalButtons.CLICKED_CLASS);\r\n\r\n            if (!isClicked) {\r\n\r\n                /*  ,        */\r\n                button.classList.add(codex.content.approvalButtons.CLICKED_CLASS);\r\n\r\n                event.preventDefault();\r\n\r\n            }\r\n\r\n        }\r\n    };\r\n\r\n    return {\r\n\r\n        toggleMobileMenu : toggleMobileMenu,\r\n        customCheckboxes : customCheckboxes,\r\n        approvalButtons : approvalButtons,\r\n        toggle : toggle\r\n\r\n    };\r\n\r\n}());\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./public/app/js/modules/content.js\n// module id = 6\n// module chunks = 0","/**\r\n * Appender is being used for ajax-loading next pages of lists\r\n *\r\n *    codex.appender.init({\r\n *        buttonId      : 'buttonLoadNews',       // button for listening\r\n *        currentPage   : '<?= $page_number ?>',    // currentPage number\r\n *        url           : '/',                      // url for ajax-requests\r\n *        targetBlockId : 'list_of_news',           // target for appending\r\n *        autoLoading   : true,                     // allow loading when reach bottom while scrolling\r\n *    });\r\n */\r\n\r\nvar appender = {\r\n\r\n    /* Pagination. Here is a number of current page */\r\n    page : 1,\r\n\r\n    settings : null,\r\n\r\n    blockForItems : null,\r\n\r\n    loadMoreButton : null,\r\n\r\n    /**\r\n     * Button's text for saving it.\r\n     * On its place dots will be while news are loading\r\n     */\r\n    buttonText : null,\r\n\r\n    init : function (settings) {\r\n\r\n        this.settings = settings;\r\n\r\n        /* Checking for existing button and field for loaded info */\r\n        this.loadMoreButton = document.getElementById(this.settings.buttonId);\r\n\r\n        if (!this.loadMoreButton) return false;\r\n\r\n        this.blockForItems = document.getElementById(this.settings.targetBlockId);\r\n\r\n        if (!this.blockForItems) return false;\r\n\r\n        this.page       = settings.currentPage;\r\n        this.buttonText = this.loadMoreButton.innerHTML;\r\n\r\n        if (this.settings.autoLoading) this.autoLoading.isAllowed = true;\r\n\r\n        this.loadMoreButton.addEventListener('click', function (event) {\r\n\r\n            codex.appender.load();\r\n\r\n            event.preventDefault();\r\n\r\n            codex.appender.autoLoading.init();\r\n\r\n        }, false);\r\n\r\n    },\r\n\r\n    load : function () {\r\n\r\n        var requestUrl = this.settings.url + (parseInt(this.page) + 1);\r\n            // separator   = '<a href=\"' + requestUrl + '\"><div class=\"article post-list-item w_island separator\">Page ' + (parseInt(this.page) + 1) + '</div></a>';\r\n\r\n        codex.ajax.call({\r\n            type: 'post',\r\n            url: requestUrl,\r\n            data: {},\r\n            beforeSend : function () {\r\n\r\n                codex.appender.loadMoreButton.classList.add('loading');\r\n\r\n            },\r\n            success : function (response) {\r\n\r\n                response = JSON.parse(response);\r\n\r\n                if (response.success) {\r\n\r\n                    if (!response.list) return;\r\n\r\n                    /* Append items */\r\n                    // codex.appender.blockForItems.innerHTML += separator;\r\n                    codex.appender.blockForItems.innerHTML += response.list;\r\n\r\n                    /* Next page */\r\n                    codex.appender.page++;\r\n\r\n                    if (codex.appender.settings.autoLoading) {\r\n\r\n                        /* Removing restriction for auto loading */\r\n                        codex.appender.autoLoading.canLoad = true;\r\n\r\n                    }\r\n\r\n                    /* Checking for next page's existing. If no  hide the button for loading news and remove listener */\r\n                    if (!response.next_page) codex.appender.disable();\r\n\r\n                } else {\r\n\r\n                    codex.core.showException('   ');\r\n\r\n                }\r\n\r\n                codex.appender.loadMoreButton.classList.remove('loading');\r\n\r\n            }\r\n\r\n        });\r\n\r\n    },\r\n\r\n    disable : function () {\r\n\r\n        codex.appender.loadMoreButton.style.display = 'none';\r\n\r\n        if (codex.appender.autoLoading.isLaunched) {\r\n\r\n            codex.appender.autoLoading.disable();\r\n\r\n        }\r\n\r\n    },\r\n\r\n    autoLoading : {\r\n\r\n        isAllowed : false,\r\n\r\n        isLaunched : false,\r\n\r\n        /**\r\n         * Possibility to load news by scrolling.\r\n         * Restriction for reduction requests which could be while scrolling\r\n         */\r\n        canLoad : true,\r\n\r\n        init : function () {\r\n\r\n            if (!this.isAllowed) return;\r\n\r\n            window.addEventListener('scroll', codex.appender.autoLoading.scrollEvent);\r\n\r\n            codex.appender.autoLoading.isLaunched = true;\r\n\r\n        },\r\n\r\n        disable : function () {\r\n\r\n            window.removeEventListener('scroll', codex.appender.autoLoading.scrollEvent);\r\n\r\n            codex.appender.autoLoading.isLaunched = false;\r\n\r\n        },\r\n\r\n        scrollEvent : function () {\r\n\r\n            var scrollReachedEnd = window.pageYOffset + window.innerHeight >= document.body.clientHeight;\r\n\r\n            if (scrollReachedEnd && codex.appender.autoLoading.canLoad) {\r\n\r\n                codex.appender.autoLoading.canLoad = false;\r\n\r\n                codex.appender.load();\r\n\r\n            }\r\n\r\n        },\r\n\r\n    }\r\n\r\n};\r\n\r\nmodule.exports = appender;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./public/app/js/modules/appender.js\n// module id = 7\n// module chunks = 0","/**\r\n * Parser module\r\n * @author Taly Guryn\r\n */\r\nvar parser = {\r\n\r\n    input : null,\r\n\r\n    init : function () {\r\n\r\n        // this.input = document.getElementById(settings.input_id);\r\n\r\n        var _this = this;\r\n\r\n        this.input.addEventListener('paste', function () {\r\n\r\n            _this.inputPasteCallback();\r\n\r\n        }, false);\r\n\r\n    },\r\n\r\n    inputPasteCallback : function () {\r\n\r\n        var e = this.input;\r\n\r\n        var _this = this;\r\n\r\n        window.setTimeout(function () {\r\n\r\n            _this.sendRequest(e.value);\r\n\r\n        }, 100);\r\n\r\n    },\r\n\r\n\r\n    sendRequest : function (url) {\r\n\r\n        codex.core.ajax({\r\n            type: 'get',\r\n            url: '/ajax/get_page',\r\n            data: { 'url' : url },\r\n            success: function (response) {\r\n\r\n                var title, content, sourceLink;\r\n\r\n                if ( response.success == 1) {\r\n\r\n                    title = document.getElementById('page_form_title');\r\n                    content = document.getElementById('page_form_content');\r\n                    sourceLink = document.getElementById('source_link');\r\n\r\n                    title.value = response.title;\r\n                    content.value = response.article;\r\n                    sourceLink.value = url;\r\n\r\n                    // while we have no own editor, we should use this getting element\r\n                    // cause I can't edit code for external editor\r\n                    document.getElementsByClassName('redactor_redactor')[0].innerHTML = response.article;\r\n\r\n                } else {\r\n\r\n                    codex.core.showException('   ');\r\n\r\n                }\r\n\r\n            }\r\n\r\n        });\r\n\r\n    }\r\n};\r\n\r\nmodule.exports = parser;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./public/app/js/modules/parser.js\n// module id = 8\n// module chunks = 0","/**\r\n * Comments module\r\n * @author  @guryn @neSpecc\r\n * @copyright CodeX Team https://github.com/codex-team\r\n * @version 1.1.0\r\n */\r\nmodule.exports = (function () {\r\n\r\n    var commentsList = null,\r\n        anchor       = document.location.hash;\r\n\r\n    var CSS_ = {\r\n        replyForm :         'comments-form',\r\n        replyTextarea :     'comment-form__text',\r\n        replyOpened :       'comment-form__placeholder--opened',\r\n        replySubmitButton : 'comment-form__button',\r\n        highlighted :       'comment--highligthed'\r\n    };\r\n\r\n    /**\r\n     * Settings-menu toggler selector\r\n     * @type {String}\r\n     */\r\n    var menuTogglerSelector = '.js-comment-settings';\r\n\r\n    /**\r\n     * Initialize comments\r\n     * @param {object} data        params\r\n     * @param {sring} data.listId  comments list wrapper id\r\n     */\r\n    function init(data) {\r\n\r\n        commentsList = document.getElementById(data.listId);\r\n\r\n        if (anchor) {\r\n\r\n            highligthAnchor();\r\n\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * Remove holder and append form for comment\r\n     * @param {Element} placeholder 'Write reply...' button\r\n     */\r\n    function reply( replyButton ) {\r\n\r\n        /** If reply already opened, do noting */\r\n        if ( replyButton.classList.contains( CSS_.replyOpened ) ) {\r\n\r\n            return;\r\n\r\n        }\r\n\r\n        /** Get reply params from dataset */\r\n        var replyParams = {\r\n            parentId : replyButton.dataset.parentId,\r\n            rootId   : replyButton.dataset.rootId,\r\n            action   : replyButton.dataset.action\r\n        };\r\n\r\n        /** Create reply form */\r\n        var form = createForm( replyParams );\r\n\r\n        /** Insert form after reply button */\r\n        codex.core.insertAfter( replyButton, form );\r\n\r\n        replyButton.classList.add( CSS_.replyOpened );\r\n        getFormTextarea(form).focus();\r\n\r\n    }\r\n\r\n    /**\r\n     * Returns reply form\r\n     *\r\n     * @param {object} params\r\n     * @param {Number} params.parentId     parent comment's id\r\n     * @param {Number} params.rootId       root comment's id\r\n     * @param {String} params.action       URL for saving\r\n     *\r\n     * @return {Element} element that holds textarea and submit-button\r\n     */\r\n    function createForm( params ) {\r\n\r\n        var textarea     = createTextarea(),\r\n            button       = createButton(),\r\n            form         = document.createElement('DIV');\r\n\r\n        form.classList.add(CSS_.replyForm);\r\n\r\n        /** Store data in Textarea */\r\n        textarea.dataset.parentId = params.parentId;\r\n        textarea.dataset.rootId   = params.rootId;\r\n        textarea.dataset.action   = params.action;\r\n\r\n        form.appendChild(textarea);\r\n        form.appendChild(button);\r\n\r\n        return form;\r\n\r\n    }\r\n\r\n    /** Return textarea for form for comment */\r\n    function createTextarea() {\r\n\r\n        var textarea = document.createElement('TEXTAREA');\r\n\r\n        textarea.classList.add(CSS_.replyTextarea);\r\n        textarea.placeholder = ' ';\r\n\r\n        textarea.addEventListener('keydown', keydownSubmitHandler, false);\r\n        textarea.addEventListener('blur', blurTextareaHandler, false);\r\n\r\n        codex.autoresizeTextarea.addListener(textarea);\r\n\r\n        return textarea;\r\n\r\n    }\r\n\r\n    /** Return submit button for form*/\r\n    function createButton() {\r\n\r\n        var button = document.createElement('DIV');\r\n\r\n        button.classList.add( CSS_.replySubmitButton, 'button', 'master');\r\n        button.textContent = '';\r\n\r\n        button.addEventListener('click', submitClicked_, false);\r\n\r\n        return button;\r\n\r\n    }\r\n\r\n    /**\r\n     * Reply submit button click handler\r\n     */\r\n    function submitClicked_() {\r\n\r\n        var submit = this,\r\n            form   = submit.parentNode,\r\n            textarea = getFormTextarea(form);\r\n\r\n        send_( textarea );\r\n\r\n    }\r\n\r\n    /* Return textarea for given form */\r\n    function getFormTextarea(form) {\r\n\r\n        return form.getElementsByTagName('TEXTAREA')[0];\r\n\r\n    }\r\n\r\n    /**\r\n     * Remove form on textarea blur\r\n     * @param {Event} blur Event\r\n     */\r\n    function blurTextareaHandler( event ) {\r\n\r\n        var textarea  = event.target,\r\n            form      = textarea.parentNode,\r\n            commentId = textarea.dataset.parentId;\r\n\r\n        if (!textarea.value.trim()) {\r\n\r\n            removeForm(form, commentId);\r\n\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * Removes reply form\r\n     * @param {Element} form\r\n     * @param {Number} commentId   reply target comment id\r\n     */\r\n    function removeForm( form, commentId ) {\r\n\r\n        var replyButton = document.getElementById('reply' + commentId );\r\n\r\n        form.remove();\r\n        replyButton.classList.remove(CSS_.replyOpened);\r\n\r\n    }\r\n\r\n    /**\r\n     * Catch Ctrl+Enter or Cmd+Enter for send form\r\n     * @param {Event} event    Keydown Event\r\n     */\r\n    function keydownSubmitHandler(event) {\r\n\r\n        var ctrlPressed  = event.ctrlKey || event.metaKey,\r\n            enterPressed = event.keyCode == 13,\r\n            textarea = event.target;\r\n\r\n        if ( ctrlPressed && enterPressed ) {\r\n\r\n            send_( textarea );\r\n\r\n            event.preventDefault();\r\n\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * Ajax function for submit comment\r\n     * @param {Element} textarea    input with dataset and text\r\n     */\r\n    function send_( textarea ) {\r\n\r\n        var formData  = new FormData(),\r\n            form      = textarea.parentNode,\r\n            submitBtn = form.querySelector('.' + CSS_.replySubmitButton),\r\n            rootId    = textarea.dataset.rootId,\r\n            parentId  = textarea.dataset.parentId,\r\n            actionURL = textarea.dataset.action;\r\n\r\n        formData.append('root_id', rootId);\r\n        formData.append('parent_id', parentId);\r\n        formData.append('comment_text', textarea.value);\r\n        formData.append('csrf', window.csrf);\r\n\r\n        codex.ajax.call({\r\n            type: 'POST',\r\n            url: actionURL,\r\n            data: formData,\r\n            beforeSend : function () {\r\n\r\n                submitBtn.classList.add('loading');\r\n\r\n            },\r\n            success : function (response) {\r\n\r\n                var comment;\r\n\r\n                submitBtn.classList.remove('loading');\r\n\r\n                response = JSON.parse(response);\r\n\r\n                if (!response.success) {\r\n\r\n                    codex.alerts.show(response.error);\r\n                    return;\r\n\r\n                }\r\n\r\n                /** Remove form and return placeholder */\r\n                removeForm(form, parentId);\r\n\r\n                /** Remove empty-feed block */\r\n                removeEmptyCommentsBlock();\r\n\r\n                comment = codex.core.parseHTML(response.comment)[0];\r\n                commentsList.appendChild(comment);\r\n\r\n                /** Scroll down to the new comment */\r\n                window.scrollTo(0, document.body.scrollHeight);\r\n\r\n                /** Highligth new comment */\r\n                highligthComment(response.commentId);\r\n\r\n                /** If menu found, activate it */\r\n                activateMenu(comment);\r\n\r\n            }\r\n\r\n        });\r\n\r\n    }\r\n\r\n    /**\r\n     * Removes empty-feed motivation\r\n     */\r\n    function removeEmptyCommentsBlock() {\r\n\r\n        var emptyCommentsBlock = document.querySelector('.js-empty-comments');\r\n\r\n        if (!emptyCommentsBlock) {\r\n\r\n            return;\r\n\r\n        }\r\n\r\n        emptyCommentsBlock.remove();\r\n\r\n    }\r\n\r\n    /**\r\n     * If menu-toggler found in comment\r\n     * @return {Element} comment - comment's island\r\n     */\r\n    function activateMenu( comment ) {\r\n\r\n        var  menuToggler = comment.querySelector(menuTogglerSelector);\r\n\r\n        if (!menuToggler) {\r\n\r\n            return;\r\n\r\n        }\r\n\r\n        codex.islandSettings.prepareToggler(menuToggler, menuTogglerSelector);\r\n\r\n    }\r\n\r\n    /**\r\n     * Highligth comment by id for a time\r\n     * @param {Number} commentId   id comment to highlight\r\n     */\r\n    function highligthComment(commentId) {\r\n\r\n        var comment = document.getElementById('comment' + commentId);\r\n\r\n        comment.classList.add(CSS_.highlighted);\r\n\r\n        window.setTimeout(function () {\r\n\r\n            comment.classList.remove(CSS_.highlighted);\r\n\r\n        }, 500);\r\n\r\n    }\r\n\r\n    /** Highligth comment if anchor is in url */\r\n    function highligthAnchor() {\r\n\r\n        var numbers = anchor.match(/\\d+/),\r\n            commentId;\r\n\r\n        if (!numbers) return;\r\n\r\n        commentId = numbers[0];\r\n\r\n        highligthComment(commentId);\r\n\r\n    }\r\n\r\n    /**\r\n     * Comment removing action\r\n     * @return {Event} click Event\r\n     */\r\n    function remove() {\r\n\r\n        var itemClicked = this,\r\n            targetId    = itemClicked.dataset.id;\r\n\r\n        if (!window.confirm('  ')) {\r\n\r\n            return;\r\n\r\n        }\r\n\r\n        document.location = '/delete-comment/' + targetId;\r\n\r\n    }\r\n\r\n    return {\r\n        init : init,\r\n        reply : reply,\r\n        remove : remove\r\n    };\r\n\r\n}());\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./public/app/js/modules/comments.js\n// module id = 9\n// module chunks = 0","/**\r\n* Notifications tips module\r\n*/\r\nmodule.exports = (function () {\r\n\r\n    require('../../css/modules/alerts.css');\r\n\r\n    var CSS_ = {\r\n        wrapper : 'exceptionWrapper',\r\n        exception : 'clientException'\r\n    };\r\n\r\n    var wrapper_ = null;\r\n\r\n    function prepare_() {\r\n\r\n        if ( wrapper_ ) {\r\n\r\n            return true;\r\n\r\n        }\r\n\r\n        wrapper_ = document.createElement('DIV');\r\n        wrapper_.classList.add(CSS_.wrapper);\r\n\r\n        document.body.appendChild(wrapper_);\r\n\r\n    }\r\n\r\n    /**\r\n    * @param {String} message - may content HTML\r\n    */\r\n    function show(message) {\r\n\r\n        prepare_();\r\n\r\n        var notify = document.createElement('DIV');\r\n\r\n        notify.classList.add(CSS_.exception);\r\n        notify.innerHTML = message;\r\n\r\n        wrapper_.appendChild(notify);\r\n\r\n        notify.classList.add('bounceIn');\r\n\r\n        window.setTimeout(function () {\r\n\r\n            notify.remove();\r\n\r\n        }, 8000);\r\n\r\n    }\r\n\r\n    return {\r\n        show : show\r\n    };\r\n\r\n})({});\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./public/app/js/modules/alerts.js\n// module id = 10\n// module chunks = 0","/**\r\n* Dropdown menu module\r\n* @author: @ndawn\r\n*/\r\n\r\nmodule.exports = (function () {\r\n\r\n    /**\r\n     * Menu block cache\r\n     * @type {Element|null}\r\n     */\r\n    var menuHolder = null;\r\n\r\n    /**\r\n     * Activated menus\r\n     * @type {Array}\r\n     */\r\n    var activated = [];\r\n\r\n    /**\r\n     * CSS class names\r\n     * @type {Object}\r\n     */\r\n    var CSS = {\r\n        menu   : 'island-settings__menu',\r\n        item   : 'island-settings__item',\r\n        showed : 'island-settings__menu--showed'\r\n\r\n    };\r\n\r\n    /**\r\n     * Initialization\r\n     * @param  {Object} settings  - initial settings\r\n     */\r\n    var init = function (settings) {\r\n\r\n        var menuTogglers = document.querySelectorAll(settings.selector);\r\n\r\n        /**\r\n         * Save initial object\r\n         */\r\n        activated.push(settings);\r\n\r\n        for (var i = menuTogglers.length - 1; i >= 0; i--) {\r\n\r\n            prepareToggler(menuTogglers[i], settings.selector);\r\n\r\n        }\r\n\r\n    };\r\n\r\n    /**\r\n     * @public\r\n     * Add event listener to the toggler\r\n     * @param  {Element} toggler\r\n     * @param  {String}  selector  - selector to find settings object\r\n     */\r\n    var prepareToggler = function (toggler, selector) {\r\n\r\n        /** Save initial selector to specify menu type */\r\n        toggler.dataset.selector = selector;\r\n        toggler.addEventListener('mouseover', menuTogglerHovered, false);\r\n\r\n    };\r\n\r\n    /**\r\n     * @private\r\n     *\r\n     * Island circled-icon mouseover handler\r\n     *\r\n     * @param {Event} event     mouseover-event\r\n     */\r\n    var menuTogglerHovered = function () {\r\n\r\n        var menuToggler = this,\r\n            menuParams;\r\n\r\n        if (!menuHolder) {\r\n\r\n            menuHolder = createMenu();\r\n\r\n        }\r\n\r\n        /** Prevent mouseover handling multiple times */\r\n        if ( menuHolder.dataset.opened == 'true' ) {\r\n\r\n            return;\r\n\r\n        }\r\n\r\n        menuHolder.dataset.opened = true;\r\n\r\n        /** if user fast moving cursor to the next toggler, let him */\r\n        window.setTimeout(function () {\r\n\r\n            menuHolder.dataset.opened = false;\r\n\r\n        }, 300);\r\n\r\n        /**\r\n         * Get current menu params\r\n         * @type {Object}\r\n         */\r\n        menuParams = getMenuParams(menuToggler.dataset.selector);\r\n\r\n        console.assert(menuParams.items, 'Menu items missed');\r\n\r\n        fill(menuParams.items, menuToggler);\r\n        move(menuToggler);\r\n\r\n    };\r\n\r\n    /**\r\n     * Return menu parametres by initial selector\r\n     * @param {string}  initialSelector  - selector passed in init() method\r\n     * @return {Object}\r\n     */\r\n    var getMenuParams = function (initialSelector) {\r\n\r\n        return activated.filter(compareSelector, initialSelector).pop();\r\n\r\n    };\r\n\r\n    /**\r\n     * Find settings object by selector\r\n     *\r\n     * @param  {Object}  obj    passed object with 'selector' key\r\n     * @this   {String}         selector to compare with\r\n     *\r\n     * @return {Boolean}        true if passed selector same as looking for\r\n     */\r\n    var compareSelector = function (obj) {\r\n\r\n        return obj.selector == this;\r\n\r\n    };\r\n\r\n    /**\r\n     * Fills menu with items\r\n     * @param  {Array}   items     list of menu items\r\n     * @param  {Element} toggler   islan menu icon with data-attributes\r\n     */\r\n\r\n    var fill = function (items, toggler) {\r\n\r\n        var i,\r\n            itemData,\r\n            itemElement;\r\n\r\n        menuHolder.innerHTML = '';\r\n\r\n        for (i = 0; !!(itemData = items[i]); i++) {\r\n\r\n            itemElement = createItem(itemData);\r\n\r\n            /** Pass all parametres stored in icon's dataset to the item's dataset */\r\n            for (var attr in toggler.dataset) {\r\n\r\n                itemElement.dataset[attr] = toggler.dataset[attr];\r\n\r\n            }\r\n\r\n            menuHolder.appendChild(itemElement);\r\n\r\n        }\r\n\r\n    };\r\n\r\n    /**\r\n    * @private\r\n    * Creates an option block\r\n    * @param {Object}   item          - menu item data\r\n    * @param {String}   item.title    - title\r\n    * @param {Function} item.handler  - click handler\r\n    *\r\n    * @return {Element} menu item with click handler\r\n    */\r\n    var createItem = function ( item ) {\r\n\r\n        var itemEl = document.createElement('LI');\r\n\r\n        itemEl.classList.add(CSS.item);\r\n\r\n        console.assert(item.title, 'islandSettings: item title is missed');\r\n        console.assert(typeof item.handler == 'function', 'islandSettings: item handler is not a function');\r\n\r\n        itemEl.textContent = item.title;\r\n        itemEl.addEventListener('click', item.handler);\r\n\r\n        return itemEl;\r\n\r\n    };\r\n\r\n    /**\r\n    * @private\r\n    * Creates the dropdown menu\r\n    */\r\n    var createMenu = function () {\r\n\r\n        var block = document.createElement('UL');\r\n\r\n        block.classList.add(CSS.menu);\r\n\r\n        return block;\r\n\r\n    };\r\n\r\n    /**\r\n    * Appends a menu to the container\r\n    * @param {Element} container - where to append menu\r\n    */\r\n    var move = function (container) {\r\n\r\n        container.appendChild(menuHolder);\r\n        menuHolder.classList.add(CSS.showed);\r\n\r\n    };\r\n\r\n    return {\r\n        init: init,\r\n        prepareToggler: prepareToggler\r\n    };\r\n\r\n})();\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./public/app/js/modules/islandSettings.js\n// module id = 12\n// module chunks = 0","/**\r\n* Module for comments textarea autoresize\r\n*/\r\nmodule.exports = (function () {\r\n\r\n    /**\r\n    * Textareas initialization\r\n    */\r\n    var init = function () {\r\n\r\n        var textareas = document.getElementsByClassName('js-autoresizable');\r\n\r\n        if (textareas.length) {\r\n\r\n            for (var i = 0; i < textareas.length; i++) {\r\n\r\n                addListener(textareas[i]);\r\n\r\n            }\r\n\r\n        }\r\n\r\n    };\r\n\r\n    /**\r\n    * Add input event listener to textarea\r\n    *\r\n    * @param {Element} textarea  node which need to be able to autoresize\r\n    */\r\n    var addListener = function (textarea) {\r\n\r\n        textarea.addEventListener('input', textareaChanged, false);\r\n\r\n    };\r\n\r\n    /**\r\n    * Hanging events on textareas\r\n    */\r\n    var textareaChanged = function (event) {\r\n\r\n        var textarea = event.target;\r\n\r\n        checkScrollHeight(textarea);\r\n\r\n    };\r\n\r\n    /**\r\n    * Increasing textarea height\r\n    */\r\n    var checkScrollHeight = function (textarea) {\r\n\r\n        if (textarea.scrollHeight > textarea.clientHeight) {\r\n\r\n            textarea.style.height = textarea.scrollHeight + 'px';\r\n\r\n        }\r\n\r\n    };\r\n\r\n    return {\r\n        init: init,\r\n        addListener : addListener\r\n    };\r\n\r\n}());\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./public/app/js/modules/autoresizeTextarea.js\n// module id = 13\n// module chunks = 0","/**\r\n * User methods module\r\n */\r\nmodule.exports = function () {\r\n\r\n    /**\r\n     * Manupulations with user photo\r\n     * @return {Object} - Module\r\n     */\r\n    var photo = function () {\r\n\r\n        /**\r\n         * Mark elements with this name=\"\" to dynamically update their sources\r\n         * @type {String}\r\n         */\r\n        var updatableElementsName = 'js-img-updatable';\r\n\r\n        /**\r\n         * Changes user's photo\r\n         * @param  {Event}  event   click event\r\n         */\r\n        var change = function ( event, transportType ) {\r\n\r\n            codex.transport.init({\r\n                url : '/upload/' + transportType,\r\n                success : uploaded,\r\n                error   : error\r\n            });\r\n\r\n        };\r\n\r\n        /**\r\n         * Uploading error\r\n         * @param  {Object} error\r\n         */\r\n        var error = function (uploadError) {\r\n\r\n            console.log(uploadError);\r\n\r\n        };\r\n\r\n        /**\r\n         * Photo uploading callback\r\n         * @param  {String} response    server answer\r\n         */\r\n        var uploaded = function (response) {\r\n\r\n            response = JSON.parse(response);\r\n\r\n            if ( !response.success ) {\r\n\r\n                codex.alerts.show(response.message || 'File uploading error :(');\r\n                return;\r\n\r\n            }\r\n\r\n            console.assert( response.data && response.data.url, 'Wrong response data');\r\n\r\n            updateAll( response.data.url );\r\n\r\n        };\r\n\r\n        /**\r\n         * Updates all user photo sources\r\n         * @uses   updatableElementsName  to find img tags\r\n         * @param  {String} newSource\r\n         */\r\n        var updateAll = function ( newSource) {\r\n\r\n            var updatebleImages = document.getElementsByName(updatableElementsName);\r\n\r\n            for (var i = updatebleImages.length - 1; i >= 0; i--) {\r\n\r\n                updatebleImages[i].src = newSource;\r\n\r\n            }\r\n\r\n        };\r\n\r\n        return {\r\n            change : change\r\n        };\r\n\r\n    }();\r\n\r\n    /**\r\n     * Changes user status\r\n     * @param  {} argument [description]\r\n     * @return {[type]}          [description]\r\n     */\r\n    var changeStatus = function () {\r\n\r\n        console.log('user status changing');\r\n\r\n    };\r\n\r\n    var changePassword = function () {\r\n\r\n        var wrapper = null,\r\n            input   = null,\r\n            message = null,\r\n            button  = null,\r\n            csrf    = null;\r\n\r\n        var showForm = function (_csrf) {\r\n\r\n            var label       = document.createElement('LABEL');\r\n\r\n            wrapper = this;\r\n            input   = document.createElement('INPUT');\r\n            button  = document.createElement('SPAN');\r\n            message = document.createElement('DIV');\r\n\r\n            csrf = _csrf;\r\n\r\n            label.classList.add('form__label');\r\n            label.textContent = ' ';\r\n\r\n            input.classList.add('form__input');\r\n            input.type = 'password';\r\n\r\n            button.classList.add('button');\r\n            button.classList.add('form__hint');\r\n            button.classList.add('master');\r\n            button.textContent = '';\r\n\r\n            button.addEventListener('click', requestChange);\r\n\r\n            wrapper.classList.remove('island--centered');\r\n            wrapper.classList.remove('profile-settings__change-password-btn');\r\n            wrapper.innerHTML   = '';\r\n            wrapper.onclick     = '';\r\n\r\n            wrapper.appendChild(label);\r\n            wrapper.appendChild(input);\r\n            wrapper.appendChild(button);\r\n            wrapper.appendChild(message);\r\n\r\n        };\r\n\r\n        var requestChange = function () {\r\n\r\n            button.classList.add('loading');\r\n\r\n            codex.ajax.call({\r\n                url: '/user/passchange',\r\n                type: 'POST',\r\n                data: JSON.stringify({\r\n                    csrf: csrf,\r\n                    currentPassword: input.value\r\n                }),\r\n                success: ajaxResponse,\r\n                error: ajaxResponse\r\n            });\r\n\r\n        };\r\n\r\n        var ajaxResponse = function (response) {\r\n\r\n            button.classList.remove('loading');\r\n\r\n            try {\r\n\r\n                response = JSON.parse(response);\r\n\r\n            } catch (e) {\r\n\r\n                response = {success: 0, message: ' '};\r\n\r\n            }\r\n\r\n            if (!response.success) {\r\n\r\n                input.classList.add('form__input--invalid');\r\n\r\n            } else {\r\n\r\n                showSuccessMessage(response.message);\r\n                return;\r\n\r\n            }\r\n\r\n            message.textContent = response.message;\r\n\r\n        };\r\n\r\n        var showSuccessMessage = function (text) {\r\n\r\n            if (wrapper.dataset.success) {\r\n\r\n                return;\r\n\r\n            }\r\n\r\n            var textDiv     = document.createElement('DIV');\r\n\r\n            button = document.createElement('BUTTON');\r\n\r\n            textDiv.textContent = text;\r\n            textDiv.classList.add('profile-settings__change-password-result-text');\r\n\r\n            button.classList.add('button', 'master');\r\n            button.addEventListener('click', requestChange);\r\n            button.textContent = '  ';\r\n\r\n            wrapper.innerHTML = '';\r\n            wrapper.classList.add('island--centered');\r\n\r\n            wrapper.appendChild(textDiv);\r\n            wrapper.appendChild(button);\r\n            wrapper.dataset.success = 1;\r\n\r\n        };\r\n\r\n        return {\r\n            showForm: showForm\r\n        };\r\n\r\n    }();\r\n\r\n    // var init = function () {\r\n    //\r\n    //     // bindEvents();\r\n    //\r\n    // };\r\n\r\n    // var bindEvents = function () {\r\n    //\r\n    //     var repeatConfirmEmailBtn = document.getElementById('repeat-email-confirmation');\r\n    //\r\n    //     repeatConfirmEmailBtn.addEventListener('click', sendEmeailConfirmation);\r\n    //\r\n    // };\r\n\r\n    // var sendEmeailConfirmation = function (e) {\r\n    //\r\n    //     var success = function (response) {\r\n    //\r\n    //         response = JSON.parse(response);\r\n    //\r\n    //         codex.alerts.show(response.message);\r\n    //         e.target.classList.remove('loading');\r\n    //\r\n    //     };\r\n    //\r\n    //     e.target.classList.add('loading');\r\n    //\r\n    //     codex.ajax.call({\r\n    //         url: '/ajax/confirmation-email',\r\n    //         success: success\r\n    //     });\r\n    //\r\n    // };\r\n\r\n\r\n    /**\r\n     * Working with bio\r\n     */\r\n    var bio = function () {\r\n\r\n        /**\r\n         * Edited textarea cache\r\n         * @type {Element|null}\r\n         */\r\n        var textarea = null;\r\n\r\n        /**\r\n         * Edit bio click handler;\r\n         * @param {Element} button  - button clicked\r\n         */\r\n        var edit = function ( button ) {\r\n\r\n            var opened = button.querySelector('textarea');\r\n\r\n            if (opened) {\r\n\r\n                return;\r\n\r\n            }\r\n\r\n            textarea = document.createElement('TEXTAREA');\r\n            textarea.innerHTML = button.textContent.trim();\r\n            textarea.addEventListener('keydown', keydown);\r\n\r\n            button.innerHTML = '';\r\n            button.appendChild(textarea);\r\n\r\n            textarea.focus();\r\n\r\n            /** Fire autoresize */\r\n            codex.autoresizeTextarea.addListener(textarea);\r\n\r\n        };\r\n\r\n        /**\r\n         * Bio textarea keydowns\r\n         * Sends via AJAX by ENTER\r\n         */\r\n        var keydown = function ( event ) {\r\n\r\n            if ( event.keyCode == codex.core.keys.ENTER ) {\r\n\r\n                send(this.value);\r\n                event.preventDefault();\r\n\r\n            }\r\n\r\n        };\r\n\r\n        /**\r\n         * Sends bio field\r\n         * @param  {String} val textarea value\r\n         */\r\n        var send = function (val) {\r\n\r\n            if (!val.trim()) {\r\n\r\n                codex.alerts.show('Write something about yourself');\r\n                return;\r\n\r\n            }\r\n\r\n            var formData = new FormData();\r\n\r\n            formData.append('bio', val);\r\n            formData.append('csrf', window.csrf);\r\n\r\n            codex.ajax.call({\r\n                type : 'POST',\r\n                url : '/user/updateBio',\r\n                data : formData,\r\n                beforeSend: beforeSend,\r\n                success : saved\r\n            });\r\n\r\n        };\r\n\r\n        /**\r\n         * Simple beforeSend method\r\n         */\r\n        var beforeSend = function () {\r\n\r\n            textarea.classList.add('loading');\r\n\r\n        };\r\n\r\n        /**\r\n         * Success saving callback\r\n         */\r\n        var saved = function (response) {\r\n\r\n            response = JSON.parse(response);\r\n\r\n            if (!response.success || !response.bio) {\r\n\r\n                textarea.classList.remove('loading');\r\n                codex.alerts.show('Saving error, sorry');\r\n                return;\r\n\r\n            }\r\n\r\n            var newBio = document.createTextNode(response.bio || '');\r\n\r\n            /** Update user's CSRF token */\r\n            window.csrf = response.csrf;\r\n\r\n            codex.core.replace(textarea, newBio);\r\n\r\n        };\r\n\r\n        return {\r\n            edit: edit\r\n        };\r\n\r\n    }();\r\n\r\n    return {\r\n        changePassword: changePassword,\r\n        changeStatus: changeStatus,\r\n        photo: photo,\r\n        bio : bio,\r\n    };\r\n\r\n}();\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./public/app/js/modules/user.js\n// module id = 14\n// module chunks = 0","var sharer = {\r\n\r\n    init : function () {\r\n\r\n        var shareButtons = document.querySelectorAll('.js-share');\r\n\r\n        for (var i = shareButtons.length - 1; i >= 0; i--) {\r\n\r\n            shareButtons[i].addEventListener('click', sharer.click, true);\r\n\r\n        }\r\n\r\n    },\r\n\r\n    shareVk : function (data) {\r\n\r\n        var link  = 'https://vk.com/share.php?';\r\n\r\n        link += 'url='          + data.url;\r\n        link += '&title='       + data.title;\r\n        link += '&description=' + data.desc;\r\n        link += '&image='       + data.img;\r\n        link += '&noparse=true';\r\n\r\n        this.popup( link, 'vkontakte'  );\r\n\r\n    },\r\n\r\n    shareFacebook : function (data) {\r\n\r\n        var FB_APP_ID = 1740455756240878,\r\n            link      = 'https://www.facebook.com/dialog/share?display=popup';\r\n\r\n        link += '&app_id='       + FB_APP_ID;\r\n        link += '&href='         + data.url;\r\n        link += '&redirect_uri=' + document.location.href;\r\n\r\n        this.popup( link, 'facebook' );\r\n\r\n    },\r\n\r\n    shareTwitter : function (data) {\r\n\r\n        var link = 'https://twitter.com/share?';\r\n\r\n        link += 'text='      + data.title;\r\n        link += '&url='      + data.url;\r\n        link += '&counturl=' + data.url;\r\n\r\n        this.popup( link, 'twitter' );\r\n\r\n    },\r\n\r\n    shareTelegram : function (data) {\r\n\r\n        var link  = 'https://telegram.me/share/url';\r\n\r\n        link += '?text=' + data.title;\r\n        link += '&url='  + data.url;\r\n\r\n        this.popup( link, 'telegram' );\r\n\r\n    },\r\n\r\n    popup : function ( url, socialType ) {\r\n\r\n        window.open( url, '', 'toolbar=0,status=0,width=626,height=436' );\r\n\r\n        /**\r\n         * Write analytics goal\r\n         */\r\n        if ( window.yaCounter32652805 ) {\r\n\r\n            window.yaCounter32652805.reachGoal('article-share', function () {}, this, {type: socialType, url: url});\r\n\r\n        }\r\n\r\n    },\r\n\r\n    click : function (event) {\r\n\r\n        var target = event.target;\r\n\r\n        /**\r\n         * Social provider stores in data 'shareType' attribute on share-button\r\n         * But click may be fired on child-element in button, so we need to handle it.\r\n         */\r\n        var type = target.dataset.shareType || target.parentNode.dataset.shareType;\r\n\r\n        if (!sharer[type]) return;\r\n\r\n        /**\r\n         * Sanitize share params\r\n         * @todo test for taint strings\r\n         */\r\n            // for (key in window.shareData){\r\n            //      window.shareData[key] = encodeURIComponent(window.shareData[key]);\r\n            // }\r\n\r\n        var shareData = {\r\n\r\n            url:    target.dataset.url || target.parentNode.dataset.url,\r\n            title:  target.dataset.title || target.parentNode.dataset.title,\r\n            desc:   target.dataset.desc || target.parentNode.dataset.desc,\r\n            img:    target.dataset.img || target.parentNode.dataset.title\r\n\r\n        };\r\n\r\n        /**\r\n         * Fire click handler\r\n         */\r\n\r\n        sharer[type](shareData);\r\n\r\n    }\r\n\r\n};\r\n\r\nmodule.exports = sharer;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./public/app/js/modules/sharer.js\n// module id = 15\n// module chunks = 0","/**\r\n * Module for load and start codex-editor\r\n *\r\n * Using:\r\n *\r\n * codex.writing.prepare({\r\n *     holderId : 'placeForEditor',                                         // (required)\r\n *     hideEditorToolbar : <?= $hideEditorToolbar ? 'true' : 'false' ?>,\r\n *     items : <?= json_encode($page->blocks) ?: '[]' ?>,\r\n *     pageId   : <?= $page->id ?>,\r\n *     parentId : <?= $page->id_parent ?>,\r\n * }).then(\r\n *    codex.writing.init\r\n * );\r\n */\r\n\r\n\r\nmodule.exports = (function () {\r\n\r\n    var editorIsReady = false,\r\n        submitButton = null,\r\n        settings = {\r\n            hideEditorToolbar   : false,\r\n            titleId             : 'editorWritingTitle',\r\n            initialBlockPlugin  : 'paragraph',\r\n            data                : {items: []},\r\n            resources           : [],\r\n            holderId            : null,\r\n            pageId              : 0,\r\n            parentId            : 0,\r\n        };\r\n\r\n    /**\r\n     * Prepare editor's resourses\r\n     *\r\n     * @param  {Object} initSettings    base settings for editor\r\n     * @return {Promise}            all editor's resources are ready\r\n     */\r\n    var prepare = function (initSettings) {\r\n\r\n        mergeSettings(initSettings);\r\n\r\n        return loadEditorResources(settings.resources)\r\n                .then(function () {\r\n\r\n                    editorIsReady = true;\r\n\r\n                });\r\n\r\n    };\r\n\r\n    /**\r\n     * Fill module's settings by settings from params\r\n     *\r\n     * @param  {Object} initSettings  list of params from init\r\n     */\r\n    function mergeSettings(initSettings) {\r\n\r\n        for (var key in initSettings) {\r\n\r\n            settings[key] = initSettings[key];\r\n\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * Run editor\r\n     */\r\n    function startEditor() {\r\n\r\n        /**\r\n         * @todo get from server\r\n         */\r\n        var EDITOR_IMAGE = 1;\r\n        var EDITOR_FILE  = 2;\r\n\r\n        codex.editor.start({\r\n\r\n            holderId:  settings.holderId,\r\n\r\n            initialBlockPlugin : settings.initialBlockPlugin,\r\n\r\n            hideToolbar: settings.hideEditorToolbar,\r\n\r\n            tools : {\r\n                paragraph: {\r\n                    type               : 'paragraph',\r\n                    iconClassname      : 'ce-icon-paragraph',\r\n                    render             : window.paragraph.render,\r\n                    validate           : window.paragraph.validate,\r\n                    save               : window.paragraph.save,\r\n                    allowedToPaste     : true,\r\n                    showInlineToolbar  : true,\r\n                    destroy            : window.paragraph.destroy,\r\n                    allowRenderOnPaste : true\r\n                },\r\n                header: {\r\n                    type             : 'header',\r\n                    iconClassname    : 'ce-icon-header',\r\n                    appendCallback   : window.header.appendCallback,\r\n                    makeSettings     : window.header.makeSettings,\r\n                    render           : window.header.render,\r\n                    validate         : window.header.validate,\r\n                    save             : window.header.save,\r\n                    destroy          : window.header.destroy,\r\n                    displayInToolbox : true\r\n                },\r\n                image: {\r\n                    type                  : 'image',\r\n                    iconClassname         : 'ce-icon-picture',\r\n                    appendCallback        : window.image.appendCallback,\r\n                    prepare               : window.image.prepare,\r\n                    makeSettings          : window.image.makeSettings,\r\n                    render                : window.image.render,\r\n                    save                  : window.image.save,\r\n                    destroy               : window.image.destroy,\r\n                    isStretched           : true,\r\n                    showInlineToolbar     : true,\r\n                    displayInToolbox      : true,\r\n                    renderOnPastePatterns : window.image.pastePatterns,\r\n                    config: {\r\n                        uploadImage : '/upload/' + EDITOR_IMAGE,\r\n                        uploadFromUrl : ''\r\n                    }\r\n                },\r\n                attaches: {\r\n                    type             : 'attaches',\r\n                    displayInToolbox : true,\r\n                    iconClassname    : 'cdx-attaches__icon',\r\n                    prepare          : window.cdxAttaches.prepare,\r\n                    render           : window.cdxAttaches.render,\r\n                    save             : window.cdxAttaches.save,\r\n                    validate         : window.cdxAttaches.validate,\r\n                    destroy          : window.cdxAttaches.destroy,\r\n                    appendCallback   : window.cdxAttaches.appendCallback,\r\n                    config: {\r\n                        fetchUrl: '/upload/' + EDITOR_FILE,\r\n                        maxSize: 25000,\r\n                    }\r\n                }\r\n            },\r\n\r\n            data : settings.data\r\n        });\r\n\r\n        var titleInput = document.getElementById(settings.titleId);\r\n\r\n        /**\r\n         * Focus at the title\r\n         */\r\n        titleInput.focus();\r\n        titleInput.addEventListener('keydown', titleKeydownHandler );\r\n\r\n    }\r\n\r\n    /**\r\n     * Title input keydowns\r\n     * @description  By ENTER, sets focus on editor\r\n     * @param  {Event} event  - keydown event\r\n     */\r\n    var titleKeydownHandler = function (event) {\r\n\r\n        /* Set focus on Editor by Enter     */\r\n        if ( event.keyCode == codex.core.keys.ENTER ) {\r\n\r\n            event.preventDefault();\r\n\r\n            focusRedactor();\r\n\r\n        }\r\n\r\n    };\r\n\r\n    /**\r\n     * Temporary scheme to focus Codex Editor first-block\r\n     */\r\n    var focusRedactor = function () {\r\n\r\n        var firstBlock       = codex.editor.nodes.redactor.firstChild,\r\n            contentHolder    = firstBlock.firstChild,\r\n            firstToolWrapper = contentHolder.firstChild,\r\n            aloneTextNode;\r\n\r\n        /**\r\n         * Caret will not be placed in empty textNode, so we need textNode with zero-width char\r\n         */\r\n        aloneTextNode = document.createTextNode('\\u200B');\r\n\r\n        /**\r\n         * We need to append manually created textnode before returning\r\n         */\r\n        firstToolWrapper.appendChild(aloneTextNode);\r\n\r\n        codex.editor.caret.set(firstToolWrapper, 0, 0);\r\n\r\n    };\r\n\r\n    /**\r\n     * Public function for run editor\r\n     */\r\n    var init = function () {\r\n\r\n        if (!editorIsReady) return;\r\n\r\n        startEditor();\r\n\r\n    };\r\n\r\n    /**\r\n     * Show form and hide placeholder\r\n     *\r\n     * @param  {Element} targetClicked       placeholder with wrapper\r\n     * @param  {String}  formId               remove 'hide' from this form by id\r\n     * @param  {String}  hidePlaceholderClass add this class to placeholder\r\n     */\r\n    var open = function (targetClicked, formId, hidePlaceholderClass) {\r\n\r\n        if (!editorIsReady) return;\r\n\r\n        var holder = targetClicked;\r\n\r\n        document.getElementById(formId).classList.remove('hide');\r\n        holder.classList.add(hidePlaceholderClass);\r\n        holder.onclick = null;\r\n\r\n        init();\r\n\r\n    };\r\n\r\n    /**\r\n     * Load editor resources and append block with them to body\r\n     *\r\n     * @param  {Array} resources list of resources which should be loaded\r\n     * @return {Promise}\r\n     */\r\n    var loadEditorResources = function (resources) {\r\n\r\n        return Promise.all(\r\n            resources.map(loadResource)\r\n        );\r\n\r\n    };\r\n\r\n    /**\r\n     * Loads resource\r\n     *\r\n     * @param  {Object} resource name and paths for js and css\r\n     * @return {Promise}\r\n     */\r\n    function loadResource(resource) {\r\n\r\n        var name      = resource.name,\r\n            scriptUrl = resource.path.script,\r\n            styleUrl  = resource.path.style;\r\n\r\n        return Promise.all([\r\n            codex.loader.importScript(scriptUrl, name),\r\n            codex.loader.importStyle(styleUrl, name)\r\n        ]);\r\n\r\n    }\r\n\r\n    /**\r\n    * Prepares form to submit\r\n    */\r\n    var getForm = function () {\r\n\r\n        var atlasForm = document.forms.atlas;\r\n\r\n        if (!atlasForm) return;\r\n\r\n        /** CodeX.Editor */\r\n        var JSONinput = document.createElement('TEXTAREA');\r\n\r\n        JSONinput.name   = 'content';\r\n        JSONinput.id     = 'json_result';\r\n        JSONinput.hidden = true;\r\n        atlasForm.appendChild(JSONinput);\r\n\r\n        /**\r\n         * Save blocks\r\n         */\r\n        codex.editor.saver.saveBlocks();\r\n\r\n        return atlasForm;\r\n\r\n    };\r\n\r\n    /**\r\n     * Send ajax request with writing form data\r\n     * @param button - submit button (needed to add loading animation)\r\n     */\r\n    var submit = function (button) {\r\n\r\n        var title = document.forms.atlas.elements['title'],\r\n            form;\r\n\r\n        if (title.value.trim() === '') {\r\n\r\n            codex.editor.notifications.notification({\r\n                type: 'warn',\r\n                message: ' '\r\n            });\r\n\r\n            return;\r\n\r\n        }\r\n\r\n        form = getForm();\r\n\r\n        submitButton = button;\r\n\r\n        submitButton.classList.add('loading');\r\n\r\n        window.setTimeout(function () {\r\n\r\n            form.elements['content'].innerHTML = JSON.stringify({items: codex.editor.state.jsonOutput});\r\n\r\n            codex.ajax.call({\r\n                url: '/p/save',\r\n                data: new FormData(form),\r\n                success: submitResponse,\r\n                type: 'POST'\r\n            });\r\n\r\n        }, 500);\r\n\r\n    };\r\n\r\n    /**\r\n     * Response handler for page saving\r\n     * @param response\r\n     */\r\n    var submitResponse = function (response) {\r\n\r\n        submitButton.classList.remove('loading');\r\n\r\n        response = JSON.parse(response);\r\n\r\n        if (response.success) {\r\n\r\n            window.location = response.redirect;\r\n            return;\r\n\r\n        }\r\n\r\n        codex.editor.notifications.notification({\r\n            type: 'warn',\r\n            message: response.message\r\n        });\r\n\r\n    };\r\n\r\n    /**\r\n    * Submits writing form for opening in full-screan page without saving\r\n    */\r\n    var openEditorFullscreen = function () {\r\n\r\n\r\n        var form = getForm();\r\n\r\n        window.setTimeout(function () {\r\n\r\n            form.elements['content'].innerHTML = JSON.stringify({ items: codex.editor.state.jsonOutput });\r\n\r\n            form.submit();\r\n\r\n        }, 500);\r\n\r\n    };\r\n\r\n    return {\r\n        init    : init,\r\n        prepare : prepare,\r\n        open    : open,\r\n        openEditorFullscreen : openEditorFullscreen,\r\n        submit               : submit,\r\n    };\r\n\r\n})();\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./public/app/js/modules/writing.js\n// module id = 16\n// module chunks = 0","module.exports = {\r\n\r\n    prefixJS : 'cdx-script-',\r\n\r\n    prefixCSS : 'cdx-style-',\r\n\r\n    importScript : function (scriptPath, instanceName) {\r\n\r\n        return new Promise(function (resolve, reject) {\r\n\r\n            var script;\r\n\r\n            /** Script is already loaded */\r\n            if ( !instanceName ) {\r\n\r\n                reject('Instance name is missed');\r\n\r\n            } else if ( document.getElementById(this.prefixJS + instanceName) ) {\r\n\r\n                resolve(scriptPath);\r\n\r\n            }\r\n\r\n            script = document.createElement('SCRIPT');\r\n            script.async = true;\r\n            script.defer = true;\r\n            script.id    = codex.loader.prefixJS + instanceName;\r\n\r\n            script.onload = function () {\r\n\r\n                resolve(scriptPath);\r\n\r\n            };\r\n\r\n            script.onerror = function () {\r\n\r\n                reject(scriptPath);\r\n\r\n            };\r\n\r\n            script.src = scriptPath;\r\n            document.head.appendChild(script);\r\n\r\n        });\r\n\r\n    },\r\n\r\n    importStyle : function (stylePath, instanceName) {\r\n\r\n        return new Promise(function (resolve, reject) {\r\n\r\n            var style;\r\n\r\n            /** Style is already loaded */\r\n            if ( !instanceName ) {\r\n\r\n                reject('Instance name is missed');\r\n\r\n            } else if ( document.getElementById(this.prefixCSS + instanceName) ) {\r\n\r\n                resolve(stylePath);\r\n\r\n            }\r\n\r\n            style = document.createElement('LINK');\r\n            style.type = 'text/css';\r\n            style.href = stylePath;\r\n            style.rel  = 'stylesheet';\r\n            style.id   = codex.loader.prefixCSS + instanceName;\r\n\r\n            style.onload = function () {\r\n\r\n                resolve(stylePath);\r\n\r\n            };\r\n\r\n            style.onerror = function () {\r\n\r\n                reject(stylePath);\r\n\r\n            };\r\n\r\n            style.src = stylePath;\r\n            document.head.appendChild(style);\r\n\r\n        });\r\n\r\n    },\r\n\r\n};\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./public/app/js/modules/loader.js\n// module id = 17\n// module chunks = 0","/**\r\n* Module for scroll-up button\r\n* @author @scytem @guryn\r\n*/\r\n\r\n\r\nmodule.exports = (function () {\r\n\r\n\r\n    /**\r\n     * Scroll-up will be shown after sroll reaches this value\r\n     * @type {Number}\r\n     */\r\n    var offsetToShow = 300;\r\n\r\n    /**\r\n     * Size content width\r\n     * @type {Number}\r\n     */\r\n    var layoutWidth = 0;\r\n\r\n    /**\r\n     * Clickable Element that holds arrow\r\n     * @type {Element}\r\n     */\r\n    var clickableZone = null;\r\n\r\n    /**\r\n     * Window Resize stop watcher Timeout\r\n     * @type {timeoutId}\r\n     */\r\n    var resizeStopWatcher = null;\r\n\r\n    /**\r\n     * @public\r\n     *\r\n     * Init method\r\n     * Fired after document is ready\r\n     */\r\n    var init = function ( layoutHolderId ) {\r\n\r\n        var layout = document.getElementById(layoutHolderId);\r\n\r\n        if (!layout) {\r\n\r\n            codex.core.log('Layout center-col ID wissed', 'scrollUp', 'warn');\r\n            return;\r\n\r\n        }\r\n\r\n        layoutWidth = layout.offsetWidth;\r\n\r\n        clickableZone = makeUI();\r\n\r\n        /** Bind click event on scroll-up button */\r\n        clickableZone.addEventListener('click', scrollPage);\r\n\r\n        /** Global window scroll handler */\r\n        window.addEventListener('scroll', windowScrollHandler);\r\n\r\n        /** Autoresize */\r\n        window.addEventListener('resize', sizeChanged, false);\r\n\r\n        /** Set size */\r\n        resize();\r\n\r\n        /* Check heigth */\r\n        windowScrollHandler();\r\n\r\n    };\r\n\r\n    /**\r\n    * Scroll the document to the begin position\r\n    * @param {number} yCoords Y-coordinate\r\n    */\r\n    var scrollPage = function (yCoords) {\r\n\r\n        window.scrollTo(0, yCoords);\r\n\r\n    };\r\n\r\n    /**\r\n    * Hiding Scroll-up button if user on the top of page\r\n    */\r\n    var windowScrollHandler = function () {\r\n\r\n        var notTheTop = window.pageYOffset > offsetToShow;\r\n\r\n        if (notTheTop) {\r\n\r\n            clickableZone.classList.add('show');\r\n\r\n        } else {\r\n\r\n            clickableZone.classList.remove('show');\r\n\r\n        }\r\n\r\n    };\r\n\r\n    /**\r\n    * Resize hover/click area touching user width of screen\r\n    */\r\n    var resize = function () {\r\n\r\n        var windowWidth     = document.body.clientWidth,\r\n            leftColumtWidth = (windowWidth - layoutWidth) / 2;\r\n\r\n        clickableZone.style.width = leftColumtWidth + 'px';\r\n\r\n    };\r\n\r\n\r\n    /**\r\n    * Delay for resize\r\n    */\r\n    var sizeChanged = function () {\r\n\r\n        if ( resizeStopWatcher ) {\r\n\r\n            window.clearTimeout(resizeStopWatcher);\r\n\r\n        }\r\n\r\n        resizeStopWatcher = window.setTimeout(resize, 150);\r\n\r\n    };\r\n\r\n    /**\r\n     * Makes scroll-up arrow and wrapper\r\n     */\r\n    var makeUI = function () {\r\n\r\n        var wrapper = document.createElement('DIV'),\r\n            arrow   = document.createElement('DIV');\r\n\r\n        wrapper.classList.add('scroll-up');\r\n        arrow.classList.add('scroll-up__arrow');\r\n\r\n        wrapper.appendChild(arrow);\r\n        document.body.appendChild(wrapper);\r\n\r\n        return wrapper;\r\n\r\n    };\r\n\r\n    return {\r\n        init: init\r\n    };\r\n\r\n}());\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./public/app/js/modules/scrollUp.js\n// module id = 18\n// module chunks = 0","/**\r\n * Admin module\r\n */\r\n\r\nmodule.exports = (function () {\r\n\r\n    var emptyBrandingClass = 'branding--empty';\r\n    var loadingClass       = 'branding--loading';\r\n    var preloaderClass     = 'branding__preloader';\r\n    var preloadShown       = 'branding__preloader--shown';\r\n\r\n    /**\r\n     * Branding holder\r\n     * @type {Element|null}\r\n     */\r\n    var wrapper = null;\r\n\r\n    /**\r\n     * Initialization\r\n     * @fires preload\r\n     */\r\n    var init = function () {\r\n\r\n        wrapper = document.getElementById('brandingSection');\r\n\r\n        if ( !wrapper ) {\r\n\r\n            return;\r\n\r\n        }\r\n\r\n        var url = wrapper.dataset.src;\r\n\r\n        preload( url );\r\n\r\n    };\r\n\r\n    /**\r\n     * Shows blurred preview and change it to the full-view image\r\n     * @param  {String} fullUrl          - URL of original image\r\n     * @return {String|null} previewUrl  - pass to renew preloader\r\n     */\r\n    var preload = function ( fullUrl, previewUrl ) {\r\n\r\n        var preloader = wrapper.querySelector('.' + preloaderClass),\r\n            img = document.createElement('IMG');\r\n\r\n        if ( previewUrl ) {\r\n\r\n            preloader.style.backgroundImage = \"url('\" + previewUrl + \"')\";\r\n            preloader.classList.add(preloadShown);\r\n\r\n        }\r\n\r\n        img.src = fullUrl;\r\n        img.onload = function () {\r\n\r\n            wrapper.style.backgroundImage = \"url('\" + fullUrl + \"')\";\r\n            preloader.classList.remove(preloadShown);\r\n\r\n        };\r\n\r\n    };\r\n\r\n\r\n\r\n    /**\r\n     * changes site branding\r\n     * @private\r\n     */\r\n    var change = function () {\r\n\r\n        codex.transport.init({\r\n\r\n            url : '/upload/4',\r\n            accept : 'image/*',\r\n            beforeSend: function () {\r\n\r\n                wrapper.classList.add(loadingClass);\r\n\r\n            },\r\n            success : function (result) {\r\n\r\n                var response = JSON.parse(result),\r\n                    url,\r\n                    preview;\r\n\r\n                wrapper.classList.remove(loadingClass);\r\n\r\n                if ( response.success ) {\r\n\r\n                    url = response.data.url;\r\n                    preview = '/upload/branding/preload_' + response.data.name + '.jpg';\r\n\r\n                    if ( wrapper.classList.contains(emptyBrandingClass) ) {\r\n\r\n                        wrapper.classList.remove(emptyBrandingClass);\r\n\r\n                    }\r\n\r\n                    preload( url, preview );\r\n\r\n                } else {\r\n\r\n                    codex.alerts.show('Uploading failed');\r\n\r\n                }\r\n\r\n            },\r\n            error: function () {\r\n\r\n                wrapper.classList.remove(loadingClass);\r\n\r\n                codex.alerts.show('Error while uploading branding image;');\r\n\r\n            }\r\n\r\n        });\r\n\r\n    };\r\n\r\n    return {\r\n        init: init,\r\n        change : change\r\n    };\r\n\r\n})({});\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./public/app/js/modules/branding.js\n// module id = 19\n// module chunks = 0","/**\r\n * Page significant methods\r\n */\r\nmodule.exports = (function () {\r\n\r\n    /**\r\n     * Saves current clicked item in page drop-down menu\r\n     * @type {Element}\r\n     */\r\n    var currentItemClicked = null;\r\n\r\n    /**\r\n     * Opens page-writing form\r\n     */\r\n    var openWriting = function () {\r\n\r\n        currentItemClicked = this;\r\n\r\n        var targetId = currentItemClicked.dataset.id;\r\n\r\n        document.location = '/p/writing?id=' + targetId;\r\n\r\n    };\r\n\r\n    /**\r\n     * Opens page-writing form\r\n     */\r\n    var remove = function () {\r\n\r\n        currentItemClicked = this;\r\n\r\n        var targetId    = currentItemClicked.dataset.id;\r\n\r\n        if (!window.confirm('  ')) {\r\n\r\n            return;\r\n\r\n        }\r\n\r\n        codex.ajax.call({\r\n            url : '/p/' + targetId + '/delete',\r\n            success: ajaxResponses.delete\r\n        });\r\n\r\n    };\r\n\r\n    /**\r\n     * Opens writing form for child page\r\n     */\r\n    var newChild = function () {\r\n\r\n        currentItemClicked = this;\r\n\r\n        var targetId = currentItemClicked.dataset.id;\r\n\r\n        document.location = '/p/writing?parent=' + targetId;\r\n\r\n    };\r\n\r\n    /**\r\n     * Send ajax request to add page to menu\r\n     */\r\n    var addToMenu = function () {\r\n\r\n        currentItemClicked = this;\r\n        currentItemClicked.classList.add('loading');\r\n\r\n        var targetId =currentItemClicked.dataset.id;\r\n\r\n        codex.ajax.call({\r\n            url : '/p/' + targetId + '/promote?list=menu',\r\n            success: ajaxResponses.promote\r\n        });\r\n\r\n    };\r\n\r\n    /**\r\n     * Send ajax request to add page to news\r\n     */\r\n    var addToNews = function () {\r\n\r\n        currentItemClicked = this;\r\n        currentItemClicked.classList.add('loading');\r\n\r\n        var targetId =currentItemClicked.dataset.id;\r\n\r\n        codex.ajax.call({\r\n            url : '/p/' + targetId + '/promote?list=news',\r\n            success: ajaxResponses.promote\r\n        });\r\n\r\n    };\r\n\r\n    var ajaxResponses = {\r\n\r\n        /**\r\n         * Parse JSON response\r\n         * @param {JSON} response\r\n         * @returns {Object} response\r\n         */\r\n        getResponse: function (response) {\r\n\r\n            try {\r\n\r\n                response = JSON.parse(response);\r\n\r\n            } catch(e) {\r\n\r\n                return {\r\n                    success: 0,\r\n                    message: ' ,  '\r\n                };\r\n\r\n            }\r\n\r\n            return response;\r\n\r\n        },\r\n\r\n        /**\r\n         * Response handler for page remove\r\n         * @param response\r\n         */\r\n        delete: function (response) {\r\n\r\n            response = ajaxResponses.getResponse(response);\r\n\r\n            if (response.success) {\r\n\r\n                window.location.replace(response.redirect);\r\n                return;\r\n\r\n            }\r\n\r\n            codex.alerts.show(response.message);\r\n\r\n        },\r\n\r\n        /**\r\n         * Response handler for page promotion\r\n         * @param response\r\n         */\r\n        promote: function (response) {\r\n\r\n            response = ajaxResponses.getResponse(response);\r\n\r\n            currentItemClicked.classList.remove('loading');\r\n\r\n            if (response.success) {\r\n\r\n                if (response.menu) {\r\n\r\n                    ajaxResponses.replaceMenu(response.menu);\r\n\r\n                }\r\n\r\n                /**\r\n                 * TODO:    \r\n                 **/\r\n\r\n                codex.alerts.show(response.message);\r\n\r\n                return;\r\n\r\n            }\r\n\r\n            codex.alerts.show(response.message);\r\n\r\n        },\r\n\r\n        /**\r\n         * Replace site menu with code from server response\r\n         * @param menu\r\n         */\r\n        replaceMenu: function (menu) {\r\n\r\n            var oldMenu = document.getElementById('menu'),\r\n                newMenu = codex.core.parseHTML(menu)[0];\r\n\r\n            codex.core.replace(oldMenu, newMenu);\r\n\r\n        }\r\n\r\n    };\r\n\r\n\r\n\r\n    return {\r\n        openWriting: openWriting,\r\n        newChild: newChild,\r\n        addToMenu: addToMenu,\r\n        addToNews: addToNews,\r\n        remove : remove\r\n    };\r\n\r\n}());\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./public/app/js/modules/pages.js\n// module id = 20\n// module chunks = 0"],"sourceRoot":""}